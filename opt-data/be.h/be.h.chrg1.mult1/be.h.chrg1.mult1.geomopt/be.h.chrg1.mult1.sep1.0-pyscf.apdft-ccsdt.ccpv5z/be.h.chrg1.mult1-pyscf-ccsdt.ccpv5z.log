#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/be.h/be.h.chrg1.mult1/be.h.chrg1.mult1.geomopt/be.h.chrg1.mult1.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['Be', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 1
multiplicity = 1
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n3.sam.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 4
[INPUT] charge = 1
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 Be     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 2.11670884368
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.41
Create scanner for <class 'pyscf.grad.ccsd.Gradients'>
Set <class 'pyscf.cc.ccsd.CCSD'> as a scanner
Create scanner for <class 'pyscf.scf.hf.RHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
  Be   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 Be     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 147 MB)
init E= -15.1395320977778
  HOMO = -0.587685309030107  LUMO = -0.0870349901219317
cycle= 1 E= -14.7640971844045  delta_E= 0.375  |g|= 0.215  |ddm|= 1.19
  HOMO = -0.856348164235795  LUMO = -0.301484458369752
cycle= 2 E= -14.800088566782  delta_E= -0.036  |g|= 0.0846  |ddm|= 0.205
  HOMO = -0.813433726038583  LUMO = -0.284047984858765
cycle= 3 E= -14.8045778821749  delta_E= -0.00449  |g|= 0.0197  |ddm|= 0.0796
  HOMO = -0.811521902700237  LUMO = -0.284443688514411
cycle= 4 E= -14.8050414722557  delta_E= -0.000464  |g|= 0.00477  |ddm|= 0.0299
  HOMO = -0.811051701983518  LUMO = -0.285968419204174
cycle= 5 E= -14.8050701689146  delta_E= -2.87e-05  |g|= 0.000292  |ddm|= 0.0119
  HOMO = -0.811043251468715  LUMO = -0.286000028183914
cycle= 6 E= -14.8050701928839  delta_E= -2.4e-08  |g|= 3.07e-05  |ddm|= 0.000608
  HOMO = -0.811049475388437  LUMO = -0.286004216704592
cycle= 7 E= -14.8050701933429  delta_E= -4.59e-10  |g|= 3.53e-06  |ddm|= 7.59e-05
  HOMO = -0.811048881163541  LUMO = -0.286005185601857
cycle= 8 E= -14.8050701933503  delta_E= -7.37e-12  |g|= 3.26e-07  |ddm|= 2.27e-05
  HOMO = -0.811048847101865  LUMO = -0.286005118400867
Extra cycle  E= -14.8050701933503  delta_E= -1.42e-14  |g|= 9.53e-08  |ddm|= 3.39e-06
converged SCF energy = -14.8050701933503

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 2, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1558 MB)
Init t2, MP2 energy = -14.8658584734015  E_corr(MP2) -0.0607882800511834
Init E_corr(CCSD) = -0.0607882800511878
cycle = 1  E_corr(CCSD) = -0.0677099172747249  dE = -0.00692163722  norm(t1,t2) = 0.0205071
cycle = 2  E_corr(CCSD) = -0.0696089741503921  dE = -0.00189905688  norm(t1,t2) = 0.00787948
cycle = 3  E_corr(CCSD) = -0.0704799636393183  dE = -0.000870989489  norm(t1,t2) = 0.00338751
cycle = 4  E_corr(CCSD) = -0.0705111081827933  dE = -3.11445435e-05  norm(t1,t2) = 0.00106327
cycle = 5  E_corr(CCSD) = -0.070473964331997  dE = 3.71438508e-05  norm(t1,t2) = 0.000453072
cycle = 6  E_corr(CCSD) = -0.0704818929858821  dE = -7.92865389e-06  norm(t1,t2) = 0.000100144
cycle = 7  E_corr(CCSD) = -0.0704831040835678  dE = -1.21109769e-06  norm(t1,t2) = 1.98108e-05
cycle = 8  E_corr(CCSD) = -0.0704827049632955  dE = 3.99120272e-07  norm(t1,t2) = 5.38485e-06
cycle = 9  E_corr(CCSD) = -0.0704827059709598  dE = -1.00766427e-09  norm(t1,t2) = 6.6572e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -14.87555289932123  E_corr = -0.07048270597095979
cycle = 1  norm(lambda1,lambda2) = 0.00188913
cycle = 2  norm(lambda1,lambda2) = 0.000450819
cycle = 3  norm(lambda1,lambda2) = 0.000198027
cycle = 4  norm(lambda1,lambda2) = 6.23176e-05
cycle = 5  norm(lambda1,lambda2) = 3.06494e-05
cycle = 6  norm(lambda1,lambda2) = 7.32217e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 Be     0.2060698135     0.0000000000    -0.0000000000
1 H    -0.2060698135    -0.0000000000     0.0000000000
----------------------------------------------
cycle 1: E = -14.8755528993  dE = -14.8756  norm(grad) = 0.291427

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
  Be  -0.100000  -0.000000   0.000000   -0.100000 -0.000000  0.000000
   H   1.100000   0.000000  -0.000000    0.100000  0.000000 -0.000000
New geometry
   1 Be    -0.099999999945  -0.000000000000   0.000000000000 AA   -0.188972612353  -0.000000000000   0.000000000000 Bohr

   2 H      1.100000000055   0.000000000000  -0.000000000000 AA    2.078698737125   0.000000000000  -0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 321 MB)
init E= -14.8389929156069
  HOMO = -0.764043324819199  LUMO = -0.299470357788063
cycle= 1 E= -14.8492186626331  delta_E= -0.0102  |g|= 0.0295  |ddm|= 0.156
  HOMO = -0.765268127002228  LUMO = -0.288529508347761
cycle= 2 E= -14.8497854182248  delta_E= -0.000567  |g|= 0.00959  |ddm|= 0.0309
  HOMO = -0.770215635971913  LUMO = -0.287473222993895
cycle= 3 E= -14.8498924277863  delta_E= -0.000107  |g|= 0.00353  |ddm|= 0.0123
  HOMO = -0.771128061828623  LUMO = -0.287135562753539
cycle= 4 E= -14.8499098580851  delta_E= -1.74e-05  |g|= 0.000254  |ddm|= 0.00702
  HOMO = -0.771151742668208  LUMO = -0.287106884145501
cycle= 5 E= -14.8499099256406  delta_E= -6.76e-08  |g|= 2.06e-05  |ddm|= 0.000641
  HOMO = -0.771148667139305  LUMO = -0.287105081835163
cycle= 6 E= -14.8499099259082  delta_E= -2.68e-10  |g|= 1.16e-06  |ddm|= 6.93e-05
  HOMO = -0.771148738582521  LUMO = -0.28710483271167
cycle= 7 E= -14.8499099259089  delta_E= -6.96e-13  |g|= 9.81e-08  |ddm|= 7.76e-06
  HOMO = -0.771148727425828  LUMO = -0.287104836588439
Extra cycle  E= -14.8499099259089  delta_E= -1.78e-14  |g|= 2.28e-08  |ddm|= 8.66e-07
converged SCF energy = -14.8499099259089

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 2, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1695 MB)
Init E_corr(CCSD) = -0.0213534861295116
cycle = 1  E_corr(CCSD) = -0.0622803249278906  dE = -0.0409268388  norm(t1,t2) = 0.0912557
cycle = 2  E_corr(CCSD) = -0.0674136411676126  dE = -0.00513331624  norm(t1,t2) = 0.0224737
cycle = 3  E_corr(CCSD) = -0.0687949996317837  dE = -0.00138135846  norm(t1,t2) = 0.00679314
cycle = 4  E_corr(CCSD) = -0.0691578993077957  dE = -0.000362899676  norm(t1,t2) = 0.00244842
cycle = 5  E_corr(CCSD) = -0.0691396547584065  dE = 1.82445494e-05  norm(t1,t2) = 0.000429597
cycle = 6  E_corr(CCSD) = -0.0691410736624611  dE = -1.41890405e-06  norm(t1,t2) = 0.000128534
cycle = 7  E_corr(CCSD) = -0.0691429300806586  dE = -1.8564182e-06  norm(t1,t2) = 5.86637e-05
cycle = 8  E_corr(CCSD) = -0.0691426069264788  dE = 3.2315418e-07  norm(t1,t2) = 2.09087e-05
cycle = 9  E_corr(CCSD) = -0.0691427616666571  dE = -1.54740178e-07  norm(t1,t2) = 5.17023e-06
cycle = 10  E_corr(CCSD) = -0.0691428614253673  dE = -9.97587102e-08  norm(t1,t2) = 1.61695e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -14.91905278733428  E_corr = -0.06914286142536734
cycle = 1  norm(lambda1,lambda2) = 0.090433
cycle = 2  norm(lambda1,lambda2) = 0.0219269
cycle = 3  norm(lambda1,lambda2) = 0.00648611
cycle = 4  norm(lambda1,lambda2) = 0.00246419
cycle = 5  norm(lambda1,lambda2) = 0.000434486
cycle = 6  norm(lambda1,lambda2) = 0.000146877
cycle = 7  norm(lambda1,lambda2) = 7.00034e-05
cycle = 8  norm(lambda1,lambda2) = 2.31051e-05
cycle = 9  norm(lambda1,lambda2) = 5.6758e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 Be     0.0452877430    -0.0000000387     0.0000000032
1 H    -0.0452877431     0.0000000387    -0.0000000032
----------------------------------------------
cycle 2: E = -14.9190527873  dE = -0.0434999  norm(grad) = 0.0640465

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
  Be  -0.128167   0.000002  -0.000000   -0.028167  0.000002 -0.000000
   H   1.128167  -0.000002   0.000000    0.028167 -0.000002  0.000000
New geometry
   1 Be    -0.128167159002   0.000001510830  -0.000000124377 AA   -0.242200828677   0.000002855055  -0.000000235038 Bohr

   2 H      1.128167160992  -0.000001510830   0.000000124377 AA    2.131926957003  -0.000002855055   0.000000235038 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 379 MB)
init E= -14.8435019665153
  HOMO = -0.761637505991431  LUMO = -0.293298456877308
cycle= 1 E= -14.8532654820486  delta_E= -0.00976  |g|= 0.0075  |ddm|= 0.0247
  HOMO = -0.758323586775518  LUMO = -0.287762645384448
cycle= 2 E= -14.8533067416576  delta_E= -4.13e-05  |g|= 0.00242  |ddm|= 0.00757
  HOMO = -0.759798074312407  LUMO = -0.287687713601264
cycle= 3 E= -14.8533130237902  delta_E= -6.28e-06  |g|= 0.000899  |ddm|= 0.00294
  HOMO = -0.760053861168579  LUMO = -0.28763928558942
cycle= 4 E= -14.8533140906651  delta_E= -1.07e-06  |g|= 8.54e-05  |ddm|= 0.00164
  HOMO = -0.760054979810022  LUMO = -0.287617977104231
cycle= 5 E= -14.8533140988592  delta_E= -8.19e-09  |g|= 5.82e-06  |ddm|= 0.000225
  HOMO = -0.760054523635866  LUMO = -0.287616195422059
cycle= 6 E= -14.8533140988836  delta_E= -2.45e-11  |g|= 3.24e-07  |ddm|= 2.07e-05
  HOMO = -0.760054516805641  LUMO = -0.287616119830259
Extra cycle  E= -14.8533140988836  delta_E= 3.55e-15  |g|= 6.9e-08  |ddm|= 1.28e-06
converged SCF energy = -14.8533140988836

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 2, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1736 MB)
Init E_corr(CCSD) = -0.0302388584165013
cycle = 1  E_corr(CCSD) = -0.0621761262251265  dE = -0.0319372678  norm(t1,t2) = 0.109226
cycle = 2  E_corr(CCSD) = -0.0669596080914938  dE = -0.00478348187  norm(t1,t2) = 0.0272116
cycle = 3  E_corr(CCSD) = -0.0685188625084889  dE = -0.00155925442  norm(t1,t2) = 0.00832772
cycle = 4  E_corr(CCSD) = -0.0690648924913214  dE = -0.000546029983  norm(t1,t2) = 0.00311939
cycle = 5  E_corr(CCSD) = -0.0690645912078552  dE = 3.01283466e-07  norm(t1,t2) = 0.000546815
cycle = 6  E_corr(CCSD) = -0.0690684330568037  dE = -3.84184895e-06  norm(t1,t2) = 0.000244282
cycle = 7  E_corr(CCSD) = -0.0690729211860066  dE = -4.4881292e-06  norm(t1,t2) = 0.000117489
cycle = 8  E_corr(CCSD) = -0.0690729905744951  dE = -6.93884884e-08  norm(t1,t2) = 3.74945e-05
cycle = 9  E_corr(CCSD) = -0.0690733246225658  dE = -3.34048071e-07  norm(t1,t2) = 7.09275e-06
cycle = 10  E_corr(CCSD) = -0.0690734458604612  dE = -1.21237895e-07  norm(t1,t2) = 1.58701e-06
cycle = 11  E_corr(CCSD) = -0.0690734522945338  dE = -6.43407252e-09  norm(t1,t2) = 2.85703e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -14.92238755117818  E_corr = -0.06907345229453375
cycle = 1  norm(lambda1,lambda2) = 0.108312
cycle = 2  norm(lambda1,lambda2) = 0.0266304
cycle = 3  norm(lambda1,lambda2) = 0.00790872
cycle = 4  norm(lambda1,lambda2) = 0.00311807
cycle = 5  norm(lambda1,lambda2) = 0.000591108
cycle = 6  norm(lambda1,lambda2) = 0.000285499
cycle = 7  norm(lambda1,lambda2) = 0.000133303
cycle = 8  norm(lambda1,lambda2) = 3.58294e-05
cycle = 9  norm(lambda1,lambda2) = 7.11597e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 Be     0.0183772486    -0.0000000438     0.0000000038
1 H    -0.0183772486     0.0000000438    -0.0000000038
----------------------------------------------
cycle 3: E = -14.9223875512  dE = -0.00333476  norm(grad) = 0.0259894

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
  Be  -0.147403   0.000002  -0.000000   -0.019235  0.000000 -0.000000
   H   1.147403  -0.000002   0.000000    0.019235 -0.000000  0.000000
New geometry
   1 Be    -0.147402587530   0.000001721840  -0.000000151902 AA   -0.278550520483   0.000003253805  -0.000000287054 Bohr

   2 H      1.147402590139  -0.000001721840   0.000000151902 AA    2.168276649979  -0.000003253805   0.000000287054 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 383 MB)
init E= -14.8459434167825
  HOMO = -0.754210893732052  LUMO = -0.292270396160107
cycle= 1 E= -14.8541031651059  delta_E= -0.00816  |g|= 0.00501  |ddm|= 0.0146
  HOMO = -0.751429800938133  LUMO = -0.288068246174655
cycle= 2 E= -14.8541221335411  delta_E= -1.9e-05  |g|= 0.0016  |ddm|= 0.00519
  HOMO = -0.752435741346002  LUMO = -0.28803511715497
cycle= 3 E= -14.8541248480828  delta_E= -2.71e-06  |g|= 0.000594  |ddm|= 0.00196
  HOMO = -0.752609369898512  LUMO = -0.288009579302693
cycle= 4 E= -14.854125307224  delta_E= -4.59e-07  |g|= 5.88e-05  |ddm|= 0.00106
  HOMO = -0.752609918292648  LUMO = -0.287993716014516
cycle= 5 E= -14.8541253112106  delta_E= -3.99e-09  |g|= 3.88e-06  |ddm|= 0.00016
  HOMO = -0.752609697516138  LUMO = -0.287992437709767
cycle= 6 E= -14.8541253112218  delta_E= -1.11e-11  |g|= 2.28e-07  |ddm|= 1.43e-05
  HOMO = -0.752609693304426  LUMO = -0.28799238809947
Extra cycle  E= -14.8541253112218  delta_E= -4.26e-14  |g|= 5.01e-08  |ddm|= 8.27e-07
converged SCF energy = -14.8541253112218

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 2, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1739 MB)
Init E_corr(CCSD) = -0.0505438274285255
cycle = 1  E_corr(CCSD) = -0.066363263567974  dE = -0.0158194361  norm(t1,t2) = 0.0602838
cycle = 2  E_corr(CCSD) = -0.068321493148482  dE = -0.00195822958  norm(t1,t2) = 0.0132211
cycle = 3  E_corr(CCSD) = -0.0689100100856757  dE = -0.000588516937  norm(t1,t2) = 0.0038563
cycle = 4  E_corr(CCSD) = -0.0690392460625156  dE = -0.000129235977  norm(t1,t2) = 0.00125656
cycle = 5  E_corr(CCSD) = -0.069043070483108  dE = -3.82442059e-06  norm(t1,t2) = 0.000402497
cycle = 6  E_corr(CCSD) = -0.0690405113969208  dE = 2.55908619e-06  norm(t1,t2) = 0.000132339
cycle = 7  E_corr(CCSD) = -0.0690376501230396  dE = 2.86127388e-06  norm(t1,t2) = 6.85817e-05
cycle = 8  E_corr(CCSD) = -0.0690361890493085  dE = 1.46107373e-06  norm(t1,t2) = 2.14378e-05
cycle = 9  E_corr(CCSD) = -0.0690362685245892  dE = -7.94752808e-08  norm(t1,t2) = 4.36574e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -14.92316157974639  E_corr = -0.06903626852458922
cycle = 1  norm(lambda1,lambda2) = 0.0591324
cycle = 2  norm(lambda1,lambda2) = 0.0129293
cycle = 3  norm(lambda1,lambda2) = 0.00371099
cycle = 4  norm(lambda1,lambda2) = 0.00123512
cycle = 5  norm(lambda1,lambda2) = 0.000356364
cycle = 6  norm(lambda1,lambda2) = 0.000106644
cycle = 7  norm(lambda1,lambda2) = 5.4214e-05
cycle = 8  norm(lambda1,lambda2) = 2.00043e-05
cycle = 9  norm(lambda1,lambda2) = 4.67887e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 Be     0.0033473023    -0.0000000100     0.0000000107
1 H    -0.0033473023     0.0000000100    -0.0000000107
----------------------------------------------
cycle 4: E = -14.9231615797  dE = -0.000774029  norm(grad) = 0.0047338

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
  Be  -0.151686   0.000002  -0.000001   -0.004284  0.000000 -0.000000
   H   1.151686  -0.000002   0.000001    0.004284 -0.000000  0.000000
New geometry
   1 Be    -0.151686488066   0.000001822626  -0.000000587397 AA   -0.286645919243   0.000003444264  -0.000001110020 Bohr

   2 H      1.151686490803  -0.000001822626   0.000000587397 AA    2.176372048980  -0.000003444264   0.000001110020 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 383 MB)
init E= -14.8521196152869
  HOMO = -0.751380804274721  LUMO = -0.289074690091421
cycle= 1 E= -14.854160498005  delta_E= -0.00204  |g|= 0.00111  |ddm|= 0.00312
  HOMO = -0.750705780566034  LUMO = -0.288091571025819
cycle= 2 E= -14.8541614359955  delta_E= -9.38e-07  |g|= 0.000352  |ddm|= 0.00116
  HOMO = -0.750930090882247  LUMO = -0.288087367779526
cycle= 3 E= -14.8541615663945  delta_E= -1.3e-07  |g|= 0.00013  |ddm|= 0.000432
  HOMO = -0.750968386347775  LUMO = -0.288082570735855
cycle= 4 E= -14.8541615882908  delta_E= -2.19e-08  |g|= 1.33e-05  |ddm|= 0.000231
  HOMO = -0.750968502882125  LUMO = -0.288078873793488
cycle= 5 E= -14.854161588496  delta_E= -2.05e-10  |g|= 8.56e-07  |ddm|= 3.63e-05
  HOMO = -0.750968464591403  LUMO = -0.288078651229214
Extra cycle  E= -14.8541615884965  delta_E= -4.83e-13  |g|= 2.24e-07  |ddm|= 2.46e-06
converged SCF energy = -14.8541615884965

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 2, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1738 MB)
Init E_corr(CCSD) = -0.051178583219463
cycle = 1  E_corr(CCSD) = -0.0663081260658393  dE = -0.0151295428  norm(t1,t2) = 0.0672627
cycle = 2  E_corr(CCSD) = -0.0682901847541869  dE = -0.00198205869  norm(t1,t2) = 0.0164599
cycle = 3  E_corr(CCSD) = -0.0688755577327628  dE = -0.000585372979  norm(t1,t2) = 0.00579657
cycle = 4  E_corr(CCSD) = -0.0690664348538783  dE = -0.000190877121  norm(t1,t2) = 0.00219008
cycle = 5  E_corr(CCSD) = -0.0690393936297205  dE = 2.70412242e-05  norm(t1,t2) = 0.000432204
cycle = 6  E_corr(CCSD) = -0.0690336747546016  dE = 5.71887512e-06  norm(t1,t2) = 0.000102633
cycle = 7  E_corr(CCSD) = -0.0690307283780026  dE = 2.9463766e-06  norm(t1,t2) = 5.59641e-05
cycle = 8  E_corr(CCSD) = -0.0690294393728246  dE = 1.28900518e-06  norm(t1,t2) = 2.29888e-05
cycle = 9  E_corr(CCSD) = -0.0690296555671602  dE = -2.16194336e-07  norm(t1,t2) = 4.96854e-06
cycle = 10  E_corr(CCSD) = -0.0690297632718426  dE = -1.07704682e-07  norm(t1,t2) = 9.23685e-07
cycle = 11  E_corr(CCSD) = -0.0690297699035669  dE = -6.63172432e-09  norm(t1,t2) = 1.45447e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -14.92319135840004  E_corr = -0.06902976990356691
cycle = 1  norm(lambda1,lambda2) = 0.066032
cycle = 2  norm(lambda1,lambda2) = 0.0161148
cycle = 3  norm(lambda1,lambda2) = 0.00557896
cycle = 4  norm(lambda1,lambda2) = 0.00215647
cycle = 5  norm(lambda1,lambda2) = 0.000402386
cycle = 6  norm(lambda1,lambda2) = 8.20558e-05
cycle = 7  norm(lambda1,lambda2) = 3.78007e-05
cycle = 8  norm(lambda1,lambda2) = 1.75658e-05
cycle = 9  norm(lambda1,lambda2) = 5.39284e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 Be     0.0003424388     0.0000000156     0.0000000095
1 H    -0.0003424388    -0.0000000156    -0.0000000095
----------------------------------------------
cycle 5: E = -14.9231913584  dE = -2.97787e-05  norm(grad) = 0.000484282

Geometry optimization cycle 6
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
  Be  -0.152175   0.000001  -0.000001   -0.000488 -0.000001 -0.000000
   H   1.152175  -0.000001   0.000001    0.000488  0.000001  0.000000
New geometry
   1 Be    -0.152174687837   0.000001165468  -0.000000965872 AA   -0.287568483103   0.000002202415  -0.000001825233 Bohr

   2 H      1.152174690735  -0.000001165468   0.000000965872 AA    2.177294613144  -0.000002202415   0.000001825233 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 386 MB)
init E= -14.8539244405652
  HOMO = -0.750830064872602  LUMO = -0.288202965769365
cycle= 1 E= -14.8541625909491  delta_E= -0.000238  |g|= 0.000126  |ddm|= 0.000354
  HOMO = -0.75075189414289  LUMO = -0.288089829605424
cycle= 2 E= -14.8541626031342  delta_E= -1.22e-08  |g|= 4.01e-05  |ddm|= 0.000132
  HOMO = -0.750777470397287  LUMO = -0.288089424841769
cycle= 3 E= -14.8541626048203  delta_E= -1.69e-09  |g|= 1.48e-05  |ddm|= 4.92e-05
  HOMO = -0.750781826908462  LUMO = -0.28808889586566
cycle= 4 E= -14.854162605103  delta_E= -2.83e-10  |g|= 1.52e-06  |ddm|= 2.62e-05
  HOMO = -0.75078183965144  LUMO = -0.288088470968719
cycle= 5 E= -14.8541626051057  delta_E= -2.72e-12  |g|= 9.74e-08  |ddm|= 4.15e-06
  HOMO = -0.750781835511947  LUMO = -0.288088445352049
Extra cycle  E= -14.8541626051057  delta_E= 1.78e-14  |g|= 2.55e-08  |ddm|= 2.8e-07
converged SCF energy = -14.8541626051057

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 2, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1742 MB)
Init E_corr(CCSD) = -0.0574869258150067
cycle = 1  E_corr(CCSD) = -0.0671073955219551  dE = -0.00962046971  norm(t1,t2) = 0.0603769
cycle = 2  E_corr(CCSD) = -0.0685260694419779  dE = -0.00141867392  norm(t1,t2) = 0.0153867
cycle = 3  E_corr(CCSD) = -0.0688541027248794  dE = -0.000328033283  norm(t1,t2) = 0.00508252
cycle = 4  E_corr(CCSD) = -0.069054961053531  dE = -0.000200858329  norm(t1,t2) = 0.00221755
cycle = 5  E_corr(CCSD) = -0.0690381391378699  dE = 1.68219157e-05  norm(t1,t2) = 0.000447548
cycle = 6  E_corr(CCSD) = -0.06903278381831  dE = 5.35531956e-06  norm(t1,t2) = 0.000132033
cycle = 7  E_corr(CCSD) = -0.0690299675639069  dE = 2.8162544e-06  norm(t1,t2) = 6.94112e-05
cycle = 8  E_corr(CCSD) = -0.0690288894433735  dE = 1.07812053e-06  norm(t1,t2) = 2.56749e-05
cycle = 9  E_corr(CCSD) = -0.0690290309016269  dE = -1.41458253e-07  norm(t1,t2) = 3.83309e-06
cycle = 10  E_corr(CCSD) = -0.0690290674411278  dE = -3.65395009e-08  norm(t1,t2) = 6.93874e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -14.9231916725468  E_corr = -0.06902906744112777
cycle = 1  norm(lambda1,lambda2) = 0.0591404
cycle = 2  norm(lambda1,lambda2) = 0.0151284
cycle = 3  norm(lambda1,lambda2) = 0.00492205
cycle = 4  norm(lambda1,lambda2) = 0.00216223
cycle = 5  norm(lambda1,lambda2) = 0.00040854
cycle = 6  norm(lambda1,lambda2) = 0.000109788
cycle = 7  norm(lambda1,lambda2) = 5.38667e-05
cycle = 8  norm(lambda1,lambda2) = 2.2702e-05
cycle = 9  norm(lambda1,lambda2) = 4.14999e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 Be     0.0000074811     0.0000000000     0.0000000000
1 H    -0.0000074811    -0.0000000000    -0.0000000000
----------------------------------------------
cycle 6: E = -14.9231916725  dE = -3.14147e-07  norm(grad) = 1.05798e-05
