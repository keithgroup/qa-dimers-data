#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/f.h/f.h.chrg0.mult1/f.h.chrg0.mult1.geomopt/f.h.chrg0.mult1.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['F', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 0
multiplicity = 1
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n174.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:40 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 F      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 4.76259489828
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         1.56
Create scanner for <class 'pyscf.grad.ccsd.Gradients'>
Set <class 'pyscf.cc.ccsd.CCSD'> as a scanner
Create scanner for <class 'pyscf.scf.hf.RHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   F   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 F      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 145 MB)
init E= -99.78993122634
  HOMO = -0.651916571480644  LUMO = 0.0410986186648423
cycle= 1 E= -100.02768106591  delta_E= -0.238  |g|= 0.422  |ddm|= 0.789
  HOMO = -0.557823556255479  LUMO = 0.0705215156986125
cycle= 2 E= -100.050855347322  delta_E= -0.0232  |g|= 0.272  |ddm|= 0.211
  HOMO = -0.649645957924331  LUMO = 0.0744312620143176
cycle= 3 E= -100.059761490316  delta_E= -0.00891  |g|= 0.0391  |ddm|= 0.0728
  HOMO = -0.640086814629095  LUMO = 0.0788072117535654
cycle= 4 E= -100.060040507238  delta_E= -0.000279  |g|= 0.00847  |ddm|= 0.0147
  HOMO = -0.641354335625242  LUMO = 0.0796286758912326
cycle= 5 E= -100.060075337218  delta_E= -3.48e-05  |g|= 0.00183  |ddm|= 0.00773
  HOMO = -0.641666491693029  LUMO = 0.0797060840515015
cycle= 6 E= -100.060077528497  delta_E= -2.19e-06  |g|= 0.000276  |ddm|= 0.00163
  HOMO = -0.641769352896263  LUMO = 0.0797092077647553
cycle= 7 E= -100.060077573004  delta_E= -4.45e-08  |g|= 2.38e-05  |ddm|= 0.000322
  HOMO = -0.641769861803198  LUMO = 0.079710426673714
cycle= 8 E= -100.06007757324  delta_E= -2.36e-10  |g|= 2.46e-06  |ddm|= 3.76e-05
  HOMO = -0.641769608111469  LUMO = 0.0797106170455363
cycle= 9 E= -100.060077573242  delta_E= -2.59e-12  |g|= 2.1e-07  |ddm|= 3.92e-06
  HOMO = -0.641769547039986  LUMO = 0.0797106217283761
Extra cycle  E= -100.060077573242  delta_E= 1.99e-13  |g|= 7.1e-08  |ddm|= 2.9e-07
converged SCF energy = -100.060077573242

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 5, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1524 MB)
Init t2, MP2 energy = -100.410785477967  E_corr(MP2) -0.350707904725141
Init E_corr(CCSD) = -0.350707904725146
cycle = 1  E_corr(CCSD) = -0.342176494264622  dE = 0.00853141046  norm(t1,t2) = 0.0292091
cycle = 2  E_corr(CCSD) = -0.348375447290678  dE = -0.00619895303  norm(t1,t2) = 0.00978343
cycle = 3  E_corr(CCSD) = -0.34809785468247  dE = 0.000277592608  norm(t1,t2) = 0.00395083
cycle = 4  E_corr(CCSD) = -0.348498401390556  dE = -0.000400546708  norm(t1,t2) = 0.0013171
cycle = 5  E_corr(CCSD) = -0.348558176803257  dE = -5.97754127e-05  norm(t1,t2) = 0.000179144
cycle = 6  E_corr(CCSD) = -0.348546732711171  dE = 1.14440921e-05  norm(t1,t2) = 4.17321e-05
cycle = 7  E_corr(CCSD) = -0.34854442656976  dE = 2.30614141e-06  norm(t1,t2) = 1.04408e-05
cycle = 8  E_corr(CCSD) = -0.348545295234819  dE = -8.68665059e-07  norm(t1,t2) = 3.50982e-06
cycle = 9  E_corr(CCSD) = -0.348545363171123  dE = -6.79363041e-08  norm(t1,t2) = 9.03441e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -100.4086229364131  E_corr = -0.3485453631711227
cycle = 1  norm(lambda1,lambda2) = 0.00959126
cycle = 2  norm(lambda1,lambda2) = 0.00201925
cycle = 3  norm(lambda1,lambda2) = 0.00112165
cycle = 4  norm(lambda1,lambda2) = 0.000375667
cycle = 5  norm(lambda1,lambda2) = 3.7892e-05
cycle = 6  norm(lambda1,lambda2) = 1.29464e-05
cycle = 7  norm(lambda1,lambda2) = 2.19696e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 F    -0.0775409054    -0.0000000000     0.0000000000
1 H     0.0775409054     0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -100.408622936  dE = -100.409  norm(grad) = 0.109659

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   F   0.043022   0.000000  -0.000000    0.043022  0.000000 -0.000000
   H   0.956978  -0.000000   0.000000   -0.043022 -0.000000  0.000000
New geometry
   1 F      0.043021930040   0.000000000000  -0.000000000000 AA    0.081299665126   0.000000000000  -0.000000000000 Bohr

   2 H      0.956978069957  -0.000000000000   0.000000000000 AA    1.808426459434  -0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 384 MB)
init E= -100.130128722225
  HOMO = -0.625586672718284  LUMO = 0.103441355884898
cycle= 1 E= -100.070185529407  delta_E= 0.0599  |g|= 0.0446  |ddm|= 0.0457
  HOMO = -0.659292010427847  LUMO = 0.0865004907021907
cycle= 2 E= -100.07050438489  delta_E= -0.000319  |g|= 0.0227  |ddm|= 0.0191
  HOMO = -0.64974040036786  LUMO = 0.0874172795103287
cycle= 3 E= -100.070560860837  delta_E= -5.65e-05  |g|= 0.005  |ddm|= 0.00634
  HOMO = -0.650655137142319  LUMO = 0.0875257940709544
cycle= 4 E= -100.070566239575  delta_E= -5.38e-06  |g|= 0.00131  |ddm|= 0.00169
  HOMO = -0.650193565840502  LUMO = 0.0874843868703682
cycle= 5 E= -100.070566943818  delta_E= -7.04e-07  |g|= 0.000298  |ddm|= 0.00091
  HOMO = -0.650236493665948  LUMO = 0.0874543852239064
cycle= 6 E= -100.070566981952  delta_E= -3.81e-08  |g|= 3.08e-05  |ddm|= 0.000234
  HOMO = -0.650232371908609  LUMO = 0.0874529902537456
cycle= 7 E= -100.070566982331  delta_E= -3.79e-10  |g|= 3.56e-06  |ddm|= 3.16e-05
  HOMO = -0.650231463896775  LUMO = 0.0874531911198044
cycle= 8 E= -100.070566982335  delta_E= -3.92e-12  |g|= 4.7e-07  |ddm|= 4.99e-06
  HOMO = -0.650231313090071  LUMO = 0.0874532198127865
Extra cycle  E= -100.070566982334  delta_E= 3.13e-13  |g|= 1.84e-07  |ddm|= 5.73e-07
converged SCF energy = -100.070566982334

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 5, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1704 MB)
Init E_corr(CCSD) = -0.0918425978062249
cycle = 1  E_corr(CCSD) = -0.345985858415631  dE = -0.254143261  norm(t1,t2) = 0.169168
cycle = 2  E_corr(CCSD) = -0.341238868593035  dE = 0.00474698982  norm(t1,t2) = 0.0318101
cycle = 3  E_corr(CCSD) = -0.345050155216633  dE = -0.00381128662  norm(t1,t2) = 0.00768985
cycle = 4  E_corr(CCSD) = -0.345234028076785  dE = -0.00018387286  norm(t1,t2) = 0.00328209
cycle = 5  E_corr(CCSD) = -0.34515319879097  dE = 8.08292858e-05  norm(t1,t2) = 0.000811719
cycle = 6  E_corr(CCSD) = -0.345159225368675  dE = -6.0265777e-06  norm(t1,t2) = 0.000214132
cycle = 7  E_corr(CCSD) = -0.345155817246629  dE = 3.40812205e-06  norm(t1,t2) = 5.27498e-05
cycle = 8  E_corr(CCSD) = -0.345153996484144  dE = 1.82076248e-06  norm(t1,t2) = 1.41255e-05
cycle = 9  E_corr(CCSD) = -0.345153736060005  dE = 2.60424139e-07  norm(t1,t2) = 5.25442e-06
cycle = 10  E_corr(CCSD) = -0.345153808472329  dE = -7.24123237e-08  norm(t1,t2) = 1.74921e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -100.4157207908068  E_corr = -0.3451538084723287
cycle = 1  norm(lambda1,lambda2) = 0.169597
cycle = 2  norm(lambda1,lambda2) = 0.0281917
cycle = 3  norm(lambda1,lambda2) = 0.00670028
cycle = 4  norm(lambda1,lambda2) = 0.00265102
cycle = 5  norm(lambda1,lambda2) = 0.000626318
cycle = 6  norm(lambda1,lambda2) = 0.000205611
cycle = 7  norm(lambda1,lambda2) = 4.69586e-05
cycle = 8  norm(lambda1,lambda2) = 1.42732e-05
cycle = 9  norm(lambda1,lambda2) = 4.54243e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 F    -0.0015551989     0.0000000293     0.0000000909
1 H     0.0015551989    -0.0000000293    -0.0000000909
----------------------------------------------
cycle 2: E = -100.415720791  dE = -0.00709785  norm(grad) = 0.00219938

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   F   0.043902  -0.000001  -0.000002    0.000881 -0.000001 -0.000002
   H   0.956098   0.000001   0.000002   -0.000881  0.000001  0.000002
New geometry
   1 F      0.043902459547  -0.000000528436  -0.000001640960 AA    0.082963624738  -0.000000998600  -0.000003100964 Bohr

   2 H      0.956097540442   0.000000528436   0.000001640960 AA    1.806762499806   0.000000998600   0.000003100964 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 436 MB)
init E= -100.072054018564
  HOMO = -0.649807776432254  LUMO = 0.08796561611104
cycle= 1 E= -100.070636180958  delta_E= 0.00142  |g|= 0.00101  |ddm|= 0.00101
  HOMO = -0.650629882142878  LUMO = 0.0875632830778385
cycle= 2 E= -100.070636340135  delta_E= -1.59e-07  |g|= 0.00055  |ddm|= 0.000443
  HOMO = -0.650405698443967  LUMO = 0.0875825352026713
cycle= 3 E= -100.070636373225  delta_E= -3.31e-08  |g|= 0.000105  |ddm|= 0.000148
  HOMO = -0.650421720946988  LUMO = 0.0875852376443347
cycle= 4 E= -100.070636375707  delta_E= -2.48e-09  |g|= 2.77e-05  |ddm|= 3.69e-05
  HOMO = -0.650412044641775  LUMO = 0.0875842632143736
cycle= 5 E= -100.07063637604  delta_E= -3.34e-10  |g|= 6.39e-06  |ddm|= 1.99e-05
  HOMO = -0.650413021140792  LUMO = 0.0875836289578543
cycle= 6 E= -100.070636376058  delta_E= -1.8e-11  |g|= 6.46e-07  |ddm|= 5.09e-06
  HOMO = -0.650412952957598  LUMO = 0.0875836134177156
Extra cycle  E= -100.070636376058  delta_E= 2.84e-13  |g|= 2.15e-07  |ddm|= 5.21e-07
converged SCF energy = -100.070636376058

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 5, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1755 MB)
Init E_corr(CCSD) = -0.130796330580674
cycle = 1  E_corr(CCSD) = -0.350969814149953  dE = -0.220173484  norm(t1,t2) = 0.143656
cycle = 2  E_corr(CCSD) = -0.34223606971945  dE = 0.00873374443  norm(t1,t2) = 0.0320325
cycle = 3  E_corr(CCSD) = -0.345396199166049  dE = -0.00316012945  norm(t1,t2) = 0.00798034
cycle = 4  E_corr(CCSD) = -0.345219496380403  dE = 0.000176702786  norm(t1,t2) = 0.00366294
cycle = 5  E_corr(CCSD) = -0.34505379062916  dE = 0.000165705751  norm(t1,t2) = 0.000829812
cycle = 6  E_corr(CCSD) = -0.345084223784382  dE = -3.04331552e-05  norm(t1,t2) = 0.000227608
cycle = 7  E_corr(CCSD) = -0.345088251214479  dE = -4.0274301e-06  norm(t1,t2) = 5.80803e-05
cycle = 8  E_corr(CCSD) = -0.345086155119917  dE = 2.09609456e-06  norm(t1,t2) = 1.29479e-05
cycle = 9  E_corr(CCSD) = -0.345086080108587  dE = 7.50113298e-08  norm(t1,t2) = 4.26682e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -100.4157224561665  E_corr = -0.3450860801085872
cycle = 1  norm(lambda1,lambda2) = 0.144025
cycle = 2  norm(lambda1,lambda2) = 0.0255845
cycle = 3  norm(lambda1,lambda2) = 0.00647912
cycle = 4  norm(lambda1,lambda2) = 0.00261548
cycle = 5  norm(lambda1,lambda2) = 0.00059703
cycle = 6  norm(lambda1,lambda2) = 0.0001858
cycle = 7  norm(lambda1,lambda2) = 4.74338e-05
cycle = 8  norm(lambda1,lambda2) = 9.76806e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 F     0.0005702964     0.0000000011     0.0000000014
1 H    -0.0005702964    -0.0000000011    -0.0000000014
----------------------------------------------
cycle 3: E = -100.415722456  dE = -1.66536e-06  norm(grad) = 0.000806521

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   F   0.043666  -0.000001  -0.000002   -0.000236 -0.000000  0.000000
   H   0.956334   0.000001   0.000002    0.000236  0.000000 -0.000000
New geometry
   1 F      0.043666202714  -0.000000531445  -0.000001623501 AA    0.082517164030  -0.000001004286  -0.000003067972 Bohr

   2 H      0.956333797309   0.000000531445   0.000001623501 AA    1.807208960579   0.000001004286   0.000003067972 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 405 MB)
init E= -100.070236753431
  HOMO = -0.650527314738444  LUMO = 0.0874458524288549
cycle= 1 E= -100.070618444736  delta_E= -0.000382  |g|= 0.000272  |ddm|= 0.000272
  HOMO = -0.650305717226154  LUMO = 0.0875541913825668
cycle= 2 E= -100.070618456247  delta_E= -1.15e-08  |g|= 0.000148  |ddm|= 0.000119
  HOMO = -0.650366101302616  LUMO = 0.0875490168257231
cycle= 3 E= -100.070618458653  delta_E= -2.41e-09  |g|= 2.81e-05  |ddm|= 3.99e-05
  HOMO = -0.650361828923732  LUMO = 0.0875482860555808
cycle= 4 E= -100.070618458832  delta_E= -1.79e-10  |g|= 7.43e-06  |ddm|= 9.91e-06
  HOMO = -0.650364425999325  LUMO = 0.0875485478191035
cycle= 5 E= -100.070618458856  delta_E= -2.41e-11  |g|= 1.72e-06  |ddm|= 5.34e-06
  HOMO = -0.650364164332473  LUMO = 0.0875487183110599
cycle= 6 E= -100.070618458857  delta_E= -1.26e-12  |g|= 1.74e-07  |ddm|= 1.37e-06
  HOMO = -0.650364182507372  LUMO = 0.0875487225359407
Extra cycle  E= -100.070618458857  delta_E= -2.84e-14  |g|= 5.79e-08  |ddm|= 1.4e-07
converged SCF energy = -100.070618458857

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 5, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1756 MB)
Init E_corr(CCSD) = -0.190960506910637
cycle = 1  E_corr(CCSD) = -0.348242106020209  dE = -0.157281599  norm(t1,t2) = 0.133775
cycle = 2  E_corr(CCSD) = -0.342602492829044  dE = 0.00563961319  norm(t1,t2) = 0.0379879
cycle = 3  E_corr(CCSD) = -0.345258799103759  dE = -0.00265630627  norm(t1,t2) = 0.00945714
cycle = 4  E_corr(CCSD) = -0.345220719587083  dE = 3.80795167e-05  norm(t1,t2) = 0.00519325
cycle = 5  E_corr(CCSD) = -0.345094223593795  dE = 0.000126495993  norm(t1,t2) = 0.000936501
cycle = 6  E_corr(CCSD) = -0.345103445129281  dE = -9.22153549e-06  norm(t1,t2) = 0.000195208
cycle = 7  E_corr(CCSD) = -0.345106254745894  dE = -2.80961661e-06  norm(t1,t2) = 6.11458e-05
cycle = 8  E_corr(CCSD) = -0.34510434844669  dE = 1.9062992e-06  norm(t1,t2) = 1.55743e-05
cycle = 9  E_corr(CCSD) = -0.345104216850934  dE = 1.31595756e-07  norm(t1,t2) = 4.4842e-06
cycle = 10  E_corr(CCSD) = -0.345104254785708  dE = -3.79347737e-08  norm(t1,t2) = 1.04806e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -100.4157227136431  E_corr = -0.3451042547857079
cycle = 1  norm(lambda1,lambda2) = 0.134206
cycle = 2  norm(lambda1,lambda2) = 0.0304768
cycle = 3  norm(lambda1,lambda2) = 0.00792371
cycle = 4  norm(lambda1,lambda2) = 0.0038669
cycle = 5  norm(lambda1,lambda2) = 0.000750953
cycle = 6  norm(lambda1,lambda2) = 0.000168621
cycle = 7  norm(lambda1,lambda2) = 4.82632e-05
cycle = 8  norm(lambda1,lambda2) = 1.26227e-05
cycle = 9  norm(lambda1,lambda2) = 3.45994e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 F    -0.0000028673    -0.0000000000    -0.0000000000
1 H     0.0000028673     0.0000000000     0.0000000000
----------------------------------------------
cycle 4: E = -100.415722714  dE = -2.57477e-07  norm(grad) = 4.055e-06
