#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/o.h/o.h.chrg-1.mult3/o.h.chrg-1.mult3.geomopt/o.h.chrg-1.mult3.sep1.0-pyscf.qa-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['O', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = -1
multiplicity = 3
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n48.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 10
[INPUT] charge = -1
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 4.23341768736
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.07
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 149 MB)
number electrons alpha = 6  beta = 4
init E= -75.0300121843385
  alpha nocc = 6  HOMO = 0.0734432383920771  LUMO = 0.300021033637348

WARN: beta  nocc = 4  HOMO -0.430043885065022 >= LUMO -0.43004388506502


WARN: system HOMO 0.0734432383920771 >= system LUMO -0.43004388506502

cycle= 1 E= -75.3225822373477  delta_E= -0.293  |g|= 0.186  |ddm|= 5.45
  alpha nocc = 6  HOMO = 0.0819183348736704  LUMO = 0.503445646119187
  beta  nocc = 4  HOMO = -0.226431837914854  LUMO = 0.332745873923861
cycle= 2 E= -75.3372874547332  delta_E= -0.0147  |g|= 0.0639  |ddm|= 0.756
  alpha nocc = 6  HOMO = 0.0800292969428793  LUMO = 0.493163674397936
  beta  nocc = 4  HOMO = -0.271194642062111  LUMO = 0.317176693390725
cycle= 3 E= -75.3394069726103  delta_E= -0.00212  |g|= 0.0304  |ddm|= 0.404
  alpha nocc = 6  HOMO = 0.0804395980023194  LUMO = 0.494611855635717
  beta  nocc = 4  HOMO = -0.25885884186424  LUMO = 0.326689270809163
cycle= 4 E= -75.3399456143641  delta_E= -0.000539  |g|= 0.0079  |ddm|= 0.233
  alpha nocc = 6  HOMO = 0.0803740978467233  LUMO = 0.494517282718339
  beta  nocc = 4  HOMO = -0.259916252055147  LUMO = 0.32512674316868
cycle= 5 E= -75.3400376710061  delta_E= -9.21e-05  |g|= 0.00339  |ddm|= 0.133
  alpha nocc = 6  HOMO = 0.0808199673596551  LUMO = 0.494201012555307
  beta  nocc = 4  HOMO = -0.258666192662069  LUMO = 0.32502971268135
cycle= 6 E= -75.3400592505014  delta_E= -2.16e-05  |g|= 0.00109  |ddm|= 0.0642
  alpha nocc = 6  HOMO = 0.080865724100555  LUMO = 0.494102724263094
  beta  nocc = 4  HOMO = -0.25837106108638  LUMO = 0.324889646065143
cycle= 7 E= -75.3400614585554  delta_E= -2.21e-06  |g|= 0.000353  |ddm|= 0.00731
  alpha nocc = 6  HOMO = 0.0808547384551185  LUMO = 0.494116117774676
  beta  nocc = 4  HOMO = -0.258249812787944  LUMO = 0.324939311202356
cycle= 8 E= -75.3400616725594  delta_E= -2.14e-07  |g|= 9.49e-05  |ddm|= 0.00651
  alpha nocc = 6  HOMO = 0.0808403925528726  LUMO = 0.494130541378135
  beta  nocc = 4  HOMO = -0.258247002444142  LUMO = 0.324955858183982
cycle= 9 E= -75.3400616884366  delta_E= -1.59e-08  |g|= 1.89e-05  |ddm|= 0.00161
  alpha nocc = 6  HOMO = 0.0808381564590787  LUMO = 0.494134201928578
  beta  nocc = 4  HOMO = -0.2582416424384  LUMO = 0.324959865693726
cycle= 10 E= -75.3400616889895  delta_E= -5.53e-10  |g|= 3.62e-06  |ddm|= 0.000387
  alpha nocc = 6  HOMO = 0.0808377482994587  LUMO = 0.494134187833297
  beta  nocc = 4  HOMO = -0.25824203900514  LUMO = 0.324959596887079
cycle= 11 E= -75.340061689007  delta_E= -1.75e-11  |g|= 7.64e-07  |ddm|= 4.8e-05
  alpha nocc = 6  HOMO = 0.0808377763079921  LUMO = 0.494134202706911
  beta  nocc = 4  HOMO = -0.258242019660247  LUMO = 0.324959748253046
Extra cycle  E= -75.3400616890074  delta_E= -4.55e-13  |g|= 4.1e-07  |ddm|= 5.05e-06
converged SCF energy = -75.3400616890074  <S^2> = 2.0071208  2S+1 = 3.0047434

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3325 MB)
Init t2, MP2 energy = -0.271897722077111
Init E_corr(CCSD) = -0.271897722077237
cycle = 1  E_corr(CCSD) = -0.276926439965006  dE = -0.00502871789  norm(t1,t2) = 0.0428573
cycle = 2  E_corr(CCSD) = -0.281305527269682  dE = -0.0043790873  norm(t1,t2) = 0.0147542
cycle = 3  E_corr(CCSD) = -0.282302959716596  dE = -0.000997432447  norm(t1,t2) = 0.00765331
cycle = 4  E_corr(CCSD) = -0.282751432976977  dE = -0.00044847326  norm(t1,t2) = 0.00253711
cycle = 5  E_corr(CCSD) = -0.282698101756407  dE = 5.33312206e-05  norm(t1,t2) = 0.000943301
cycle = 6  E_corr(CCSD) = -0.282683318100159  dE = 1.47836562e-05  norm(t1,t2) = 0.000292552
cycle = 7  E_corr(CCSD) = -0.2826999298211  dE = -1.66117209e-05  norm(t1,t2) = 0.000109237
cycle = 8  E_corr(CCSD) = -0.282699987129124  dE = -5.73080243e-08  norm(t1,t2) = 3.09764e-05
cycle = 9  E_corr(CCSD) = -0.282699541494352  dE = 4.45634772e-07  norm(t1,t2) = 8.41244e-06
cycle = 10  E_corr(CCSD) = -0.282699849916213  dE = -3.08421861e-07  norm(t1,t2) = 2.69529e-06
cycle = 11  E_corr(CCSD) = -0.282699853170863  dE = -3.25465005e-09  norm(t1,t2) = 7.58192e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -75.62276154217831  E_corr = -0.282699853170863
cycle = 1  norm(lambda1,lambda2) = 0.0100202
cycle = 2  norm(lambda1,lambda2) = 0.00193675
cycle = 3  norm(lambda1,lambda2) = 0.000991177
cycle = 4  norm(lambda1,lambda2) = 0.000362397
cycle = 5  norm(lambda1,lambda2) = 8.34405e-05
cycle = 6  norm(lambda1,lambda2) = 2.93257e-05
cycle = 7  norm(lambda1,lambda2) = 1.20652e-05
cycle = 8  norm(lambda1,lambda2) = 3.59574e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0156926161    -0.0000000000    -0.0000000000
1 H    -0.0156926161     0.0000000000     0.0000000000
----------------------------------------------
cycle 1: E = -75.6227615422  dE = -75.6228  norm(grad) = 0.0221927

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.008707   0.000000   0.000000   -0.008707  0.000000  0.000000
   H   1.008707  -0.000000  -0.000000    0.008707 -0.000000 -0.000000
New geometry
   1 O     -0.008706715876   0.000000000000   0.000000000000 AA   -0.016453308449   0.000000000000   0.000000000000 Bohr

   2 H      1.008706715880  -0.000000000000  -0.000000000000 AA    1.906179433023  -0.000000000000  -0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 519 MB)
number electrons alpha = 6  beta = 4
init E= -75.3309998433559
  alpha nocc = 6  HOMO = 0.0762727945334325  LUMO = 0.496901614778163
  beta  nocc = 4  HOMO = -0.254467958830784  LUMO = 0.327515246551019
cycle= 1 E= -75.33978891849  delta_E= -0.00879  |g|= 0.00428  |ddm|= 0.354
  alpha nocc = 6  HOMO = 0.0790485222829662  LUMO = 0.496764721449639
  beta  nocc = 4  HOMO = -0.254023489374314  LUMO = 0.327516492719661
cycle= 2 E= -75.3398003470193  delta_E= -1.14e-05  |g|= 0.00227  |ddm|= 0.0278
  alpha nocc = 6  HOMO = 0.0789585676361088  LUMO = 0.496517732780174
  beta  nocc = 4  HOMO = -0.255514813971615  LUMO = 0.326473305914821
cycle= 3 E= -75.3398025304515  delta_E= -2.18e-06  |g|= 0.000695  |ddm|= 0.00446
  alpha nocc = 6  HOMO = 0.0789897232152639  LUMO = 0.496457349167067
  beta  nocc = 4  HOMO = -0.255555324507534  LUMO = 0.326444052060825
cycle= 4 E= -75.339803278693  delta_E= -7.48e-07  |g|= 0.000333  |ddm|= 0.00376
  alpha nocc = 6  HOMO = 0.0790417070379787  LUMO = 0.496392584104596
  beta  nocc = 4  HOMO = -0.255620613296927  LUMO = 0.326419744255956
cycle= 5 E= -75.3398035240099  delta_E= -2.45e-07  |g|= 0.00011  |ddm|= 0.00433
  alpha nocc = 6  HOMO = 0.0790443751005057  LUMO = 0.496396277071013
  beta  nocc = 4  HOMO = -0.255609443287049  LUMO = 0.326431115261137
cycle= 6 E= -75.3398035418132  delta_E= -1.78e-08  |g|= 3.64e-05  |ddm|= 0.000944
  alpha nocc = 6  HOMO = 0.0790404820966201  LUMO = 0.496398621786556
  beta  nocc = 4  HOMO = -0.255605817831182  LUMO = 0.326428539344102
cycle= 7 E= -75.3398035441307  delta_E= -2.32e-09  |g|= 1.23e-05  |ddm|= 0.000922
  alpha nocc = 6  HOMO = 0.0790388561807106  LUMO = 0.496400516720681
  beta  nocc = 4  HOMO = -0.255598275057323  LUMO = 0.326429678650547
cycle= 8 E= -75.3398035444397  delta_E= -3.09e-10  |g|= 3.01e-06  |ddm|= 0.000412
  alpha nocc = 6  HOMO = 0.0790386526162726  LUMO = 0.496400925739636
  beta  nocc = 4  HOMO = -0.255595619156362  LUMO = 0.326430205321129
cycle= 9 E= -75.3398035444571  delta_E= -1.74e-11  |g|= 8.08e-07  |ddm|= 5.18e-05
  alpha nocc = 6  HOMO = 0.079038664630366  LUMO = 0.496400921527279
  beta  nocc = 4  HOMO = -0.255595285798319  LUMO = 0.326430257821278
Extra cycle  E= -75.3398035444581  delta_E= -9.66e-13  |g|= 4.73e-07  |ddm|= 1.81e-05
converged SCF energy = -75.3398035444581  <S^2> = 2.007478  2S+1 = 3.0049812

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3500 MB)
Init E_corr(CCSD) = -0.192136752373083
cycle = 1  E_corr(CCSD) = -0.280670107545379  dE = -0.0885333552  norm(t1,t2) = 0.145326
cycle = 2  E_corr(CCSD) = -0.282086338647958  dE = -0.0014162311  norm(t1,t2) = 0.0269632
cycle = 3  E_corr(CCSD) = -0.283280382800307  dE = -0.00119404415  norm(t1,t2) = 0.00678061
cycle = 4  E_corr(CCSD) = -0.283302729971534  dE = -2.23471712e-05  norm(t1,t2) = 0.00233594
cycle = 5  E_corr(CCSD) = -0.28329229256539  dE = 1.04374061e-05  norm(t1,t2) = 0.000582383
cycle = 6  E_corr(CCSD) = -0.283307889747595  dE = -1.55971822e-05  norm(t1,t2) = 0.000169814
cycle = 7  E_corr(CCSD) = -0.283306735655664  dE = 1.15409193e-06  norm(t1,t2) = 6.4163e-05
cycle = 8  E_corr(CCSD) = -0.283306768558306  dE = -3.29026425e-08  norm(t1,t2) = 2.02235e-05
cycle = 9  E_corr(CCSD) = -0.283306760076892  dE = 8.48141402e-09  norm(t1,t2) = 7.41918e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.62311030453498  E_corr = -0.2833067600768922
cycle = 1  norm(lambda1,lambda2) = 0.142864
cycle = 2  norm(lambda1,lambda2) = 0.0253284
cycle = 3  norm(lambda1,lambda2) = 0.00644625
cycle = 4  norm(lambda1,lambda2) = 0.00238655
cycle = 5  norm(lambda1,lambda2) = 0.000588462
cycle = 6  norm(lambda1,lambda2) = 0.00017158
cycle = 7  norm(lambda1,lambda2) = 6.71966e-05
cycle = 8  norm(lambda1,lambda2) = 2.08879e-05
cycle = 9  norm(lambda1,lambda2) = 7.86901e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0057843220    -0.0000004376    -0.0000001154
1 H    -0.0057843220     0.0000004376     0.0000001154
----------------------------------------------
cycle 2: E = -75.6231103045  dE = -0.000348762  norm(grad) = 0.00818027

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.013790   0.000015   0.000004   -0.005083  0.000015  0.000004
   H   1.013790  -0.000015  -0.000004    0.005083 -0.000015 -0.000004
New geometry
   1 O     -0.013789574170   0.000015185418   0.000004003251 AA   -0.026058518556   0.000028696282   0.000007565047 Bohr

   2 H      1.013789574176  -0.000015185418  -0.000004003251 AA    1.915784643132  -0.000028696282  -0.000007565047 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 629 MB)
number electrons alpha = 6  beta = 4
init E= -75.3344528441937
  alpha nocc = 6  HOMO = 0.0763386506620063  LUMO = 0.497898346991994
  beta  nocc = 4  HOMO = -0.253638141612378  LUMO = 0.327735162660932
cycle= 1 E= -75.3395053891909  delta_E= -0.00505  |g|= 0.00254  |ddm|= 0.192
  alpha nocc = 6  HOMO = 0.0779579494181918  LUMO = 0.497906218235458
  beta  nocc = 4  HOMO = -0.25311762324069  LUMO = 0.327942863426066
cycle= 2 E= -75.3395091848382  delta_E= -3.8e-06  |g|= 0.00136  |ddm|= 0.0148
  alpha nocc = 6  HOMO = 0.0778956576007257  LUMO = 0.497769729331531
  beta  nocc = 4  HOMO = -0.253988348651639  LUMO = 0.327332008748811
cycle= 3 E= -75.3395099252822  delta_E= -7.4e-07  |g|= 0.000403  |ddm|= 0.00254
  alpha nocc = 6  HOMO = 0.077906916895479  LUMO = 0.49774497389381
  beta  nocc = 4  HOMO = -0.253989421302198  LUMO = 0.32732660482404
cycle= 4 E= -75.3395101640351  delta_E= -2.39e-07  |g|= 0.000197  |ddm|= 0.00178
  alpha nocc = 6  HOMO = 0.0779324913383008  LUMO = 0.497713868249265
  beta  nocc = 4  HOMO = -0.254008409691279  LUMO = 0.327320999685783
cycle= 5 E= -75.3395102466808  delta_E= -8.26e-08  |g|= 6.83e-05  |ddm|= 0.00216
  alpha nocc = 6  HOMO = 0.0779332655535392  LUMO = 0.497717166213541
  beta  nocc = 4  HOMO = -0.253996793243497  LUMO = 0.327329345240331
cycle= 6 E= -75.3395102539851  delta_E= -7.3e-09  |g|= 2.08e-05  |ddm|= 0.000475
  alpha nocc = 6  HOMO = 0.0779312786731595  LUMO = 0.497717873694199
  beta  nocc = 4  HOMO = -0.253996149400225  LUMO = 0.327326474787116
cycle= 7 E= -75.3395102547403  delta_E= -7.55e-10  |g|= 6.92e-06  |ddm|= 0.000558
  alpha nocc = 6  HOMO = 0.0779305397697451  LUMO = 0.497718692449056
  beta  nocc = 4  HOMO = -0.253992335954701  LUMO = 0.32732667973591
cycle= 8 E= -75.3395102548334  delta_E= -9.31e-11  |g|= 1.84e-06  |ddm|= 0.00024
  alpha nocc = 6  HOMO = 0.0779304360222626  LUMO = 0.49771891503515
  beta  nocc = 4  HOMO = -0.253990810928678  LUMO = 0.327326922821152
cycle= 9 E= -75.3395102548396  delta_E= -6.18e-12  |g|= 5.06e-07  |ddm|= 2.1e-05
  alpha nocc = 6  HOMO = 0.077930441511193  LUMO = 0.497718915155891
  beta  nocc = 4  HOMO = -0.253990629994654  LUMO = 0.327326953995568
Extra cycle  E= -75.3395102548401  delta_E= -4.55e-13  |g|= 3.2e-07  |ddm|= 1.01e-05
converged SCF energy = -75.3395102548401  <S^2> = 2.0077061  2S+1 = 3.005133

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3654 MB)
Init E_corr(CCSD) = -0.236072886850057
cycle = 1  E_corr(CCSD) = -0.282826678012466  dE = -0.0467537912  norm(t1,t2) = 0.109053
cycle = 2  E_corr(CCSD) = -0.282951613586019  dE = -0.000124935574  norm(t1,t2) = 0.0193869
cycle = 3  E_corr(CCSD) = -0.283690779318847  dE = -0.000739165733  norm(t1,t2) = 0.00510283
cycle = 4  E_corr(CCSD) = -0.283633298654764  dE = 5.74806641e-05  norm(t1,t2) = 0.00145559
cycle = 5  E_corr(CCSD) = -0.283655233579632  dE = -2.19349249e-05  norm(t1,t2) = 0.000475464
cycle = 6  E_corr(CCSD) = -0.283661491373009  dE = -6.25779338e-06  norm(t1,t2) = 0.000143314
cycle = 7  E_corr(CCSD) = -0.283661522565208  dE = -3.11921989e-08  norm(t1,t2) = 4.97575e-05
cycle = 8  E_corr(CCSD) = -0.283661748190581  dE = -2.25625373e-07  norm(t1,t2) = 1.82215e-05
cycle = 9  E_corr(CCSD) = -0.283661879418345  dE = -1.31227764e-07  norm(t1,t2) = 5.87748e-06
cycle = 10  E_corr(CCSD) = -0.283661886236785  dE = -6.81843965e-09  norm(t1,t2) = 2.9568e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.62317214107682  E_corr = -0.2836618862367849
cycle = 1  norm(lambda1,lambda2) = 0.106967
cycle = 2  norm(lambda1,lambda2) = 0.0180459
cycle = 3  norm(lambda1,lambda2) = 0.00476487
cycle = 4  norm(lambda1,lambda2) = 0.00140825
cycle = 5  norm(lambda1,lambda2) = 0.000465706
cycle = 6  norm(lambda1,lambda2) = 0.000142094
cycle = 7  norm(lambda1,lambda2) = 5.29631e-05
cycle = 8  norm(lambda1,lambda2) = 1.85969e-05
cycle = 9  norm(lambda1,lambda2) = 5.63892e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0007454983    -0.0000001416    -0.0000000392
1 H    -0.0007454983     0.0000001416     0.0000000392
----------------------------------------------
cycle 3: E = -75.6231721411  dE = -6.18365e-05  norm(grad) = 0.00105429

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.014542   0.000019   0.000005   -0.000752  0.000004  0.000001
   H   1.014542  -0.000019  -0.000005    0.000752 -0.000004 -0.000001
New geometry
   1 O     -0.014541587489   0.000019088349   0.000005079636 AA   -0.027479617771   0.000036071753   0.000009599120 Bohr

   2 H      1.014541587518  -0.000019088349  -0.000005079636 AA    1.917205742391  -0.000036071753  -0.000009599120 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 567 MB)
number electrons alpha = 6  beta = 4
init E= -75.338709484914
  alpha nocc = 6  HOMO = 0.0775281388548753  LUMO = 0.497929516292803
  beta  nocc = 4  HOMO = -0.253723571145566  LUMO = 0.327502440714136
cycle= 1 E= -75.3394587154719  delta_E= -0.000749  |g|= 0.00038  |ddm|= 0.0276
  alpha nocc = 6  HOMO = 0.0777685486119963  LUMO = 0.497939094659639
  beta  nocc = 4  HOMO = -0.253623414302492  LUMO = 0.327552003310405
cycle= 2 E= -75.3394587987115  delta_E= -8.32e-08  |g|= 0.000204  |ddm|= 0.00209
  alpha nocc = 6  HOMO = 0.0777585625448677  LUMO = 0.497919568923012
  beta  nocc = 4  HOMO = -0.253752582151406  LUMO = 0.327461119242218
cycle= 3 E= -75.3394588151031  delta_E= -1.64e-08  |g|= 5.98e-05  |ddm|= 0.000385
  alpha nocc = 6  HOMO = 0.0777596551799248  LUMO = 0.497916788891898
  beta  nocc = 4  HOMO = -0.253750864456289  LUMO = 0.327461300060366
cycle= 4 E= -75.3394588202467  delta_E= -5.14e-09  |g|= 2.93e-05  |ddm|= 0.000263
  alpha nocc = 6  HOMO = 0.0777630243587336  LUMO = 0.497912749974933
  beta  nocc = 4  HOMO = -0.253752139775595  LUMO = 0.327461156112671
cycle= 5 E= -75.3394588220383  delta_E= -1.79e-09  |g|= 1.04e-05  |ddm|= 0.000313
  alpha nocc = 6  HOMO = 0.0777630792602766  LUMO = 0.497913338599582
  beta  nocc = 4  HOMO = -0.253749941411875  LUMO = 0.327462577209115
cycle= 6 E= -75.3394588222086  delta_E= -1.7e-10  |g|= 3.05e-06  |ddm|= 6.46e-05
  alpha nocc = 6  HOMO = 0.0777628143739755  LUMO = 0.497913382433084
  beta  nocc = 4  HOMO = -0.253749978167302  LUMO = 0.327462042792478
cycle= 7 E= -75.3394588222249  delta_E= -1.63e-11  |g|= 9.99e-07  |ddm|= 8.51e-05
  alpha nocc = 6  HOMO = 0.077762767589232  LUMO = 0.497913432945982
  beta  nocc = 4  HOMO = -0.253749716183985  LUMO = 0.327462031620064
Extra cycle  E= -75.3394588222261  delta_E= -1.26e-12  |g|= 6.02e-07  |ddm|= 1.88e-05
converged SCF energy = -75.3394588222261  <S^2> = 2.007741  2S+1 = 3.0051562

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3546 MB)
Init E_corr(CCSD) = -0.272419644651347
cycle = 1  E_corr(CCSD) = -0.283877935573502  dE = -0.0114582909  norm(t1,t2) = 0.0399879
cycle = 2  E_corr(CCSD) = -0.283608071263419  dE = 0.00026986431  norm(t1,t2) = 0.00556152
cycle = 3  E_corr(CCSD) = -0.283729246276287  dE = -0.000121175013  norm(t1,t2) = 0.000999396
cycle = 4  E_corr(CCSD) = -0.283718088051575  dE = 1.11582247e-05  norm(t1,t2) = 0.000486566
cycle = 5  E_corr(CCSD) = -0.283710811122318  dE = 7.27692926e-06  norm(t1,t2) = 0.000185247
cycle = 6  E_corr(CCSD) = -0.283714707215235  dE = -3.89609292e-06  norm(t1,t2) = 4.16774e-05
cycle = 7  E_corr(CCSD) = -0.28371431339785  dE = 3.93817384e-07  norm(t1,t2) = 1.28069e-05
cycle = 8  E_corr(CCSD) = -0.283714442774709  dE = -1.29376859e-07  norm(t1,t2) = 3.4921e-06
cycle = 9  E_corr(CCSD) = -0.283714463717886  dE = -2.09431768e-08  norm(t1,t2) = 1.25493e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.62317328594405  E_corr = -0.2837144637178862
cycle = 1  norm(lambda1,lambda2) = 0.0389935
cycle = 2  norm(lambda1,lambda2) = 0.00513085
cycle = 3  norm(lambda1,lambda2) = 0.000960949
cycle = 4  norm(lambda1,lambda2) = 0.00044343
cycle = 5  norm(lambda1,lambda2) = 0.000173408
cycle = 6  norm(lambda1,lambda2) = 4.09466e-05
cycle = 7  norm(lambda1,lambda2) = 1.22881e-05
cycle = 8  norm(lambda1,lambda2) = 3.52672e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0000438197     0.0000000565     0.0000000066
1 H    -0.0000438197    -0.0000000565    -0.0000000066
----------------------------------------------
cycle 4: E = -75.6231732859  dE = -1.14487e-06  norm(grad) = 6.19704e-05

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.014589   0.000018   0.000005   -0.000047 -0.000001 -0.000000
   H   1.014589  -0.000018  -0.000005    0.000047  0.000001  0.000000
New geometry
   1 O     -0.014588550587   0.000017780554   0.000004933956 AA   -0.027568365164   0.000033600377   0.000009323825 Bohr

   2 H      1.014588550643  -0.000017780554  -0.000004933956 AA    1.917294489834  -0.000033600377  -0.000009323825 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 651 MB)
number electrons alpha = 6  beta = 4
init E= -75.339408731393
  alpha nocc = 6  HOMO = 0.0777375960578311  LUMO = 0.497926519630141
  beta  nocc = 4  HOMO = -0.25373304290589  LUMO = 0.327472854885616
cycle= 1 E= -75.3394555440432  delta_E= -4.68e-05  |g|= 2.38e-05  |ddm|= 0.00172
  alpha nocc = 6  HOMO = 0.0777526036136024  LUMO = 0.497927208218403
  beta  nocc = 4  HOMO = -0.253726485235359  LUMO = 0.32747611514144
cycle= 2 E= -75.3394555443676  delta_E= -3.24e-10  |g|= 1.28e-05  |ddm|= 0.000132
  alpha nocc = 6  HOMO = 0.0777519677375789  LUMO = 0.497926001337633
  beta  nocc = 4  HOMO = -0.25373450491032  LUMO = 0.327470435344681
cycle= 3 E= -75.3394555444321  delta_E= -6.45e-11  |g|= 3.79e-06  |ddm|= 2.46e-05
  alpha nocc = 6  HOMO = 0.0777520258958867  LUMO = 0.497925842729961
  beta  nocc = 4  HOMO = -0.253734313872034  LUMO = 0.32747046121947
cycle= 4 E= -75.3394555444527  delta_E= -2.06e-11  |g|= 1.88e-06  |ddm|= 1.58e-05
  alpha nocc = 6  HOMO = 0.0777522309951877  LUMO = 0.497925599050717
  beta  nocc = 4  HOMO = -0.253734318588254  LUMO = 0.327470462666627
cycle= 5 E= -75.3394555444601  delta_E= -7.46e-12  |g|= 6.61e-07  |ddm|= 1.89e-05
  alpha nocc = 6  HOMO = 0.0777522104892919  LUMO = 0.497925659581063
  beta  nocc = 4  HOMO = -0.25373417015364  LUMO = 0.327470551455288
Extra cycle  E= -75.3394555444605  delta_E= -3.55e-13  |g|= 3.94e-07  |ddm|= 2.49e-06
converged SCF energy = -75.3394555444605  <S^2> = 2.0077432  2S+1 = 3.0051577

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3676 MB)
Init E_corr(CCSD) = -0.283714264476094
cycle = 1  E_corr(CCSD) = -0.28371757229899  dE = -3.3078229e-06  norm(t1,t2) = 0.000130234
cycle = 2  E_corr(CCSD) = -0.283717466455166  dE = 1.05843824e-07  norm(t1,t2) = 2.07072e-05
cycle = 3  E_corr(CCSD) = -0.283717708373177  dE = -2.41918011e-07  norm(t1,t2) = 5.52328e-06
cycle = 4  E_corr(CCSD) = -0.283717714553538  dE = -6.18036083e-09  norm(t1,t2) = 2.0903e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.62317325901401  E_corr = -0.2837177145535376
cycle = 1  norm(lambda1,lambda2) = 0.000126843
cycle = 2  norm(lambda1,lambda2) = 1.95515e-05
cycle = 3  norm(lambda1,lambda2) = 5.27042e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O    -0.0000000378    -0.0000000500    -0.0000000140
1 H     0.0000000378     0.0000000500     0.0000000140
----------------------------------------------
cycle 5: E = -75.623173259  dE = 2.693e-08  norm(grad) = 9.08943e-08
