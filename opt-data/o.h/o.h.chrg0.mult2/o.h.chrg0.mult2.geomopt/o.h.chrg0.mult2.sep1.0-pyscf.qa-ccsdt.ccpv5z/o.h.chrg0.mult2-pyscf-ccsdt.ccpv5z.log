#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/o.h/o.h.chrg0.mult2/o.h.chrg0.mult2.geomopt/o.h.chrg0.mult2.sep1.0-pyscf.qa-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['O', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 0
multiplicity = 2
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n36.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 4.23341768736
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.37
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 149 MB)
number electrons alpha = 5  beta = 4
init E= -75.0300121843385
  alpha nocc = 5  HOMO = -0.43004388506502  LUMO = 0.0734432383920563

WARN: beta  nocc = 4  HOMO -0.430043885065024 >= LUMO -0.43004388506502


WARN: system HOMO -0.43004388506502 >= system LUMO -0.43004388506502

cycle= 1 E= -75.4076149834073  delta_E= -0.378  |g|= 0.204  |ddm|= 0.554
  alpha nocc = 5  HOMO = -0.554350777162016  LUMO = 0.0799561554100835
  beta  nocc = 4  HOMO = -0.516956446783988  LUMO = 0.0746525924447725
cycle= 2 E= -75.4241696615268  delta_E= -0.0166  |g|= 0.0487  |ddm|= 0.123
  alpha nocc = 5  HOMO = -0.560675564534462  LUMO = 0.0894030453470723
  beta  nocc = 4  HOMO = -0.522216247053608  LUMO = 0.0796133375483752
cycle= 3 E= -75.4254130605942  delta_E= -0.00124  |g|= 0.0191  |ddm|= 0.0274
  alpha nocc = 5  HOMO = -0.553816053752199  LUMO = 0.0903509254394133
  beta  nocc = 4  HOMO = -0.51244812945697  LUMO = 0.0878496751624487
cycle= 4 E= -75.4256964569559  delta_E= -0.000283  |g|= 0.0087  |ddm|= 0.0161
  alpha nocc = 5  HOMO = -0.558670718172367  LUMO = 0.0901175724194698
  beta  nocc = 4  HOMO = -0.514822076010359  LUMO = 0.0854311442577452
cycle= 5 E= -75.4257563625509  delta_E= -5.99e-05  |g|= 0.00422  |ddm|= 0.00515
  alpha nocc = 5  HOMO = -0.559363784266611  LUMO = 0.0901929285576771
  beta  nocc = 4  HOMO = -0.512488609474037  LUMO = 0.0859527540406628
cycle= 6 E= -75.4257857051828  delta_E= -2.93e-05  |g|= 0.00149  |ddm|= 0.00566
  alpha nocc = 5  HOMO = -0.56005131142325  LUMO = 0.0902247968386246
  beta  nocc = 4  HOMO = -0.511878781574635  LUMO = 0.0858588237399581
cycle= 7 E= -75.4257906541102  delta_E= -4.95e-06  |g|= 0.000529  |ddm|= 0.00287
  alpha nocc = 5  HOMO = -0.560105884483108  LUMO = 0.0902161418481283
  beta  nocc = 4  HOMO = -0.511808547487429  LUMO = 0.0858843805844811
cycle= 8 E= -75.4257912148477  delta_E= -5.61e-07  |g|= 0.000136  |ddm|= 0.00114
  alpha nocc = 5  HOMO = -0.560040898041257  LUMO = 0.0902125084427103
  beta  nocc = 4  HOMO = -0.511897232180987  LUMO = 0.0858843479009398
cycle= 9 E= -75.4257912409293  delta_E= -2.61e-08  |g|= 4.1e-05  |ddm|= 0.000171
  alpha nocc = 5  HOMO = -0.560010042853079  LUMO = 0.0902118285199038
  beta  nocc = 4  HOMO = -0.511928344707998  LUMO = 0.0858847127070138
cycle= 10 E= -75.4257912433806  delta_E= -2.45e-09  |g|= 4.17e-06  |ddm|= 6.26e-05
  alpha nocc = 5  HOMO = -0.560009109082525  LUMO = 0.0902123160620829
  beta  nocc = 4  HOMO = -0.511928921331545  LUMO = 0.0858847293227259
cycle= 11 E= -75.425791243403  delta_E= -2.24e-11  |g|= 6.83e-07  |ddm|= 8.99e-06
  alpha nocc = 5  HOMO = -0.560008957624228  LUMO = 0.0902123635457023
  beta  nocc = 4  HOMO = -0.511928886450413  LUMO = 0.0858847912409514
Extra cycle  E= -75.4257912434037  delta_E= -7.53e-13  |g|= 3.28e-07  |ddm|= 7.55e-07
converged SCF energy = -75.4257912434037  <S^2> = 0.75747824  2S+1 = 2.0074643

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3332 MB)
Init t2, MP2 energy = -0.262245810351245
Init E_corr(CCSD) = -0.262245810351329
cycle = 1  E_corr(CCSD) = -0.267990352117414  dE = -0.00574454177  norm(t1,t2) = 0.0358736
cycle = 2  E_corr(CCSD) = -0.271997330236706  dE = -0.00400697812  norm(t1,t2) = 0.0119243
cycle = 3  E_corr(CCSD) = -0.272868908577996  dE = -0.000871578341  norm(t1,t2) = 0.00586307
cycle = 4  E_corr(CCSD) = -0.273280779475212  dE = -0.000411870897  norm(t1,t2) = 0.0023079
cycle = 5  E_corr(CCSD) = -0.27325643739179  dE = 2.43420834e-05  norm(t1,t2) = 0.000995477
cycle = 6  E_corr(CCSD) = -0.273240401404254  dE = 1.60359875e-05  norm(t1,t2) = 0.000313636
cycle = 7  E_corr(CCSD) = -0.27325631416109  dE = -1.59127568e-05  norm(t1,t2) = 0.000108399
cycle = 8  E_corr(CCSD) = -0.273255812289271  dE = 5.01871818e-07  norm(t1,t2) = 3.26659e-05
cycle = 9  E_corr(CCSD) = -0.273254853549217  dE = 9.58740054e-07  norm(t1,t2) = 1.19345e-05
cycle = 10  E_corr(CCSD) = -0.273255156747455  dE = -3.03198238e-07  norm(t1,t2) = 4.65045e-06
cycle = 11  E_corr(CCSD) = -0.27325515730027  dE = -5.52815071e-10  norm(t1,t2) = 1.29471e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.69904640070399  E_corr = -0.27325515730027
cycle = 1  norm(lambda1,lambda2) = 0.00838086
cycle = 2  norm(lambda1,lambda2) = 0.00166887
cycle = 3  norm(lambda1,lambda2) = 0.000816284
cycle = 4  norm(lambda1,lambda2) = 0.000250784
cycle = 5  norm(lambda1,lambda2) = 6.68927e-05
cycle = 6  norm(lambda1,lambda2) = 2.75094e-05
cycle = 7  norm(lambda1,lambda2) = 1.15636e-05
cycle = 8  norm(lambda1,lambda2) = 3.42722e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O    -0.0299445087    -0.0000000000     0.0000000000
1 H     0.0299445087     0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -75.6990464007  dE = -75.699  norm(grad) = 0.0423479

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O   0.016614   0.000000  -0.000000    0.016614  0.000000 -0.000000
   H   0.983386  -0.000000   0.000000   -0.016614 -0.000000  0.000000
New geometry
   1 O      0.016614076804   0.000000000000  -0.000000000000 AA    0.031396054972   0.000000000000  -0.000000000000 Bohr

   2 H      0.983385923191  -0.000000000000   0.000000000000 AA    1.858330069584  -0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 482 MB)
number electrons alpha = 5  beta = 4
init E= -75.4447620758793
  alpha nocc = 5  HOMO = -0.556881366402574  LUMO = 0.0967796368170852
  beta  nocc = 4  HOMO = -0.509308250798916  LUMO = 0.0898172477666366
cycle= 1 E= -75.4277980164599  delta_E= 0.017  |g|= 0.00927  |ddm|= 0.0106
  alpha nocc = 5  HOMO = -0.563013315622764  LUMO = 0.0921102734496791
  beta  nocc = 4  HOMO = -0.515071384523018  LUMO = 0.0836119132058271
cycle= 2 E= -75.4278360848926  delta_E= -3.81e-05  |g|= 0.00243  |ddm|= 0.00372
  alpha nocc = 5  HOMO = -0.561335312938906  LUMO = 0.0924330849963337
  beta  nocc = 4  HOMO = -0.513487834852065  LUMO = 0.0847601003843783
cycle= 3 E= -75.4278390888711  delta_E= -3e-06  |g|= 0.000869  |ddm|= 0.0013
  alpha nocc = 5  HOMO = -0.561553804102859  LUMO = 0.0924105732495124
  beta  nocc = 4  HOMO = -0.513716537709795  LUMO = 0.0845579744960155
cycle= 4 E= -75.4278398520713  delta_E= -7.63e-07  |g|= 0.000436  |ddm|= 0.000589
  alpha nocc = 5  HOMO = -0.561324330609952  LUMO = 0.0923888248473636
  beta  nocc = 4  HOMO = -0.513523414279791  LUMO = 0.0846701174574651
cycle= 5 E= -75.4278400817793  delta_E= -2.3e-07  |g|= 0.000193  |ddm|= 0.000432
  alpha nocc = 5  HOMO = -0.561348907304216  LUMO = 0.0923730025948473
  beta  nocc = 4  HOMO = -0.513582271406208  LUMO = 0.0846225064500437
cycle= 6 E= -75.4278401483403  delta_E= -6.66e-08  |g|= 6.99e-05  |ddm|= 0.000307
  alpha nocc = 5  HOMO = -0.561332464332576  LUMO = 0.0923782709919379
  beta  nocc = 4  HOMO = -0.513590048041704  LUMO = 0.0846305125399935
cycle= 7 E= -75.4278401572119  delta_E= -8.87e-09  |g|= 1.37e-05  |ddm|= 0.000125
  alpha nocc = 5  HOMO = -0.56132955329571  LUMO = 0.0923795397938317
  beta  nocc = 4  HOMO = -0.513594302230489  LUMO = 0.0846324520943706
cycle= 8 E= -75.427840157476  delta_E= -2.64e-10  |g|= 1.94e-06  |ddm|= 2.28e-05
  alpha nocc = 5  HOMO = -0.561329239467453  LUMO = 0.0923794674321649
  beta  nocc = 4  HOMO = -0.513595542760022  LUMO = 0.0846322623852421
cycle= 9 E= -75.42784015748  delta_E= -4.01e-12  |g|= 5.58e-07  |ddm|= 4.15e-06
  alpha nocc = 5  HOMO = -0.561329061753977  LUMO = 0.0923794494718883
  beta  nocc = 4  HOMO = -0.51359577436924  LUMO = 0.0846322448725302
Extra cycle  E= -75.4278401574802  delta_E= -1.99e-13  |g|= 3.17e-07  |ddm|= 4.21e-07
converged SCF energy = -75.4278401574802  <S^2> = 0.75696566  2S+1 = 2.0069536

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3496 MB)
Init E_corr(CCSD) = -0.127126676577563
cycle = 1  E_corr(CCSD) = -0.268461085102409  dE = -0.141334409  norm(t1,t2) = 0.229153
cycle = 2  E_corr(CCSD) = -0.269308042902159  dE = -0.0008469578  norm(t1,t2) = 0.043142
cycle = 3  E_corr(CCSD) = -0.271905793964455  dE = -0.00259775106  norm(t1,t2) = 0.0125317
cycle = 4  E_corr(CCSD) = -0.27214208089822  dE = -0.000236286934  norm(t1,t2) = 0.00509561
cycle = 5  E_corr(CCSD) = -0.272181212598937  dE = -3.91317007e-05  norm(t1,t2) = 0.00184117
cycle = 6  E_corr(CCSD) = -0.272223253916775  dE = -4.20413178e-05  norm(t1,t2) = 0.000739891
cycle = 7  E_corr(CCSD) = -0.272223189601606  dE = 6.43151697e-08  norm(t1,t2) = 0.00028888
cycle = 8  E_corr(CCSD) = -0.272221673811012  dE = 1.51579059e-06  norm(t1,t2) = 8.63434e-05
cycle = 9  E_corr(CCSD) = -0.272222679238509  dE = -1.0054275e-06  norm(t1,t2) = 3.00068e-05
cycle = 10  E_corr(CCSD) = -0.272222686850643  dE = -7.61213381e-09  norm(t1,t2) = 1.07864e-05
cycle = 11  E_corr(CCSD) = -0.272222723960995  dE = -3.71103523e-08  norm(t1,t2) = 4.56479e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.70006288144126  E_corr = -0.272222723960995
cycle = 1  norm(lambda1,lambda2) = 0.228398
cycle = 2  norm(lambda1,lambda2) = 0.0382085
cycle = 3  norm(lambda1,lambda2) = 0.0113819
cycle = 4  norm(lambda1,lambda2) = 0.00468848
cycle = 5  norm(lambda1,lambda2) = 0.00167332
cycle = 6  norm(lambda1,lambda2) = 0.000669484
cycle = 7  norm(lambda1,lambda2) = 0.00026035
cycle = 8  norm(lambda1,lambda2) = 7.58308e-05
cycle = 9  norm(lambda1,lambda2) = 2.67368e-05
cycle = 10  norm(lambda1,lambda2) = 9.11243e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O    -0.0013067309     0.0000001279     0.0000001435
1 H     0.0013067309    -0.0000001279    -0.0000001435
----------------------------------------------
cycle 2: E = -75.7000628814  dE = -0.00101648  norm(grad) = 0.001848

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O   0.017372  -0.000003  -0.000003    0.000758 -0.000003 -0.000003
   H   0.982628   0.000003   0.000003   -0.000758  0.000003  0.000003
New geometry
   1 O      0.017372170809  -0.000002646410  -0.000002969129 AA    0.032828645018  -0.000005000990  -0.000005610840 Bohr

   2 H      0.982627829175   0.000002646410   0.000002969129 AA    1.856897479517   0.000005000990   0.000005610840 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 591 MB)
number electrons alpha = 5  beta = 4
init E= -75.4286963296291
  alpha nocc = 5  HOMO = -0.561176974669825  LUMO = 0.0926818940338047
  beta  nocc = 4  HOMO = -0.513468284041504  LUMO = 0.0848240661614386
cycle= 1 E= -75.4278877393475  delta_E= 0.000809  |g|= 0.000428  |ddm|= 0.000489
  alpha nocc = 5  HOMO = -0.561473113376785  LUMO = 0.0924603797161775
  beta  nocc = 4  HOMO = -0.513746252724656  LUMO = 0.0845255085419902
cycle= 2 E= -75.4278878203631  delta_E= -8.1e-08  |g|= 0.000114  |ddm|= 0.000172
  alpha nocc = 5  HOMO = -0.561392387159709  LUMO = 0.0924752040097491
  beta  nocc = 4  HOMO = -0.513669894772857  LUMO = 0.0845807423426825
cycle= 3 E= -75.4278878266296  delta_E= -6.27e-09  |g|= 3.98e-05  |ddm|= 6.02e-05
  alpha nocc = 5  HOMO = -0.56140320773773  LUMO = 0.09247423991932
  beta  nocc = 4  HOMO = -0.513681006594307  LUMO = 0.084571017827796
cycle= 4 E= -75.4278878281362  delta_E= -1.51e-09  |g|= 1.92e-05  |ddm|= 2.55e-05
  alpha nocc = 5  HOMO = -0.561393002913132  LUMO = 0.0924732344856785
  beta  nocc = 4  HOMO = -0.513672293650492  LUMO = 0.0845759905480708
cycle= 5 E= -75.4278878285707  delta_E= -4.35e-10  |g|= 8.17e-06  |ddm|= 1.87e-05
  alpha nocc = 5  HOMO = -0.561393992703834  LUMO = 0.0924725290634086
  beta  nocc = 4  HOMO = -0.513674636994948  LUMO = 0.0845739833457807
cycle= 6 E= -75.4278878286871  delta_E= -1.16e-10  |g|= 3.07e-06  |ddm|= 1.25e-05
  alpha nocc = 5  HOMO = -0.561393295491639  LUMO = 0.0924727328625232
  beta  nocc = 4  HOMO = -0.513674980363458  LUMO = 0.0845742902889898
cycle= 7 E= -75.4278878287047  delta_E= -1.75e-11  |g|= 6.35e-07  |ddm|= 5.59e-06
  alpha nocc = 5  HOMO = -0.561393200741548  LUMO = 0.0924727638502266
  beta  nocc = 4  HOMO = -0.513675047653704  LUMO = 0.0845743656837094
Extra cycle  E= -75.4278878287054  delta_E= -7.11e-13  |g|= 3.37e-07  |ddm|= 5.87e-07
converged SCF energy = -75.4278878287054  <S^2> = 0.75694576  2S+1 = 2.0069337

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3640 MB)
Init E_corr(CCSD) = -0.267919753945592
cycle = 1  E_corr(CCSD) = -0.272075516118926  dE = -0.00415576217  norm(t1,t2) = 0.0285451
cycle = 2  E_corr(CCSD) = -0.272136504858367  dE = -6.09887394e-05  norm(t1,t2) = 0.00377015
cycle = 3  E_corr(CCSD) = -0.272176347061913  dE = -3.98422035e-05  norm(t1,t2) = 0.000742846
cycle = 4  E_corr(CCSD) = -0.272175444452717  dE = 9.02609196e-07  norm(t1,t2) = 0.000237188
cycle = 5  E_corr(CCSD) = -0.272175659342446  dE = -2.14889729e-07  norm(t1,t2) = 9.90837e-05
cycle = 6  E_corr(CCSD) = -0.272176754784093  dE = -1.09544165e-06  norm(t1,t2) = 2.82308e-05
cycle = 7  E_corr(CCSD) = -0.272176537153221  dE = 2.17630872e-07  norm(t1,t2) = 8.78912e-06
cycle = 8  E_corr(CCSD) = -0.272176666873707  dE = -1.29720485e-07  norm(t1,t2) = 4.64807e-06
cycle = 9  E_corr(CCSD) = -0.272176693030287  dE = -2.61565801e-08  norm(t1,t2) = 3.40349e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.70006452173564  E_corr = -0.2721766930302867
cycle = 1  norm(lambda1,lambda2) = 0.0279071
cycle = 2  norm(lambda1,lambda2) = 0.00362706
cycle = 3  norm(lambda1,lambda2) = 0.000710904
cycle = 4  norm(lambda1,lambda2) = 0.00022471
cycle = 5  norm(lambda1,lambda2) = 9.57748e-05
cycle = 6  norm(lambda1,lambda2) = 2.72173e-05
cycle = 7  norm(lambda1,lambda2) = 8.34185e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0001674892    -0.0000000235    -0.0000000233
1 H    -0.0001674892     0.0000000235     0.0000000233
----------------------------------------------
cycle 3: E = -75.7000645217  dE = -1.64029e-06  norm(grad) = 0.000236865

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O   0.017286  -0.000002  -0.000003   -0.000086  0.000000  0.000000
   H   0.982714   0.000002   0.000003    0.000086 -0.000000 -0.000000
New geometry
   1 O      0.017286042169  -0.000002205962  -0.000002529415 AA    0.032665885476  -0.000004168665  -0.000004779902 Bohr

   2 H      0.982713957785   0.000002205962   0.000002529415 AA    1.857060239002   0.000004168665   0.000004779902 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 480 MB)
number electrons alpha = 5  beta = 4
init E= -75.4277905796982
  alpha nocc = 5  HOMO = -0.561410529808536  LUMO = 0.0924383887778056
  beta  nocc = 4  HOMO = -0.513689697643592  LUMO = 0.0845524916268866
cycle= 1 E= -75.4278826292638  delta_E= -9.2e-05  |g|= 4.87e-05  |ddm|= 5.56e-05
  alpha nocc = 5  HOMO = -0.561376740786492  LUMO = 0.0924636112581061
  beta  nocc = 4  HOMO = -0.513658056853413  LUMO = 0.0845865188974986
cycle= 2 E= -75.4278826303102  delta_E= -1.05e-09  |g|= 1.3e-05  |ddm|= 1.95e-05
  alpha nocc = 5  HOMO = -0.561385929017409  LUMO = 0.092461927331686
  beta  nocc = 4  HOMO = -0.513666791922171  LUMO = 0.0845802218774329
cycle= 3 E= -75.4278826303908  delta_E= -8.06e-11  |g|= 4.49e-06  |ddm|= 6.82e-06
  alpha nocc = 5  HOMO = -0.561384681100418  LUMO = 0.0924620371031523
  beta  nocc = 4  HOMO = -0.513665544621422  LUMO = 0.0845813297762428
cycle= 4 E= -75.4278826304101  delta_E= -1.94e-11  |g|= 2.15e-06  |ddm|= 2.85e-06
  alpha nocc = 5  HOMO = -0.561385819613311  LUMO = 0.092462151276721
  beta  nocc = 4  HOMO = -0.513666541830265  LUMO = 0.0845807700697967
cycle= 5 E= -75.4278826304155  delta_E= -5.33e-12  |g|= 8.97e-07  |ddm|= 2.07e-06
  alpha nocc = 5  HOMO = -0.561385591995571  LUMO = 0.0924621888721981
  beta  nocc = 4  HOMO = -0.513666254661173  LUMO = 0.0845809872013533
Extra cycle  E= -75.4278826304163  delta_E= -8.24e-13  |g|= 5.92e-07  |ddm|= 6.49e-07
converged SCF energy = -75.4278826304163  <S^2> = 0.75694776  2S+1 = 2.0069357

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 4), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3529 MB)
Init E_corr(CCSD) = -0.272175925081469
cycle = 1  E_corr(CCSD) = -0.272181396076853  dE = -5.47099538e-06  norm(t1,t2) = 0.000205322
cycle = 2  E_corr(CCSD) = -0.272181428656737  dE = -3.2579884e-08  norm(t1,t2) = 4.03803e-05
cycle = 3  E_corr(CCSD) = -0.272181850476592  dE = -4.21819855e-07  norm(t1,t2) = 1.20416e-05
cycle = 4  E_corr(CCSD) = -0.272181861148716  dE = -1.06721246e-08  norm(t1,t2) = 5.05072e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.700064491565  E_corr = -0.2721818611487163
cycle = 1  norm(lambda1,lambda2) = 0.000200189
cycle = 2  norm(lambda1,lambda2) = 3.86386e-05
cycle = 3  norm(lambda1,lambda2) = 1.16132e-05
cycle = 4  norm(lambda1,lambda2) = 4.18026e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O    -0.0000010327     0.0000000225     0.0000000241
1 H     0.0000010327    -0.0000000225    -0.0000000241
----------------------------------------------
cycle 4: E = -75.7000644916  dE = 3.01706e-08  norm(grad) = 1.46113e-06
