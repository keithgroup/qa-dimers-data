#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/o.h/o.h.chrg1.mult3/o.h.chrg1.mult3.geomopt/o.h.chrg1.mult3.sep1.0-pyscf.qa-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['O', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 1
multiplicity = 3

scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n24.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 8
[INPUT] charge = 1
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 4.23341768736
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.16
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 145 MB)
number electrons alpha = 5  beta = 3
init E= -75.0300121843385
  alpha nocc = 5  HOMO = -0.430043885065023  LUMO = 0.0734432383920237
  beta  nocc = 3  HOMO = -0.605710845322274  LUMO = -0.430043885065032

WARN: system HOMO -0.430043885065023 >= system LUMO -0.430043885065032

cycle= 1 E= -74.8916192680663  delta_E= 0.138  |g|= 0.491  |ddm|= 0.588
  alpha nocc = 5  HOMO = -1.34451347853542  LUMO = -0.22586803771564
  beta  nocc = 3  HOMO = -1.26763494101006  LUMO = -0.517352885133247
cycle= 2 E= -75.000908071522  delta_E= -0.109  |g|= 0.183  |ddm|= 0.245
  alpha nocc = 5  HOMO = -1.20429240188419  LUMO = -0.192182981317963
  beta  nocc = 3  HOMO = -1.12874177025007  LUMO = -0.350387407865054
cycle= 3 E= -75.009815347984  delta_E= -0.00891  |g|= 0.0352  |ddm|= 0.0747
  alpha nocc = 5  HOMO = -1.21087818914169  LUMO = -0.184820395377144
  beta  nocc = 3  HOMO = -1.12602811529534  LUMO = -0.343728454658792
cycle= 4 E= -75.0108049460351  delta_E= -0.00099  |g|= 0.0123  |ddm|= 0.0267
  alpha nocc = 5  HOMO = -1.21039826070044  LUMO = -0.185074194016869
  beta  nocc = 3  HOMO = -1.12241753378666  LUMO = -0.342264312253775
cycle= 5 E= -75.0109666002788  delta_E= -0.000162  |g|= 0.00436  |ddm|= 0.011
  alpha nocc = 5  HOMO = -1.21247441922671  LUMO = -0.185030771135905
  beta  nocc = 3  HOMO = -1.12133961534133  LUMO = -0.342851038859958
cycle= 6 E= -75.0109945610066  delta_E= -2.8e-05  |g|= 0.00141  |ddm|= 0.00471
  alpha nocc = 5  HOMO = -1.21304549493737  LUMO = -0.184925422749536
  beta  nocc = 3  HOMO = -1.12052622909668  LUMO = -0.342669729341497
cycle= 7 E= -75.0109978331284  delta_E= -3.27e-06  |g|= 0.00024  |ddm|= 0.00193
  alpha nocc = 5  HOMO = -1.21314366386163  LUMO = -0.184929353644748
  beta  nocc = 3  HOMO = -1.12054128059926  LUMO = -0.342691539373828
cycle= 8 E= -75.0109978952652  delta_E= -6.21e-08  |g|= 3.46e-05  |ddm|= 0.000337
  alpha nocc = 5  HOMO = -1.21314131759476  LUMO = -0.184932581833834
  beta  nocc = 3  HOMO = -1.12056298052915  LUMO = -0.342690820680316
cycle= 9 E= -75.0109978962769  delta_E= -1.01e-09  |g|= 5.81e-06  |ddm|= 3.39e-05
  alpha nocc = 5  HOMO = -1.21313992045048  LUMO = -0.184933624785371
  beta  nocc = 3  HOMO = -1.12056696924786  LUMO = -0.342691965919825
cycle= 10 E= -75.0109978963086  delta_E= -3.17e-11  |g|= 1.1e-06  |ddm|= 9.35e-06
  alpha nocc = 5  HOMO = -1.21313933784451  LUMO = -0.18493367774338
  beta  nocc = 3  HOMO = -1.12056738818268  LUMO = -0.342691739742519
cycle= 11 E= -75.0109978963096  delta_E= -9.52e-13  |g|= 1.93e-07  |ddm|= 1.26e-06
  alpha nocc = 5  HOMO = -1.21313931703257  LUMO = -0.184933664003361
  beta  nocc = 3  HOMO = -1.12056740890748  LUMO = -0.342691735548661
Extra cycle  E= -75.0109978963096  delta_E= -4.26e-14  |g|= 8.1e-08  |ddm|= 1.77e-07
converged SCF energy = -75.0109978963096  <S^2> = 2.0131386  2S+1 = 3.0087463

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3303 MB)
Init t2, MP2 energy = -0.197221242945106
Init E_corr(CCSD) = -0.197221242945109
cycle = 1  E_corr(CCSD) = -0.208917173452168  dE = -0.0116959305  norm(t1,t2) = 0.0291661
cycle = 2  E_corr(CCSD) = -0.211994182839434  dE = -0.00307700939  norm(t1,t2) = 0.0111871
cycle = 3  E_corr(CCSD) = -0.213456429603669  dE = -0.00146224676  norm(t1,t2) = 0.00551753
cycle = 4  E_corr(CCSD) = -0.213490160526903  dE = -3.37309232e-05  norm(t1,t2) = 0.00157454
cycle = 5  E_corr(CCSD) = -0.213457747448179  dE = 3.24130787e-05  norm(t1,t2) = 0.000768523
cycle = 6  E_corr(CCSD) = -0.213478951496833  dE = -2.12040487e-05  norm(t1,t2) = 0.000247566
cycle = 7  E_corr(CCSD) = -0.213482877826317  dE = -3.92632948e-06  norm(t1,t2) = 6.80095e-05
cycle = 8  E_corr(CCSD) = -0.213480515552269  dE = 2.36227405e-06  norm(t1,t2) = 2.3655e-05
cycle = 9  E_corr(CCSD) = -0.213480594382425  dE = -7.88301552e-08  norm(t1,t2) = 6.10787e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.22447849069206  E_corr = -0.2134805943824247
cycle = 1  norm(lambda1,lambda2) = 0.0044487
cycle = 2  norm(lambda1,lambda2) = 0.000896264
cycle = 3  norm(lambda1,lambda2) = 0.000367052
cycle = 4  norm(lambda1,lambda2) = 8.47544e-05
cycle = 5  norm(lambda1,lambda2) = 3.82119e-05
cycle = 6  norm(lambda1,lambda2) = 1.40402e-05
cycle = 7  norm(lambda1,lambda2) = 4.47274e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0176547737    -0.0000000000     0.0000000000
1 H    -0.0176547737     0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -75.2244784907  dE = -75.2245  norm(grad) = 0.0249676

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.009795   0.000000  -0.000000   -0.009795  0.000000 -0.000000
   H   1.009795  -0.000000   0.000000    0.009795 -0.000000  0.000000
New geometry
   1 O     -0.009795377517   0.000000000000  -0.000000000000 AA   -0.018510580794   0.000000000000  -0.000000000000 Bohr

   2 H      1.009795377518  -0.000000000000   0.000000000000 AA    1.908236705361  -0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 429 MB)
number electrons alpha = 5  beta = 3
init E= -74.9970509124314
  alpha nocc = 5  HOMO = -1.20995180297019  LUMO = -0.191838691516195
  beta  nocc = 3  HOMO = -1.11889101132006  LUMO = -0.344452303855217
cycle= 1 E= -75.0109068190597  delta_E= -0.0139  |g|= 0.00528  |ddm|= 0.00535
  alpha nocc = 5  HOMO = -1.20458858789303  LUMO = -0.188501535268387
  beta  nocc = 3  HOMO = -1.11315236055979  LUMO = -0.339398911818894
cycle= 2 E= -75.0109173638727  delta_E= -1.05e-05  |g|= 0.00109  |ddm|= 0.00194
  alpha nocc = 5  HOMO = -1.20547428448767  LUMO = -0.188827511950292
  beta  nocc = 3  HOMO = -1.11365936909199  LUMO = -0.340207047078213
cycle= 3 E= -75.0109179398014  delta_E= -5.76e-07  |g|= 0.000385  |ddm|= 0.000531
  alpha nocc = 5  HOMO = -1.20542991749606  LUMO = -0.188846935582308
  beta  nocc = 3  HOMO = -1.11344484374855  LUMO = -0.340097668111361
cycle= 4 E= -75.0109180969757  delta_E= -1.57e-07  |g|= 0.000212  |ddm|= 0.000242
  alpha nocc = 5  HOMO = -1.20555650911986  LUMO = -0.188840707079578
  beta  nocc = 3  HOMO = -1.11341316802102  LUMO = -0.340153995042381
cycle= 5 E= -75.0109181677409  delta_E= -7.08e-08  |g|= 8.25e-05  |ddm|= 0.000221
  alpha nocc = 5  HOMO = -1.20557584942746  LUMO = -0.188831427709754
  beta  nocc = 3  HOMO = -1.11335454811655  LUMO = -0.340129833743366
cycle= 6 E= -75.0109181789311  delta_E= -1.12e-08  |g|= 1.17e-05  |ddm|= 0.000124
  alpha nocc = 5  HOMO = -1.20557959831369  LUMO = -0.188832400013322
  beta  nocc = 3  HOMO = -1.11335910240019  LUMO = -0.340130596517679
cycle= 7 E= -75.0109181790396  delta_E= -1.09e-10  |g|= 2.15e-06  |ddm|= 1.25e-05
  alpha nocc = 5  HOMO = -1.20557887513302  LUMO = -0.188832729861511
  beta  nocc = 3  HOMO = -1.11336027855864  LUMO = -0.34013041225252
cycle= 8 E= -75.0109181790432  delta_E= -3.64e-12  |g|= 3.03e-07  |ddm|= 2.32e-06
  alpha nocc = 5  HOMO = -1.20557875932877  LUMO = -0.188832728918956
  beta  nocc = 3  HOMO = -1.11336031433575  LUMO = -0.340130372803918
Extra cycle  E= -75.0109181790434  delta_E= -1.99e-13  |g|= 1.27e-07  |ddm|= 3.48e-07
converged SCF energy = -75.0109181790434  <S^2> = 2.0138238  2S+1 = 3.0092017

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3492 MB)
Init E_corr(CCSD) = -0.0600154318909983
cycle = 1  E_corr(CCSD) = -0.202352517080291  dE = -0.142337085  norm(t1,t2) = 0.209878
cycle = 2  E_corr(CCSD) = -0.210099660437881  dE = -0.00774714336  norm(t1,t2) = 0.04374
cycle = 3  E_corr(CCSD) = -0.213546011880919  dE = -0.00344635144  norm(t1,t2) = 0.0152588
cycle = 4  E_corr(CCSD) = -0.213770275188013  dE = -0.000224263307  norm(t1,t2) = 0.00466915
cycle = 5  E_corr(CCSD) = -0.213876854765118  dE = -0.000106579577  norm(t1,t2) = 0.00206791
cycle = 6  E_corr(CCSD) = -0.213937425294153  dE = -6.0570529e-05  norm(t1,t2) = 0.00086663
cycle = 7  E_corr(CCSD) = -0.213938057929299  dE = -6.32635146e-07  norm(t1,t2) = 0.000282154
cycle = 8  E_corr(CCSD) = -0.213936896547674  dE = 1.16138163e-06  norm(t1,t2) = 9.59561e-05
cycle = 9  E_corr(CCSD) = -0.213937673369597  dE = -7.76821923e-07  norm(t1,t2) = 2.86903e-05
cycle = 10  E_corr(CCSD) = -0.213937617304559  dE = 5.60650371e-08  norm(t1,t2) = 1.14646e-05
cycle = 11  E_corr(CCSD) = -0.213937607251585  dE = 1.00529743e-08  norm(t1,t2) = 6.29522e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.22485578629501  E_corr = -0.2139376072515851
cycle = 1  norm(lambda1,lambda2) = 0.209935
cycle = 2  norm(lambda1,lambda2) = 0.0395098
cycle = 3  norm(lambda1,lambda2) = 0.0138107
cycle = 4  norm(lambda1,lambda2) = 0.00447041
cycle = 5  norm(lambda1,lambda2) = 0.00198199
cycle = 6  norm(lambda1,lambda2) = 0.000808205
cycle = 7  norm(lambda1,lambda2) = 0.000274888
cycle = 8  norm(lambda1,lambda2) = 8.98042e-05
cycle = 9  norm(lambda1,lambda2) = 2.65739e-05
cycle = 10  norm(lambda1,lambda2) = 1.09496e-05
cycle = 11  norm(lambda1,lambda2) = 5.93222e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0030528130    -0.0000002004     0.0000003658
1 H    -0.0030528130     0.0000002004    -0.0000003658
----------------------------------------------
cycle 2: E = -75.2248557863  dE = -0.000377296  norm(grad) = 0.00431733

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.011843   0.000005  -0.000010   -0.002048  0.000005 -0.000010
   H   1.011843  -0.000005   0.000010    0.002048 -0.000005  0.000010
New geometry
   1 O     -0.011843284696   0.000005330333  -0.000009732680 AA   -0.022380564490   0.000010072870  -0.000018392099 Bohr

   2 H      1.011843284706  -0.000005330333   0.000009732680 AA    1.912106689075  -0.000010072870   0.000018392099 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 497 MB)
number electrons alpha = 5  beta = 3
init E= -75.007981305686
  alpha nocc = 5  HOMO = -1.20491241449797  LUMO = -0.190298768873292
  beta  nocc = 3  HOMO = -1.11300007463846  LUMO = -0.340490869808607
cycle= 1 E= -75.0108344887097  delta_E= -0.00285  |g|= 0.0011  |ddm|= 0.0011
  alpha nocc = 5  HOMO = -1.20380512826097  LUMO = -0.189608694285468
  beta  nocc = 3  HOMO = -1.11180587746712  LUMO = -0.339442015014403
cycle= 2 E= -75.0108349480252  delta_E= -4.59e-07  |g|= 0.000229  |ddm|= 0.000406
  alpha nocc = 5  HOMO = -1.20399123363946  LUMO = -0.1896776281238
  beta  nocc = 3  HOMO = -1.11191057459137  LUMO = -0.33961027158515
cycle= 3 E= -75.0108349742611  delta_E= -2.62e-08  |g|= 8.32e-05  |ddm|= 0.000112
  alpha nocc = 5  HOMO = -1.20398292723823  LUMO = -0.189681841708547
  beta  nocc = 3  HOMO = -1.11186475061763  LUMO = -0.339587083152044
cycle= 4 E= -75.0108349817753  delta_E= -7.51e-09  |g|= 4.62e-05  |ddm|= 5.29e-05
  alpha nocc = 5  HOMO = -1.20401118697184  LUMO = -0.189680436734154
  beta  nocc = 3  HOMO = -1.11185746493977  LUMO = -0.339599270834868
cycle= 5 E= -75.0108349852347  delta_E= -3.46e-09  |g|= 1.77e-05  |ddm|= 4.94e-05
  alpha nocc = 5  HOMO = -1.20401525767436  LUMO = -0.189678388203873
  beta  nocc = 3  HOMO = -1.1118449240831  LUMO = -0.339593969732989
cycle= 6 E= -75.0108349857497  delta_E= -5.15e-10  |g|= 2.56e-06  |ddm|= 2.66e-05
  alpha nocc = 5  HOMO = -1.20401598307921  LUMO = -0.189678586361292
  beta  nocc = 3  HOMO = -1.11184590945019  LUMO = -0.339594124996961
cycle= 7 E= -75.010834985755  delta_E= -5.3e-12  |g|= 6.28e-07  |ddm|= 2.64e-06
  alpha nocc = 5  HOMO = -1.20401586858874  LUMO = -0.189678628300221
  beta  nocc = 3  HOMO = -1.1118460419987  LUMO = -0.339594087142632
Extra cycle  E= -75.0108349857556  delta_E= -5.54e-13  |g|= 4.04e-07  |ddm|= 4.03e-07
converged SCF energy = -75.0108349857556  <S^2> = 2.013978  2S+1 = 3.0093042

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3559 MB)
Init E_corr(CCSD) = -0.0789860437905689
cycle = 1  E_corr(CCSD) = -0.204230716658717  dE = -0.125244673  norm(t1,t2) = 0.192059
cycle = 2  E_corr(CCSD) = -0.211029241912835  dE = -0.00679852525  norm(t1,t2) = 0.0387678
cycle = 3  E_corr(CCSD) = -0.213796760975154  dE = -0.00276751906  norm(t1,t2) = 0.0133738
cycle = 4  E_corr(CCSD) = -0.213906622065198  dE = -0.00010986109  norm(t1,t2) = 0.00399466
cycle = 5  E_corr(CCSD) = -0.214006291896537  dE = -9.96698313e-05  norm(t1,t2) = 0.00159802
cycle = 6  E_corr(CCSD) = -0.214033424560717  dE = -2.71326642e-05  norm(t1,t2) = 0.000673868
cycle = 7  E_corr(CCSD) = -0.21403171890177  dE = 1.70565895e-06  norm(t1,t2) = 0.000200547
cycle = 8  E_corr(CCSD) = -0.21403235368019  dE = -6.34778421e-07  norm(t1,t2) = 7.06899e-05
cycle = 9  E_corr(CCSD) = -0.214033408034916  dE = -1.05435473e-06  norm(t1,t2) = 2.60194e-05
cycle = 10  E_corr(CCSD) = -0.214033394499409  dE = 1.35355074e-08  norm(t1,t2) = 8.19003e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.22486838025496  E_corr = -0.2140333944994087
cycle = 1  norm(lambda1,lambda2) = 0.192012
cycle = 2  norm(lambda1,lambda2) = 0.0349964
cycle = 3  norm(lambda1,lambda2) = 0.0120875
cycle = 4  norm(lambda1,lambda2) = 0.00375202
cycle = 5  norm(lambda1,lambda2) = 0.00156351
cycle = 6  norm(lambda1,lambda2) = 0.000618978
cycle = 7  norm(lambda1,lambda2) = 0.000182843
cycle = 8  norm(lambda1,lambda2) = 6.53708e-05
cycle = 9  norm(lambda1,lambda2) = 2.32184e-05
cycle = 10  norm(lambda1,lambda2) = 7.36747e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0002404846     0.0000001007    -0.0000001819
1 H    -0.0002404846    -0.0000001007     0.0000001819
----------------------------------------------
cycle 3: E = -75.2248683803  dE = -1.2594e-05  norm(grad) = 0.000340097

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.012018   0.000003  -0.000005   -0.000175 -0.000002  0.000004
   H   1.012018  -0.000003   0.000005    0.000175  0.000002 -0.000004
New geometry
   1 O     -0.012018403353   0.000002923703  -0.000005387355 AA   -0.022711490792   0.000005524998  -0.000010180626 Bohr

   2 H      1.012018403368  -0.000002923703   0.000005387355 AA    1.912437615384  -0.000005524998   0.000010180626 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 493 MB)
number electrons alpha = 5  beta = 3
init E= -75.0105835018393
  alpha nocc = 5  HOMO = -1.20395885551844  LUMO = -0.189804318251937
  beta  nocc = 3  HOMO = -1.11181516785539  LUMO = -0.339624752978133
cycle= 1 E= -75.0108268596035  delta_E= -0.000243  |g|= 9.4e-05  |ddm|= 9.34e-05
  alpha nocc = 5  HOMO = -1.20386438248594  LUMO = -0.189745479166991
  beta  nocc = 3  HOMO = -1.11171316112287  LUMO = -0.339535218133463
cycle= 2 E= -75.0108268629592  delta_E= -3.36e-09  |g|= 1.96e-05  |ddm|= 3.48e-05
  alpha nocc = 5  HOMO = -1.20388029524761  LUMO = -0.189751383126523
  beta  nocc = 3  HOMO = -1.11172210073865  LUMO = -0.33954959009069
cycle= 3 E= -75.0108268631524  delta_E= -1.93e-10  |g|= 7.16e-06  |ddm|= 9.6e-06
  alpha nocc = 5  HOMO = -1.20387959272923  LUMO = -0.189751746502707
  beta  nocc = 3  HOMO = -1.11171817571925  LUMO = -0.339547602169132
cycle= 4 E= -75.0108268632085  delta_E= -5.61e-11  |g|= 3.98e-06  |ddm|= 4.56e-06
  alpha nocc = 5  HOMO = -1.20388202974204  LUMO = -0.189751625675275
  beta  nocc = 3  HOMO = -1.11171755041981  LUMO = -0.339548650124579
cycle= 5 E= -75.0108268632346  delta_E= -2.61e-11  |g|= 1.53e-06  |ddm|= 4.27e-06
  alpha nocc = 5  HOMO = -1.20388237480331  LUMO = -0.189751449278377
  beta  nocc = 3  HOMO = -1.11171647584594  LUMO = -0.339548192673068
cycle= 6 E= -75.0108268632386  delta_E= -3.99e-12  |g|= 2.71e-07  |ddm|= 2.3e-06
  alpha nocc = 5  HOMO = -1.20388242039291  LUMO = -0.189751468774402
  beta  nocc = 3  HOMO = -1.11171656920896  LUMO = -0.339548219563782
Extra cycle  E= -75.0108268632387  delta_E= -7.11e-14  |g|= 1.63e-07  |ddm|= 1.73e-07
converged SCF energy = -75.0108268632387  <S^2> = 2.0139913  2S+1 = 3.0093131

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3577 MB)
Init E_corr(CCSD) = -0.156993270885605
cycle = 1  E_corr(CCSD) = -0.210784819562146  dE = -0.0537915487  norm(t1,t2) = 0.112661
cycle = 2  E_corr(CCSD) = -0.213281510019046  dE = -0.00249669046  norm(t1,t2) = 0.0215027
cycle = 3  E_corr(CCSD) = -0.214061513501618  dE = -0.000780003483  norm(t1,t2) = 0.00643319
cycle = 4  E_corr(CCSD) = -0.214046152314113  dE = 1.53611875e-05  norm(t1,t2) = 0.00116858
cycle = 5  E_corr(CCSD) = -0.214041987025958  dE = 4.16528815e-06  norm(t1,t2) = 0.000267051
cycle = 6  E_corr(CCSD) = -0.21404348573898  dE = -1.49871302e-06  norm(t1,t2) = 7.35485e-05
cycle = 7  E_corr(CCSD) = -0.214042090450033  dE = 1.39528895e-06  norm(t1,t2) = 2.39195e-05
cycle = 8  E_corr(CCSD) = -0.214041763977358  dE = 3.26472675e-07  norm(t1,t2) = 8.31803e-06
cycle = 9  E_corr(CCSD) = -0.214041725313683  dE = 3.86636743e-08  norm(t1,t2) = 2.54942e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.22486858855235  E_corr = -0.2140417253136834
cycle = 1  norm(lambda1,lambda2) = 0.110964
cycle = 2  norm(lambda1,lambda2) = 0.0204355
cycle = 3  norm(lambda1,lambda2) = 0.00608573
cycle = 4  norm(lambda1,lambda2) = 0.00115298
cycle = 5  norm(lambda1,lambda2) = 0.000278118
cycle = 6  norm(lambda1,lambda2) = 7.10171e-05
cycle = 7  norm(lambda1,lambda2) = 2.53108e-05
cycle = 8  norm(lambda1,lambda2) = 9.81392e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0000034783    -0.0000000502     0.0000000909
1 H    -0.0000034783     0.0000000502    -0.0000000909
----------------------------------------------
cycle 4: E = -75.2248685886  dE = -2.08297e-07  norm(grad) = 4.92119e-06
