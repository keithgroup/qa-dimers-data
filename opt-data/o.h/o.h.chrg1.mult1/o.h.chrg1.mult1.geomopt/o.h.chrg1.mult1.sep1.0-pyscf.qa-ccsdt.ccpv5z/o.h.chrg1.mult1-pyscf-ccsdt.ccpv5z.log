#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/o.h/o.h.chrg1.mult1/o.h.chrg1.mult1.geomopt/o.h.chrg1.mult1.sep1.0-pyscf.qa-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['O', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 1
multiplicity = 1
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n43.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 8
[INPUT] charge = 1
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 4.23341768736
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.44
Create scanner for <class 'pyscf.grad.ccsd.Gradients'>
Set <class 'pyscf.cc.ccsd.CCSD'> as a scanner
Create scanner for <class 'pyscf.scf.hf.RHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 145 MB)
init E= -75.0300121843385

WARN: HOMO -0.430043885065026 == LUMO -0.430043885065013

cycle= 1 E= -74.7800943172864  delta_E= 0.25  |g|= 0.638  |ddm|= 0.832
  HOMO = -1.22478703916237  LUMO = -0.630236473412562
cycle= 2 E= -74.8657765086676  delta_E= -0.0857  |g|= 0.24  |ddm|= 0.326
  HOMO = -1.08375845804893  LUMO = -0.473558990152691
cycle= 3 E= -74.8725921688138  delta_E= -0.00682  |g|= 0.02  |ddm|= 0.0904
  HOMO = -1.08497021412181  LUMO = -0.470036911080363
cycle= 4 E= -74.8727241148507  delta_E= -0.000132  |g|= 0.0041  |ddm|= 0.019
  HOMO = -1.08402952802847  LUMO = -0.468552663569914
cycle= 5 E= -74.8727291634595  delta_E= -5.05e-06  |g|= 0.000595  |ddm|= 0.00417
  HOMO = -1.08420564851705  LUMO = -0.468605876739092
cycle= 6 E= -74.8727293109096  delta_E= -1.47e-07  |g|= 9.71e-05  |ddm|= 0.000518
  HOMO = -1.08423242879837  LUMO = -0.46860809587054
cycle= 7 E= -74.8727293154965  delta_E= -4.59e-09  |g|= 1.56e-05  |ddm|= 8.46e-05
  HOMO = -1.08423491971383  LUMO = -0.468609596928001
cycle= 8 E= -74.8727293156009  delta_E= -1.04e-10  |g|= 1.34e-06  |ddm|= 1.64e-05
  HOMO = -1.08423459591426  LUMO = -0.468609135228561
cycle= 9 E= -74.8727293156013  delta_E= -4.41e-13  |g|= 1.36e-07  |ddm|= 2.27e-06
  HOMO = -1.08423457033817  LUMO = -0.46860911939963
Extra cycle  E= -74.8727293156014  delta_E= -1.14e-13  |g|= 4.01e-08  |ddm|= 1.82e-07
converged SCF energy = -74.8727293156014

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 4, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1504 MB)
Init t2, MP2 energy = -75.0953871796793  E_corr(MP2) -0.222657864077927
Init E_corr(CCSD) = -0.222657864077925
cycle = 1  E_corr(CCSD) = -0.237260985734794  dE = -0.0146031217  norm(t1,t2) = 0.0379292
cycle = 2  E_corr(CCSD) = -0.242367040966724  dE = -0.00510605523  norm(t1,t2) = 0.0253807
cycle = 3  E_corr(CCSD) = -0.247611409056947  dE = -0.00524436809  norm(t1,t2) = 0.0201496
cycle = 4  E_corr(CCSD) = -0.249121312738826  dE = -0.00150990368  norm(t1,t2) = 0.0140102
cycle = 5  E_corr(CCSD) = -0.250050105696317  dE = -0.000928792957  norm(t1,t2) = 0.00989357
cycle = 6  E_corr(CCSD) = -0.251729079037131  dE = -0.00167897334  norm(t1,t2) = 0.00645719
cycle = 7  E_corr(CCSD) = -0.252011564931055  dE = -0.000282485894  norm(t1,t2) = 0.00293343
cycle = 8  E_corr(CCSD) = -0.251971420461218  dE = 4.01444698e-05  norm(t1,t2) = 0.000985649
cycle = 9  E_corr(CCSD) = -0.252049912157878  dE = -7.84916967e-05  norm(t1,t2) = 0.00025338
cycle = 10  E_corr(CCSD) = -0.252044790158069  dE = 5.12199981e-06  norm(t1,t2) = 5.61347e-05
cycle = 11  E_corr(CCSD) = -0.252043431838791  dE = 1.35831928e-06  norm(t1,t2) = 1.23577e-05
cycle = 12  E_corr(CCSD) = -0.25204495413447  dE = -1.52229568e-06  norm(t1,t2) = 3.45181e-06
cycle = 13  E_corr(CCSD) = -0.252044654144892  dE = 2.99989578e-07  norm(t1,t2) = 1.01166e-06
cycle = 14  E_corr(CCSD) = -0.252044629430123  dE = 2.47147685e-08  norm(t1,t2) = 1.00063e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -75.12477394503154  E_corr = -0.2520446294301233
cycle = 1  norm(lambda1,lambda2) = 0.0141122
cycle = 2  norm(lambda1,lambda2) = 0.00504277
cycle = 3  norm(lambda1,lambda2) = 0.00327809
cycle = 4  norm(lambda1,lambda2) = 0.00191584
cycle = 5  norm(lambda1,lambda2) = 0.0013617
cycle = 6  norm(lambda1,lambda2) = 0.000997297
cycle = 7  norm(lambda1,lambda2) = 0.000681184
cycle = 8  norm(lambda1,lambda2) = 0.000254275
cycle = 9  norm(lambda1,lambda2) = 7.46682e-05
cycle = 10  norm(lambda1,lambda2) = 1.57543e-05
cycle = 11  norm(lambda1,lambda2) = 3.82165e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0168449614     0.0000000000     0.0000000000
1 H    -0.0168449614    -0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -75.124773945  dE = -75.1248  norm(grad) = 0.0238224

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.009346  -0.000000  -0.000000   -0.009346 -0.000000 -0.000000
   H   1.009346   0.000000   0.000000    0.009346  0.000000  0.000000
New geometry
   1 O     -0.009346070267  -0.000000000000  -0.000000000000 AA   -0.017661513146  -0.000000000000  -0.000000000001 Bohr

   2 H      1.009346070274   0.000000000000   0.000000000000 AA    1.907387637724   0.000000000000   0.000000000001 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 352 MB)
init E= -74.8592408047239
  HOMO = -1.08546507185424  LUMO = -0.470367955910979
cycle= 1 E= -74.8726351965257  delta_E= -0.0134  |g|= 0.00721  |ddm|= 0.00705
  HOMO = -1.08026346118142  LUMO = -0.465046329083391
cycle= 2 E= -74.8726444782268  delta_E= -9.28e-06  |g|= 0.00144  |ddm|= 0.00267
  HOMO = -1.08120279684741  LUMO = -0.465989411164508
cycle= 3 E= -74.8726447844483  delta_E= -3.06e-07  |g|= 0.000303  |ddm|= 0.00065
  HOMO = -1.08106358505674  LUMO = -0.465860124486065
cycle= 4 E= -74.8726448068897  delta_E= -2.24e-08  |g|= 7.5e-05  |ddm|= 0.000153
  HOMO = -1.08109786069156  LUMO = -0.465893361852027
cycle= 5 E= -74.8726448080187  delta_E= -1.13e-09  |g|= 7.89e-06  |ddm|= 5.12e-05
  HOMO = -1.08109605934869  LUMO = -0.46589121361914
cycle= 6 E= -74.8726448080391  delta_E= -2.04e-11  |g|= 1.18e-06  |ddm|= 8.06e-06
  HOMO = -1.0810961597531  LUMO = -0.465891119587643
cycle= 7 E= -74.8726448080398  delta_E= -6.54e-13  |g|= 1.92e-07  |ddm|= 1.29e-06
  HOMO = -1.0810961904605  LUMO = -0.46589112074088
Extra cycle  E= -74.87264480804  delta_E= -1.85e-13  |g|= 7.43e-08  |ddm|= 1.32e-07
converged SCF energy = -74.87264480804

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 4, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1690 MB)
Init E_corr(CCSD) = -0.165778939933199
cycle = 1  E_corr(CCSD) = -0.247697647583606  dE = -0.0819187077  norm(t1,t2) = 0.0990679
cycle = 2  E_corr(CCSD) = -0.251275995044653  dE = -0.00357834746  norm(t1,t2) = 0.0188495
cycle = 3  E_corr(CCSD) = -0.252459182012882  dE = -0.00118318697  norm(t1,t2) = 0.00491617
cycle = 4  E_corr(CCSD) = -0.252575228366493  dE = -0.000116046354  norm(t1,t2) = 0.00141988
cycle = 5  E_corr(CCSD) = -0.252556385692247  dE = 1.88426742e-05  norm(t1,t2) = 0.000504579
cycle = 6  E_corr(CCSD) = -0.252549925253715  dE = 6.46043853e-06  norm(t1,t2) = 0.000366211
cycle = 7  E_corr(CCSD) = -0.252530294563124  dE = 1.96306906e-05  norm(t1,t2) = 0.000326273
cycle = 8  E_corr(CCSD) = -0.252511337093323  dE = 1.89574698e-05  norm(t1,t2) = 0.000303049
cycle = 9  E_corr(CCSD) = -0.252510065236838  dE = 1.27185648e-06  norm(t1,t2) = 0.000299351
cycle = 10  E_corr(CCSD) = -0.252516435591274  dE = -6.37035444e-06  norm(t1,t2) = 0.000300018
cycle = 11  E_corr(CCSD) = -0.252517872801186  dE = -1.43720991e-06  norm(t1,t2) = 0.000289246
cycle = 12  E_corr(CCSD) = -0.252499268396917  dE = 1.86044043e-05  norm(t1,t2) = 0.000262751
cycle = 13  E_corr(CCSD) = -0.252473760721164  dE = 2.55076758e-05  norm(t1,t2) = 0.000179236
cycle = 14  E_corr(CCSD) = -0.252469676902942  dE = 4.08381822e-06  norm(t1,t2) = 4.11641e-05
cycle = 15  E_corr(CCSD) = -0.252469676394669  dE = 5.08272424e-10  norm(t1,t2) = 1.12558e-05
cycle = 16  E_corr(CCSD) = -0.252470142739578  dE = -4.66344909e-07  norm(t1,t2) = 4.24441e-06
cycle = 17  E_corr(CCSD) = -0.252470266590735  dE = -1.23851157e-07  norm(t1,t2) = 2.5634e-06
cycle = 18  E_corr(CCSD) = -0.252470213091163  dE = 5.34995722e-08  norm(t1,t2) = 1.76126e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.12511502113114  E_corr = -0.2524702130911631
cycle = 1  norm(lambda1,lambda2) = 0.0942252
cycle = 2  norm(lambda1,lambda2) = 0.0174733
cycle = 3  norm(lambda1,lambda2) = 0.00450756
cycle = 4  norm(lambda1,lambda2) = 0.00139275
cycle = 5  norm(lambda1,lambda2) = 0.000459582
cycle = 6  norm(lambda1,lambda2) = 0.000340578
cycle = 7  norm(lambda1,lambda2) = 0.000310029
cycle = 8  norm(lambda1,lambda2) = 0.000283739
cycle = 9  norm(lambda1,lambda2) = 0.000269792
cycle = 10  norm(lambda1,lambda2) = 0.000271705
cycle = 11  norm(lambda1,lambda2) = 0.000256139
cycle = 12  norm(lambda1,lambda2) = 0.000172166
cycle = 13  norm(lambda1,lambda2) = 9.75798e-05
cycle = 14  norm(lambda1,lambda2) = 4.06589e-05
cycle = 15  norm(lambda1,lambda2) = 1.23172e-05
cycle = 16  norm(lambda1,lambda2) = 3.41449e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0027640781     0.0000005600    -0.0000000376
1 H    -0.0027640781    -0.0000005600     0.0000000376
----------------------------------------------
cycle 2: E = -75.1251150211  dE = -0.000341076  norm(grad) = 0.003909

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.011181  -0.000015   0.000001   -0.001835 -0.000015  0.000001
   H   1.011181   0.000015  -0.000001    0.001835  0.000015 -0.000001
New geometry
   1 O     -0.011180704930  -0.000014715880   0.000000987472 AA   -0.021128470198  -0.000027808984   0.000001866052 Bohr

   2 H      1.011180704925   0.000014715880  -0.000000987472 AA    1.910854594753   0.000027808984  -0.000001866052 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 401 MB)
init E= -74.8699752776657
  HOMO = -1.08133805581711  LUMO = -0.466230933594852
cycle= 1 E= -74.8725706891546  delta_E= -0.0026  |g|= 0.00141  |ddm|= 0.00136
  HOMO = -1.08031787608847  LUMO = -0.465191052068404
cycle= 2 E= -74.8725710440243  delta_E= -3.55e-07  |g|= 0.000281  |ddm|= 0.000524
  HOMO = -1.0805014052153  LUMO = -0.465375816772653
cycle= 3 E= -74.8725710558172  delta_E= -1.18e-08  |g|= 5.96e-05  |ddm|= 0.000127
  HOMO = -1.0804736146918  LUMO = -0.465350233100709
cycle= 4 E= -74.8725710566797  delta_E= -8.63e-10  |g|= 1.47e-05  |ddm|= 3.01e-05
  HOMO = -1.0804802471435  LUMO = -0.465356757889218
cycle= 5 E= -74.872571056722  delta_E= -4.22e-11  |g|= 1.48e-06  |ddm|= 1e-05
  HOMO = -1.08047986225243  LUMO = -0.465356339098829
cycle= 6 E= -74.8725710567229  delta_E= -9.38e-13  |g|= 2.01e-07  |ddm|= 1.54e-06
  HOMO = -1.08047985915776  LUMO = -0.465356316501329
Extra cycle  E= -74.8725710567228  delta_E= 9.95e-14  |g|= 7.49e-08  |ddm|= 1.71e-07
converged SCF energy = -74.8725710567228

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 4, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1732 MB)
Init E_corr(CCSD) = -0.244372393148909
cycle = 1  E_corr(CCSD) = -0.252320535061694  dE = -0.00794814191  norm(t1,t2) = 0.019324
cycle = 2  E_corr(CCSD) = -0.252504485828648  dE = -0.000183950767  norm(t1,t2) = 0.00250101
cycle = 3  E_corr(CCSD) = -0.25256722819747  dE = -6.27423688e-05  norm(t1,t2) = 0.000384605
cycle = 4  E_corr(CCSD) = -0.252563602624714  dE = 3.62557276e-06  norm(t1,t2) = 0.000114263
cycle = 5  E_corr(CCSD) = -0.252559505849269  dE = 4.09677545e-06  norm(t1,t2) = 3.75385e-05
cycle = 6  E_corr(CCSD) = -0.25255827834097  dE = 1.2275083e-06  norm(t1,t2) = 1.83646e-05
cycle = 7  E_corr(CCSD) = -0.252556787671856  dE = 1.49066911e-06  norm(t1,t2) = 1.17931e-05
cycle = 8  E_corr(CCSD) = -0.252555903023892  dE = 8.84647964e-07  norm(t1,t2) = 7.68265e-06
cycle = 9  E_corr(CCSD) = -0.252555484006902  dE = 4.1901699e-07  norm(t1,t2) = 5.27778e-06
cycle = 10  E_corr(CCSD) = -0.252554851105461  dE = 6.3290144e-07  norm(t1,t2) = 4.0993e-06
cycle = 11  E_corr(CCSD) = -0.252554305057511  dE = 5.4604795e-07  norm(t1,t2) = 2.29529e-06
cycle = 12  E_corr(CCSD) = -0.252554211803136  dE = 9.32543749e-08  norm(t1,t2) = 3.91883e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -75.12512526852595  E_corr = -0.2525542118031361
cycle = 1  norm(lambda1,lambda2) = 0.0184639
cycle = 2  norm(lambda1,lambda2) = 0.0023482
cycle = 3  norm(lambda1,lambda2) = 0.000366229
cycle = 4  norm(lambda1,lambda2) = 0.000103594
cycle = 5  norm(lambda1,lambda2) = 2.88303e-05
cycle = 6  norm(lambda1,lambda2) = 1.493e-05
cycle = 7  norm(lambda1,lambda2) = 1.25462e-05
cycle = 8  norm(lambda1,lambda2) = 1.04551e-05
cycle = 9  norm(lambda1,lambda2) = 5.04683e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0002047329    -0.0000000773    -0.0000000017
1 H    -0.0002047329     0.0000000773     0.0000000017
----------------------------------------------
cycle 3: E = -75.1251252685  dE = -1.02474e-05  norm(grad) = 0.000289536

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   O  -0.011327  -0.000013   0.000001   -0.000147  0.000002  0.000000
   H   1.011327   0.000013  -0.000001    0.000147 -0.000002 -0.000000
New geometry
   1 O     -0.011327465189  -0.000012921665   0.000001031819 AA   -0.021405806894  -0.000024418407   0.000001949855 Bohr

   2 H      1.011327465187   0.000012921665  -0.000001031819 AA    1.911131931453   0.000024418407  -0.000001949855 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 374 MB)
init E= -74.8723571818058
  HOMO = -1.08049920342434  LUMO = -0.4653834056841
cycle= 1 E= -74.8725643861939  delta_E= -0.000207  |g|= 0.000113  |ddm|= 0.000108
  HOMO = -1.08041763242856  LUMO = -0.465300311284842
cycle= 2 E= -74.8725643884613  delta_E= -2.27e-09  |g|= 2.25e-05  |ddm|= 4.19e-05
  HOMO = -1.08043230017644  LUMO = -0.465315084514709
cycle= 3 E= -74.8725643885373  delta_E= -7.59e-11  |g|= 4.77e-06  |ddm|= 1.02e-05
  HOMO = -1.08043007210781  LUMO = -0.465313035881504
cycle= 4 E= -74.8725643885422  delta_E= -4.96e-12  |g|= 1.18e-06  |ddm|= 2.41e-06
  HOMO = -1.08043060148692  LUMO = -0.465313557751302
cycle= 5 E= -74.8725643885428  delta_E= -5.83e-13  |g|= 1.21e-07  |ddm|= 8.01e-07
  HOMO = -1.0804305597727  LUMO = -0.465313514247923
Extra cycle  E= -74.8725643885427  delta_E= 9.95e-14  |g|= 4.2e-08  |ddm|= 9.88e-08
converged SCF energy = -74.8725643885427

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 4, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1742 MB)
Init E_corr(CCSD) = -0.252552598847782
cycle = 1  E_corr(CCSD) = -0.252559528165306  dE = -6.92931752e-06  norm(t1,t2) = 0.000389785
cycle = 2  E_corr(CCSD) = -0.252560548482545  dE = -1.02031724e-06  norm(t1,t2) = 7.20305e-05
cycle = 3  E_corr(CCSD) = -0.252560967690216  dE = -4.19207672e-07  norm(t1,t2) = 1.87582e-05
cycle = 4  E_corr(CCSD) = -0.252560972192015  dE = -4.50179877e-09  norm(t1,t2) = 3.08725e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -75.12512536073467  E_corr = -0.2525609721920152
cycle = 1  norm(lambda1,lambda2) = 0.000369231
cycle = 2  norm(lambda1,lambda2) = 6.87371e-05
cycle = 3  norm(lambda1,lambda2) = 1.80982e-05
cycle = 4  norm(lambda1,lambda2) = 3.00389e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 O     0.0000023042    -0.0000000342     0.0000000165
1 H    -0.0000023042     0.0000000342    -0.0000000165
----------------------------------------------
cycle 4: E = -75.1251253607  dE = -9.22087e-08  norm(grad) = 3.25901e-06
