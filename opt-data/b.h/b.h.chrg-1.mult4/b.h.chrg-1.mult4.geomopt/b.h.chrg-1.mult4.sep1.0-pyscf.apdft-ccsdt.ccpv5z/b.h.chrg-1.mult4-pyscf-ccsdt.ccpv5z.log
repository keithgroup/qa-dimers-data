#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/b.h/b.h.chrg-1.mult4/b.h.chrg-1.mult4.geomopt/b.h.chrg-1.mult4.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['B', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = -1
multiplicity = 4
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n59.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:40 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 7
[INPUT] charge = -1
[INPUT] spin (= nelec alpha-beta = 2S) = 3
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 B      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 2.6458860546
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.28
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 B      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 145 MB)
number electrons alpha = 5  beta = 2
init E= -25.01066233011
  alpha nocc = 5  HOMO = -0.00327050733410792  LUMO = 0.1185572783839
  beta  nocc = 2  HOMO = -0.7606906790006  LUMO = -0.165815601357331

WARN: system HOMO -0.00327050733410792 >= system LUMO -0.165815601357331

cycle= 1 E= -25.0547182349329  delta_E= -0.0441  |g|= 0.123  |ddm|=  0.9
  alpha nocc = 5  HOMO = -0.0294135724936364  LUMO = 0.26559008581144
  beta  nocc = 2  HOMO = -0.344861844736559  LUMO = 0.238921995521364
cycle= 2 E= -25.0804102788471  delta_E= -0.0257  |g|= 0.0654  |ddm|= 0.263
  alpha nocc = 5  HOMO = -0.0257646500732281  LUMO = 0.268118219627212
  beta  nocc = 2  HOMO = -0.341526440866541  LUMO = 0.249818755133536
cycle= 3 E= -25.0906732528462  delta_E= -0.0103  |g|= 0.0228  |ddm|= 0.18
  alpha nocc = 5  HOMO = -0.0294048873099649  LUMO = 0.269732166894335
  beta  nocc = 2  HOMO = -0.356378357996304  LUMO = 0.252560040303744
cycle= 4 E= -25.091854709432  delta_E= -0.00118  |g|= 0.00858  |ddm|= 0.0649
  alpha nocc = 5  HOMO = -0.0292200852698302  LUMO = 0.270132185598808
  beta  nocc = 2  HOMO = -0.35341914494256  LUMO = 0.252404111350161
cycle= 5 E= -25.0919893793713  delta_E= -0.000135  |g|= 0.00212  |ddm|= 0.0221
  alpha nocc = 5  HOMO = -0.0296662770008013  LUMO = 0.270122937864211
  beta  nocc = 2  HOMO = -0.354689876302932  LUMO = 0.252527498815188
cycle= 6 E= -25.0919960286661  delta_E= -6.65e-06  |g|= 0.000559  |ddm|= 0.00468
  alpha nocc = 5  HOMO = -0.0294554666565092  LUMO = 0.270206819627348
  beta  nocc = 2  HOMO = -0.354163476796787  LUMO = 0.252614292559657
cycle= 7 E= -25.0919965313727  delta_E= -5.03e-07  |g|= 0.000216  |ddm|= 0.00209
  alpha nocc = 5  HOMO = -0.0294833403617302  LUMO = 0.270226892144694
  beta  nocc = 2  HOMO = -0.354028823974259  LUMO = 0.252624248658276
cycle= 8 E= -25.0919966563672  delta_E= -1.25e-07  |g|= 4.73e-05  |ddm|= 0.00154
  alpha nocc = 5  HOMO = -0.029483661238255  LUMO = 0.270233263092997
  beta  nocc = 2  HOMO = -0.354003957474642  LUMO = 0.252634817873372
cycle= 9 E= -25.091996662632  delta_E= -6.26e-09  |g|= 1.35e-05  |ddm|= 0.000317
  alpha nocc = 5  HOMO = -0.0294829332424627  LUMO = 0.270235582737082
  beta  nocc = 2  HOMO = -0.3539878030804  LUMO = 0.252636633475858
cycle= 10 E= -25.0919966630837  delta_E= -4.52e-10  |g|= 3.62e-06  |ddm|= 6.42e-05
  alpha nocc = 5  HOMO = -0.0294838985713963  LUMO = 0.27023600791135
  beta  nocc = 2  HOMO = -0.353986602619247  LUMO = 0.252637374501355
cycle= 11 E= -25.0919966631218  delta_E= -3.82e-11  |g|= 7.78e-07  |ddm|= 2.02e-05
  alpha nocc = 5  HOMO = -0.0294836862952958  LUMO = 0.270236069380524
  beta  nocc = 2  HOMO = -0.353985816587454  LUMO = 0.252637375299316
Extra cycle  E= -25.0919966631225  delta_E= -6.18e-13  |g|= 3.16e-07  |ddm|= 1.47e-06
converged SCF energy = -25.0919966631225  <S^2> = 3.7529845  2S+1 = 4.001492

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3334 MB)
Init t2, MP2 energy = -0.103062253951037
Init E_corr(CCSD) = -0.103062253951138
cycle = 1  E_corr(CCSD) = -0.113803438009393  dE = -0.0107411841  norm(t1,t2) = 0.0428619
cycle = 2  E_corr(CCSD) = -0.116621379764561  dE = -0.00281794176  norm(t1,t2) = 0.0168448
cycle = 3  E_corr(CCSD) = -0.118112065110413  dE = -0.00149068535  norm(t1,t2) = 0.00921054
cycle = 4  E_corr(CCSD) = -0.118070028618687  dE = 4.20364917e-05  norm(t1,t2) = 0.00290815
cycle = 5  E_corr(CCSD) = -0.118065392477661  dE = 4.63614103e-06  norm(t1,t2) = 0.00085158
cycle = 6  E_corr(CCSD) = -0.118085522507545  dE = -2.01300299e-05  norm(t1,t2) = 0.00029061
cycle = 7  E_corr(CCSD) = -0.118085775647478  dE = -2.53139934e-07  norm(t1,t2) = 6.80222e-05
cycle = 8  E_corr(CCSD) = -0.118085471610131  dE = 3.04037348e-07  norm(t1,t2) = 1.96614e-05
cycle = 9  E_corr(CCSD) = -0.118085508021901  dE = -3.64117699e-08  norm(t1,t2) = 7.05532e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.21008217114436  E_corr = -0.1180855080219005
cycle = 1  norm(lambda1,lambda2) = 0.00793663
cycle = 2  norm(lambda1,lambda2) = 0.00200505
cycle = 3  norm(lambda1,lambda2) = 0.000853492
cycle = 4  norm(lambda1,lambda2) = 0.000289221
cycle = 5  norm(lambda1,lambda2) = 0.000116392
cycle = 6  norm(lambda1,lambda2) = 3.54316e-05
cycle = 7  norm(lambda1,lambda2) = 1.0671e-05
cycle = 8  norm(lambda1,lambda2) = 3.16987e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.1486848844     0.0000000000     0.0000000000
1 H    -0.1486848844    -0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -25.2100821711  dE = -25.2101  norm(grad) = 0.210272

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.082495  -0.000000  -0.000000   -0.082495 -0.000000 -0.000000
   H   1.082495   0.000000   0.000000    0.082495  0.000000  0.000000
New geometry
   1 B     -0.082494660610  -0.000000000000  -0.000000000000 AA   -0.155892315292  -0.000000000000  -0.000000000000 Bohr

   2 H      1.082494661190   0.000000000000   0.000000000000 AA    2.045618440952   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 414 MB)
number electrons alpha = 5  beta = 2
init E= -25.1116691118014
  alpha nocc = 5  HOMO = -0.0411010607818684  LUMO = 0.269418190166423
  beta  nocc = 2  HOMO = -0.314082119059092  LUMO = 0.246484670843114
cycle= 1 E= -25.1142053543268  delta_E= -0.00254  |g|= 0.0201  |ddm|= 0.0705
  alpha nocc = 5  HOMO = -0.0311260928708129  LUMO = 0.275405896858858
  beta  nocc = 2  HOMO = -0.308057454815473  LUMO = 0.251754790683544
cycle= 2 E= -25.1146398556839  delta_E= -0.000435  |g|= 0.00625  |ddm|= 0.0183
  alpha nocc = 5  HOMO = -0.0329479327365841  LUMO = 0.275595122902212
  beta  nocc = 2  HOMO = -0.312794128399493  LUMO = 0.251752994045302
cycle= 3 E= -25.1147093179325  delta_E= -6.95e-05  |g|= 0.00261  |ddm|= 0.0113
  alpha nocc = 5  HOMO = -0.0325734140199566  LUMO = 0.275691927339516
  beta  nocc = 2  HOMO = -0.310435118961615  LUMO = 0.251814476672337
cycle= 4 E= -25.1147275893989  delta_E= -1.83e-05  |g|= 0.000809  |ddm|= 0.0101
  alpha nocc = 5  HOMO = -0.0327593924114293  LUMO = 0.275665720514969
  beta  nocc = 2  HOMO = -0.310122755793471  LUMO = 0.251744985459859
cycle= 5 E= -25.1147292198921  delta_E= -1.63e-06  |g|= 0.000305  |ddm|= 0.00399
  alpha nocc = 5  HOMO = -0.0326716897943964  LUMO = 0.275704288620113
  beta  nocc = 2  HOMO = -0.309963068599747  LUMO = 0.251808781641939
cycle= 6 E= -25.1147294103289  delta_E= -1.9e-07  |g|= 8.36e-05  |ddm|= 0.00155
  alpha nocc = 5  HOMO = -0.0327018128392115  LUMO = 0.275696282960191
  beta  nocc = 2  HOMO = -0.310052347633378  LUMO = 0.251797609200405
cycle= 7 E= -25.114729425568  delta_E= -1.52e-08  |g|= 2.81e-05  |ddm|= 0.000323
  alpha nocc = 5  HOMO = -0.032701120499671  LUMO = 0.275692768475954
  beta  nocc = 2  HOMO = -0.310079206946175  LUMO = 0.251793157322885
cycle= 8 E= -25.1147294283062  delta_E= -2.74e-09  |g|= 8.28e-06  |ddm|= 0.000207
  alpha nocc = 5  HOMO = -0.0327005923907962  LUMO = 0.27569085277193
  beta  nocc = 2  HOMO = -0.310086886696082  LUMO = 0.251790493648278
cycle= 9 E= -25.1147294285598  delta_E= -2.54e-10  |g|= 1.69e-06  |ddm|= 5.29e-05
  alpha nocc = 5  HOMO = -0.0327001374143983  LUMO = 0.275690784837314
  beta  nocc = 2  HOMO = -0.310085884625831  LUMO = 0.251790413758326
cycle= 10 E= -25.1147294285663  delta_E= -6.52e-12  |g|= 2.61e-07  |ddm|= 1.25e-05
  alpha nocc = 5  HOMO = -0.0327001479447396  LUMO = 0.275690790114268
  beta  nocc = 2  HOMO = -0.310085837192074  LUMO = 0.251790420157609
Extra cycle  E= -25.1147294285665  delta_E= -2.13e-13  |g|= 1.15e-07  |ddm|= 1.22e-06
converged SCF energy = -25.1147294285665  <S^2> = 3.7533685  2S+1 = 4.0016839

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3522 MB)
Init E_corr(CCSD) = -0.0240490558143807
cycle = 1  E_corr(CCSD) = -0.106238173529242  dE = -0.0821891177  norm(t1,t2) = 0.228432
cycle = 2  E_corr(CCSD) = -0.114441593627522  dE = -0.0082034201  norm(t1,t2) = 0.0602374
cycle = 3  E_corr(CCSD) = -0.117811466316402  dE = -0.00336987269  norm(t1,t2) = 0.0231683
cycle = 4  E_corr(CCSD) = -0.117826168051798  dE = -1.47017354e-05  norm(t1,t2) = 0.00699001
cycle = 5  E_corr(CCSD) = -0.117876459033958  dE = -5.02909822e-05  norm(t1,t2) = 0.00283512
cycle = 6  E_corr(CCSD) = -0.117936449407633  dE = -5.99903737e-05  norm(t1,t2) = 0.0011562
cycle = 7  E_corr(CCSD) = -0.117946497813724  dE = -1.00484061e-05  norm(t1,t2) = 0.000384473
cycle = 8  E_corr(CCSD) = -0.117950017232889  dE = -3.51941916e-06  norm(t1,t2) = 0.000146745
cycle = 9  E_corr(CCSD) = -0.117951167624438  dE = -1.15039155e-06  norm(t1,t2) = 4.29994e-05
cycle = 10  E_corr(CCSD) = -0.117950938259697  dE = 2.29364741e-07  norm(t1,t2) = 1.34202e-05
cycle = 11  E_corr(CCSD) = -0.117950988913193  dE = -5.0653496e-08  norm(t1,t2) = 4.94525e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.23268041747972  E_corr = -0.1179509889131933
cycle = 1  norm(lambda1,lambda2) = 0.228344
cycle = 2  norm(lambda1,lambda2) = 0.0533916
cycle = 3  norm(lambda1,lambda2) = 0.0203003
cycle = 4  norm(lambda1,lambda2) = 0.00652699
cycle = 5  norm(lambda1,lambda2) = 0.00277047
cycle = 6  norm(lambda1,lambda2) = 0.00104531
cycle = 7  norm(lambda1,lambda2) = 0.000362042
cycle = 8  norm(lambda1,lambda2) = 0.000135701
cycle = 9  norm(lambda1,lambda2) = 3.89705e-05
cycle = 10  norm(lambda1,lambda2) = 1.30965e-05
cycle = 11  norm(lambda1,lambda2) = 4.52876e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0139250142    -0.0000000100    -0.0000000018
1 H    -0.0139250143     0.0000000100     0.0000000018
----------------------------------------------
cycle 2: E = -25.2326804175  dE = -0.0225982  norm(grad) = 0.0196929

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.091019   0.000000   0.000000   -0.008524  0.000000  0.000000
   H   1.091019  -0.000000  -0.000000    0.008524 -0.000000 -0.000000
New geometry
   1 B     -0.091019003377   0.000000315495   0.000000057460 AA   -0.172000988513   0.000000596199   0.000000108583 Bohr

   2 H      1.091019004022  -0.000000315495  -0.000000057460 AA    2.061727114297  -0.000000596199  -0.000000108583 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 451 MB)
number electrons alpha = 5  beta = 2
init E= -25.1130128089872
  alpha nocc = 5  HOMO = -0.0345118745502529  LUMO = 0.275198397311016
  beta  nocc = 2  HOMO = -0.306847964872344  LUMO = 0.250758388717784
cycle= 1 E= -25.1150352034634  delta_E= -0.00202  |g|= 0.0021  |ddm|= 0.0065
  alpha nocc = 5  HOMO = -0.0328177564199597  LUMO = 0.2760554402089
  beta  nocc = 2  HOMO = -0.305364589190558  LUMO = 0.251647543013761
cycle= 2 E= -25.1150403396835  delta_E= -5.14e-06  |g|= 0.000657  |ddm|= 0.00253
  alpha nocc = 5  HOMO = -0.0331621122341391  LUMO = 0.276034067539166
  beta  nocc = 2  HOMO = -0.306041311125542  LUMO = 0.251578857886054
cycle= 3 E= -25.1150410654241  delta_E= -7.26e-07  |g|= 0.000287  |ddm|= 0.00116
  alpha nocc = 5  HOMO = -0.0331074569012486  LUMO = 0.276047566162226
  beta  nocc = 2  HOMO = -0.305811331490893  LUMO = 0.251594972813088
cycle= 4 E= -25.1150412739856  delta_E= -2.09e-07  |g|= 0.0001  |ddm|= 0.000987
  alpha nocc = 5  HOMO = -0.0331239837141907  LUMO = 0.276043402228096
  beta  nocc = 2  HOMO = -0.305739002411761  LUMO = 0.251585871111974
cycle= 5 E= -25.1150413022478  delta_E= -2.83e-08  |g|= 3.57e-05  |ddm|= 0.00051
  alpha nocc = 5  HOMO = -0.0331144990393068  LUMO = 0.276048237133081
  beta  nocc = 2  HOMO = -0.305719578184539  LUMO = 0.251593792999329
cycle= 6 E= -25.1150413049515  delta_E= -2.7e-09  |g|= 9.7e-06  |ddm|= 0.000189
  alpha nocc = 5  HOMO = -0.0331178741265514  LUMO = 0.276047441458946
  beta  nocc = 2  HOMO = -0.305729703119198  LUMO = 0.251592581385928
cycle= 7 E= -25.1150413051558  delta_E= -2.04e-10  |g|= 3.26e-06  |ddm|= 3.38e-05
  alpha nocc = 5  HOMO = -0.0331180236609756  LUMO = 0.276046970370023
  beta  nocc = 2  HOMO = -0.305733132264503  LUMO = 0.251591935207111
cycle= 8 E= -25.1150413051926  delta_E= -3.68e-11  |g|= 9.32e-07  |ddm|= 2.18e-05
  alpha nocc = 5  HOMO = -0.0331180172191025  LUMO = 0.276046870031736
  beta  nocc = 2  HOMO = -0.305733442595381  LUMO = 0.251591787196092
Extra cycle  E= -25.1150413051947  delta_E= -2.09e-12  |g|= 5.48e-07  |ddm|= 2.37e-06
converged SCF energy = -25.1150413051947  <S^2> = 3.7533936  2S+1 = 4.0016965

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3537 MB)
Init E_corr(CCSD) = -0.0531661180472994
cycle = 1  E_corr(CCSD) = -0.109969038349712  dE = -0.0568029203  norm(t1,t2) = 0.195437
cycle = 2  E_corr(CCSD) = -0.115119078011529  dE = -0.00515003966  norm(t1,t2) = 0.055108
cycle = 3  E_corr(CCSD) = -0.117711918216632  dE = -0.00259284021  norm(t1,t2) = 0.0241032
cycle = 4  E_corr(CCSD) = -0.117770057774125  dE = -5.81395575e-05  norm(t1,t2) = 0.00858507
cycle = 5  E_corr(CCSD) = -0.117850768924302  dE = -8.07111502e-05  norm(t1,t2) = 0.00353469
cycle = 6  E_corr(CCSD) = -0.11793635525282  dE = -8.55863285e-05  norm(t1,t2) = 0.0014952
cycle = 7  E_corr(CCSD) = -0.117943883968305  dE = -7.52871549e-06  norm(t1,t2) = 0.000387919
cycle = 8  E_corr(CCSD) = -0.11794653021748  dE = -2.64624917e-06  norm(t1,t2) = 0.000134896
cycle = 9  E_corr(CCSD) = -0.117948030308266  dE = -1.50009079e-06  norm(t1,t2) = 4.50276e-05
cycle = 10  E_corr(CCSD) = -0.117947905214133  dE = 1.25094134e-07  norm(t1,t2) = 1.51899e-05
cycle = 11  E_corr(CCSD) = -0.1179478956396  dE = 9.57453264e-09  norm(t1,t2) = 5.4965e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.23298920083428  E_corr = -0.1179478956395999
cycle = 1  norm(lambda1,lambda2) = 0.192689
cycle = 2  norm(lambda1,lambda2) = 0.0496186
cycle = 3  norm(lambda1,lambda2) = 0.0211761
cycle = 4  norm(lambda1,lambda2) = 0.00787324
cycle = 5  norm(lambda1,lambda2) = 0.00341169
cycle = 6  norm(lambda1,lambda2) = 0.00129054
cycle = 7  norm(lambda1,lambda2) = 0.00036091
cycle = 8  norm(lambda1,lambda2) = 0.000126921
cycle = 9  norm(lambda1,lambda2) = 4.15073e-05
cycle = 10  norm(lambda1,lambda2) = 1.5067e-05
cycle = 11  norm(lambda1,lambda2) = 5.12236e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0053756868    -0.0000000034     0.0000000002
1 H    -0.0053756868     0.0000000034    -0.0000000002
----------------------------------------------
cycle 3: E = -25.2329892008  dE = -0.000308783  norm(grad) = 0.00760237

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.096379   0.000000   0.000000   -0.005360  0.000000 -0.000000
   H   1.096379  -0.000000  -0.000000    0.005360 -0.000000  0.000000
New geometry
   1 B     -0.096378980183   0.000000362020   0.000000026418 AA   -0.182129876712   0.000000684118   0.000000049924 Bohr

   2 H      1.096378980855  -0.000000362020  -0.000000026418 AA    2.071856002546  -0.000000684118  -0.000000049924 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 446 MB)
number electrons alpha = 5  beta = 2
init E= -25.1137430096148
  alpha nocc = 5  HOMO = -0.0342955709080917  LUMO = 0.275707831500424
  beta  nocc = 2  HOMO = -0.30376648614715  LUMO = 0.250917581886147
cycle= 1 E= -25.1150967020115  delta_E= -0.00135  |g|= 0.00132  |ddm|= 0.00406
  alpha nocc = 5  HOMO = -0.0331918237151486  LUMO = 0.276257534261894
  beta  nocc = 2  HOMO = -0.302778064872481  LUMO = 0.251495890865506
cycle= 2 E= -25.1150987567075  delta_E= -2.05e-06  |g|= 0.000414  |ddm|= 0.00163
  alpha nocc = 5  HOMO = -0.0334166908364202  LUMO = 0.276241884497722
  beta  nocc = 2  HOMO = -0.303211905325177  LUMO = 0.251448830467713
cycle= 3 E= -25.1150990440877  delta_E= -2.87e-07  |g|= 0.000182  |ddm|= 0.00073
  alpha nocc = 5  HOMO = -0.0333827176777134  LUMO = 0.276250085028943
  beta  nocc = 2  HOMO = -0.303069663109971  LUMO = 0.251459233478327
cycle= 4 E= -25.115099128755  delta_E= -8.47e-08  |g|= 6.49e-05  |ddm|= 0.000622
  alpha nocc = 5  HOMO = -0.0333930538972324  LUMO = 0.276247146724079
  beta  nocc = 2  HOMO = -0.303021547578579  LUMO = 0.251453345337205
cycle= 5 E= -25.1150991407819  delta_E= -1.2e-08  |g|= 2.33e-05  |ddm|= 0.000329
  alpha nocc = 5  HOMO = -0.0333868309861221  LUMO = 0.27625026776153
  beta  nocc = 2  HOMO = -0.303008878494058  LUMO = 0.251458515931162
cycle= 6 E= -25.1150991419508  delta_E= -1.17e-09  |g|= 6.45e-06  |ddm|= 0.000123
  alpha nocc = 5  HOMO = -0.0333890308799821  LUMO = 0.276249738633936
  beta  nocc = 2  HOMO = -0.303015614408056  LUMO = 0.251457690406708
cycle= 7 E= -25.1150991420426  delta_E= -9.19e-11  |g|= 2.2e-06  |ddm|= 2.22e-05
  alpha nocc = 5  HOMO = -0.0333891243274486  LUMO = 0.276249413857879
  beta  nocc = 2  HOMO = -0.3030179418395  LUMO = 0.25145723681203
cycle= 8 E= -25.1150991420598  delta_E= -1.72e-11  |g|= 6.14e-07  |ddm|= 1.46e-05
  alpha nocc = 5  HOMO = -0.0333891123362282  LUMO = 0.276249349428241
  beta  nocc = 2  HOMO = -0.303018124273225  LUMO = 0.251457141118064
Extra cycle  E= -25.1150991420606  delta_E= -8.03e-13  |g|= 3.61e-07  |ddm|= 1.55e-06
converged SCF energy = -25.1150991420606  <S^2> = 3.7534073  2S+1 = 4.0017033

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3532 MB)
Init E_corr(CCSD) = -0.0505948764754013
cycle = 1  E_corr(CCSD) = -0.108861653495274  dE = -0.058266777  norm(t1,t2) = 0.213433
cycle = 2  E_corr(CCSD) = -0.115025539948987  dE = -0.00616388645  norm(t1,t2) = 0.0629967
cycle = 3  E_corr(CCSD) = -0.117858299380277  dE = -0.00283275943  norm(t1,t2) = 0.0246731
cycle = 4  E_corr(CCSD) = -0.117838520706166  dE = 1.97786741e-05  norm(t1,t2) = 0.00664039
cycle = 5  E_corr(CCSD) = -0.117882354807001  dE = -4.38341008e-05  norm(t1,t2) = 0.00250169
cycle = 6  E_corr(CCSD) = -0.11793549972816  dE = -5.31449212e-05  norm(t1,t2) = 0.000959968
cycle = 7  E_corr(CCSD) = -0.117942293988697  dE = -6.79426054e-06  norm(t1,t2) = 0.000296542
cycle = 8  E_corr(CCSD) = -0.117946619962013  dE = -4.32597332e-06  norm(t1,t2) = 0.000121952
cycle = 9  E_corr(CCSD) = -0.11794776198571  dE = -1.1420237e-06  norm(t1,t2) = 4.0801e-05
cycle = 10  E_corr(CCSD) = -0.117947795596504  dE = -3.36107942e-08  norm(t1,t2) = 1.41831e-05
cycle = 11  E_corr(CCSD) = -0.117947980355029  dE = -1.84758525e-07  norm(t1,t2) = 5.32332e-06
cycle = 12  E_corr(CCSD) = -0.117948043963231  dE = -6.36082015e-08  norm(t1,t2) = 1.73629e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.23304718602387  E_corr = -0.1179480439632309
cycle = 1  norm(lambda1,lambda2) = 0.21433
cycle = 2  norm(lambda1,lambda2) = 0.0554662
cycle = 3  norm(lambda1,lambda2) = 0.0213523
cycle = 4  norm(lambda1,lambda2) = 0.006071
cycle = 5  norm(lambda1,lambda2) = 0.00241161
cycle = 6  norm(lambda1,lambda2) = 0.000860593
cycle = 7  norm(lambda1,lambda2) = 0.000269047
cycle = 8  norm(lambda1,lambda2) = 0.00011205
cycle = 9  norm(lambda1,lambda2) = 3.66058e-05
cycle = 10  norm(lambda1,lambda2) = 1.31348e-05
cycle = 11  norm(lambda1,lambda2) = 4.63122e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0004003296    -0.0000000002    -0.0000000000
1 H    -0.0004003296     0.0000000002     0.0000000000
----------------------------------------------
cycle 4: E = -25.233047186  dE = -5.79852e-05  norm(grad) = 0.000566152

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.096810   0.000000   0.000000   -0.000431  0.000000 -0.000000
   H   1.096810  -0.000000  -0.000000    0.000431 -0.000000  0.000000
New geometry
   1 B     -0.096810257299   0.000000364449   0.000000025593 AA   -0.182944872343   0.000000688709   0.000000048364 Bohr

   2 H      1.096810257946  -0.000000364449  -0.000000025593 AA    2.072670998132  -0.000000688709  -0.000000048364 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 457 MB)
number electrons alpha = 5  beta = 2
init E= -25.1149858267454
  alpha nocc = 5  HOMO = -0.0334849940739596  LUMO = 0.276221028713318
  beta  nocc = 2  HOMO = -0.302862167217168  LUMO = 0.251402131253177
cycle= 1 E= -25.1150993651973  delta_E= -0.000114  |g|= 0.000107  |ddm|= 0.000326
  alpha nocc = 5  HOMO = -0.0333949712662692  LUMO = 0.276265602189496
  beta  nocc = 2  HOMO = -0.302780882241112  LUMO = 0.25144915201611
cycle= 2 E= -25.1150993785642  delta_E= -1.34e-08  |g|= 3.33e-05  |ddm|= 0.000132
  alpha nocc = 5  HOMO = -0.0334133549008717  LUMO = 0.276264262157371
  beta  nocc = 2  HOMO = -0.302816126991655  LUMO = 0.251445234182538
cycle= 3 E= -25.1150993804224  delta_E= -1.86e-09  |g|= 1.47e-05  |ddm|= 5.87e-05
  alpha nocc = 5  HOMO = -0.0334106209327872  LUMO = 0.276264918875865
  beta  nocc = 2  HOMO = -0.302804740648287  LUMO = 0.251446073841136
cycle= 4 E= -25.1150993809738  delta_E= -5.51e-10  |g|= 5.25e-06  |ddm|= 5.01e-05
  alpha nocc = 5  HOMO = -0.0334114358319059  LUMO = 0.276264678799233
  beta  nocc = 2  HOMO = -0.302800796958996  LUMO = 0.251445598931039
cycle= 5 E= -25.1150993810527  delta_E= -7.89e-11  |g|= 1.88e-06  |ddm|= 2.66e-05
  alpha nocc = 5  HOMO = -0.0334109317398976  LUMO = 0.276264930611254
  beta  nocc = 2  HOMO = -0.302799774595028  LUMO = 0.251446016838001
cycle= 6 E= -25.1150993810603  delta_E= -7.67e-12  |g|= 5.23e-07  |ddm|= 9.94e-06
  alpha nocc = 5  HOMO = -0.0334111566752884  LUMO = 0.276264871004654
  beta  nocc = 2  HOMO = -0.30280028452007  LUMO = 0.251445917195418
Extra cycle  E= -25.1150993810608  delta_E= -4.09e-13  |g|= 2.76e-07  |ddm|= 1.36e-06
converged SCF energy = -25.1150993810608  <S^2> = 3.7534083  2S+1 = 4.0017038

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3543 MB)
Init E_corr(CCSD) = -0.0616621331819391
cycle = 1  E_corr(CCSD) = -0.111119523759461  dE = -0.0494573906  norm(t1,t2) = 0.200395
cycle = 2  E_corr(CCSD) = -0.11556795001068  dE = -0.00444842625  norm(t1,t2) = 0.0550813
cycle = 3  E_corr(CCSD) = -0.117845010613796  dE = -0.0022770606  norm(t1,t2) = 0.0221055
cycle = 4  E_corr(CCSD) = -0.117850469989577  dE = -5.45937578e-06  norm(t1,t2) = 0.00741301
cycle = 5  E_corr(CCSD) = -0.117890903218882  dE = -4.04332293e-05  norm(t1,t2) = 0.00302647
cycle = 6  E_corr(CCSD) = -0.117940226613288  dE = -4.93233944e-05  norm(t1,t2) = 0.00100474
cycle = 7  E_corr(CCSD) = -0.11794450372893  dE = -4.27711564e-06  norm(t1,t2) = 0.000247415
cycle = 8  E_corr(CCSD) = -0.117946289687154  dE = -1.78595822e-06  norm(t1,t2) = 9.78084e-05
cycle = 9  E_corr(CCSD) = -0.117947505909748  dE = -1.21622259e-06  norm(t1,t2) = 3.81335e-05
cycle = 10  E_corr(CCSD) = -0.117947899596353  dE = -3.93686605e-07  norm(t1,t2) = 1.36593e-05
cycle = 11  E_corr(CCSD) = -0.117948099287424  dE = -1.9969107e-07  norm(t1,t2) = 4.69336e-06
cycle = 12  E_corr(CCSD) = -0.117948133554762  dE = -3.42673381e-08  norm(t1,t2) = 1.43153e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.23304751461552  E_corr = -0.1179481335547618
cycle = 1  norm(lambda1,lambda2) = 0.197224
cycle = 2  norm(lambda1,lambda2) = 0.0503296
cycle = 3  norm(lambda1,lambda2) = 0.0197405
cycle = 4  norm(lambda1,lambda2) = 0.00689688
cycle = 5  norm(lambda1,lambda2) = 0.00294762
cycle = 6  norm(lambda1,lambda2) = 0.000892578
cycle = 7  norm(lambda1,lambda2) = 0.000235798
cycle = 8  norm(lambda1,lambda2) = 9.5352e-05
cycle = 9  norm(lambda1,lambda2) = 3.62127e-05
cycle = 10  norm(lambda1,lambda2) = 1.30588e-05
cycle = 11  norm(lambda1,lambda2) = 4.55048e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0000129236    -0.0000000000    -0.0000000000
1 H    -0.0000129236     0.0000000000     0.0000000000
----------------------------------------------
cycle 5: E = -25.2330475146  dE = -3.28592e-07  norm(grad) = 1.82767e-05
