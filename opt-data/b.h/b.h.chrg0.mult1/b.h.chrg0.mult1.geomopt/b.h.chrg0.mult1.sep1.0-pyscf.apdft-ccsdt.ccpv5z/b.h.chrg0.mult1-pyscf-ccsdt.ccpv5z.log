#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/b.h/b.h.chrg0.mult1/b.h.chrg0.mult1.geomopt/b.h.chrg0.mult1.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['B', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 0
multiplicity = 1
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n62.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:24 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 6
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 B      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 2.6458860546
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.16
Create scanner for <class 'pyscf.grad.ccsd.Gradients'>
Set <class 'pyscf.cc.ccsd.CCSD'> as a scanner
Create scanner for <class 'pyscf.scf.hf.RHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 B      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 147 MB)
init E= -25.01066233011
  HOMO = -0.165815601357328  LUMO = -0.00327050733411681
cycle= 1 E= -25.0891027509641  delta_E= -0.0784  |g|= 0.169  |ddm|= 1.08
  HOMO = -0.359072473284657  LUMO = 0.0242219814701122
cycle= 2 E= -25.1027367250561  delta_E= -0.0136  |g|= 0.0408  |ddm|= 0.55
  HOMO = -0.33985142187816  LUMO = 0.0408384602952953
cycle= 3 E= -25.1037853843954  delta_E= -0.00105  |g|= 0.0101  |ddm|= 0.153
  HOMO = -0.341853938530775  LUMO = 0.0395319980709168
cycle= 4 E= -25.1038874666716  delta_E= -0.000102  |g|= 0.00183  |ddm|= 0.0507
  HOMO = -0.341863348477643  LUMO = 0.0393428108708518
cycle= 5 E= -25.103892280587  delta_E= -4.81e-06  |g|= 0.000261  |ddm|= 0.0102
  HOMO = -0.341902893375441  LUMO = 0.0393080930771826
cycle= 6 E= -25.1038923751613  delta_E= -9.46e-08  |g|= 3.65e-05  |ddm|= 0.00234
  HOMO = -0.341906200645125  LUMO = 0.0393030375269368
cycle= 7 E= -25.1038923761196  delta_E= -9.58e-10  |g|= 3.59e-06  |ddm|= 0.000635
  HOMO = -0.341906809666435  LUMO = 0.0393024356111214
cycle= 8 E= -25.1038923761277  delta_E= -8.02e-12  |g|= 3.64e-07  |ddm|= 2.08e-05
  HOMO = -0.341906851741909  LUMO = 0.0393023368628019
Extra cycle  E= -25.1038923761278  delta_E= -1.14e-13  |g|= 1.1e-07  |ddm|= 7.68e-06
converged SCF energy = -25.1038923761278

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1540 MB)
Init t2, MP2 energy = -25.2129598567894  E_corr(MP2) -0.109067480661647
Init E_corr(CCSD) = -0.109067480661655
cycle = 1  E_corr(CCSD) = -0.122457572964065  dE = -0.0133900923  norm(t1,t2) = 0.0462894
cycle = 2  E_corr(CCSD) = -0.127385606167696  dE = -0.0049280332  norm(t1,t2) = 0.0263619
cycle = 3  E_corr(CCSD) = -0.132309717629807  dE = -0.00492411146  norm(t1,t2) = 0.0164578
cycle = 4  E_corr(CCSD) = -0.132141823756516  dE = 0.000167893873  norm(t1,t2) = 0.00367608
cycle = 5  E_corr(CCSD) = -0.132058240663425  dE = 8.35830931e-05  norm(t1,t2) = 0.00104611
cycle = 6  E_corr(CCSD) = -0.132098359185669  dE = -4.01185222e-05  norm(t1,t2) = 0.000431594
cycle = 7  E_corr(CCSD) = -0.132090867523633  dE = 7.49166204e-06  norm(t1,t2) = 0.000100516
cycle = 8  E_corr(CCSD) = -0.132091189258467  dE = -3.21734834e-07  norm(t1,t2) = 3.09442e-05
cycle = 9  E_corr(CCSD) = -0.132092306310911  dE = -1.11705244e-06  norm(t1,t2) = 7.21171e-06
cycle = 10  E_corr(CCSD) = -0.132091903383809  dE = 4.02927102e-07  norm(t1,t2) = 2.44976e-06
cycle = 11  E_corr(CCSD) = -0.132091872013146  dE = 3.13706632e-08  norm(t1,t2) = 4.84843e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -25.23598424814093  E_corr = -0.1320918720131458
cycle = 1  norm(lambda1,lambda2) = 0.0101136
cycle = 2  norm(lambda1,lambda2) = 0.00322491
cycle = 3  norm(lambda1,lambda2) = 0.00182485
cycle = 4  norm(lambda1,lambda2) = 0.000617309
cycle = 5  norm(lambda1,lambda2) = 0.000220917
cycle = 6  norm(lambda1,lambda2) = 6.99479e-05
cycle = 7  norm(lambda1,lambda2) = 2.12603e-05
cycle = 8  norm(lambda1,lambda2) = 6.58538e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.1594440622     0.0000000000     0.0000000000
1 H    -0.1594440623    -0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -25.2359842481  dE = -25.236  norm(grad) = 0.225488

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.088464  -0.000000  -0.000000   -0.088464 -0.000000 -0.000000
   H   1.088464   0.000000   0.000000    0.088464  0.000000  0.000000
New geometry
   1 B     -0.088464162821  -0.000000000000  -0.000000000000 AA   -0.167173039571  -0.000000000000  -0.000000000000 Bohr

   2 H      1.088464163195   0.000000000000   0.000000000000 AA    2.056899164842   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 300 MB)
init E= -25.0793922373324
  HOMO = -0.358048945113835  LUMO = 0.0363659852586213
cycle= 1 E= -25.1302978274978  delta_E= -0.0509  |g|= 0.0325  |ddm|= 0.0903
  HOMO = -0.346768965278151  LUMO = 0.0385347621293789
cycle= 2 E= -25.1307823057104  delta_E= -0.000484  |g|= 0.00819  |ddm|= 0.0316
  HOMO = -0.346559816733298  LUMO = 0.0380659641273391
cycle= 3 E= -25.1308378264776  delta_E= -5.55e-05  |g|= 0.00212  |ddm|= 0.0164
  HOMO = -0.346669789540893  LUMO = 0.03804689024073
cycle= 4 E= -25.1308433483793  delta_E= -5.52e-06  |g|= 0.00031  |ddm|= 0.00806
  HOMO = -0.346635652716243  LUMO = 0.0380853538465523
cycle= 5 E= -25.1308434832166  delta_E= -1.35e-07  |g|= 3.14e-05  |ddm|= 0.00185
  HOMO = -0.34664268164304  LUMO = 0.0380845054793389
cycle= 6 E= -25.1308434841342  delta_E= -9.18e-10  |g|= 5.65e-06  |ddm|= 0.000202
  HOMO = -0.346641567456549  LUMO = 0.038085818507426
cycle= 7 E= -25.1308434841581  delta_E= -2.38e-11  |g|= 7.68e-07  |ddm|= 3.41e-05
  HOMO = -0.346641685993253  LUMO = 0.0380857594162058
Extra cycle  E= -25.1308434841586  delta_E= -5.12e-13  |g|= 2.7e-07  |ddm|= 4.09e-06
converged SCF energy = -25.1308434841586

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1686 MB)
Init E_corr(CCSD) = -0.0560327612618936
cycle = 1  E_corr(CCSD) = -0.118187147266769  dE = -0.062154386  norm(t1,t2) = 0.171525
cycle = 2  E_corr(CCSD) = -0.126144405156871  dE = -0.00795725789  norm(t1,t2) = 0.0437222
cycle = 3  E_corr(CCSD) = -0.130556163497313  dE = -0.00441175834  norm(t1,t2) = 0.019356
cycle = 4  E_corr(CCSD) = -0.131496475504696  dE = -0.000940312007  norm(t1,t2) = 0.00737734
cycle = 5  E_corr(CCSD) = -0.131693357654091  dE = -0.000196882149  norm(t1,t2) = 0.00326442
cycle = 6  E_corr(CCSD) = -0.131789608857781  dE = -9.62512037e-05  norm(t1,t2) = 0.00115328
cycle = 7  E_corr(CCSD) = -0.13179274830229  dE = -3.13944451e-06  norm(t1,t2) = 0.000379595
cycle = 8  E_corr(CCSD) = -0.131786267359833  dE = 6.48094246e-06  norm(t1,t2) = 0.00014888
cycle = 9  E_corr(CCSD) = -0.131785217287577  dE = 1.05007226e-06  norm(t1,t2) = 4.91322e-05
cycle = 10  E_corr(CCSD) = -0.131783520187838  dE = 1.69709974e-06  norm(t1,t2) = 1.88316e-05
cycle = 11  E_corr(CCSD) = -0.131782880254099  dE = 6.3993374e-07  norm(t1,t2) = 8.29352e-06
cycle = 12  E_corr(CCSD) = -0.131782959005934  dE = -7.87518351e-08  norm(t1,t2) = 3.35821e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.26262644316452  E_corr = -0.1317829590059337
cycle = 1  norm(lambda1,lambda2) = 0.166855
cycle = 2  norm(lambda1,lambda2) = 0.0407419
cycle = 3  norm(lambda1,lambda2) = 0.0172046
cycle = 4  norm(lambda1,lambda2) = 0.00747215
cycle = 5  norm(lambda1,lambda2) = 0.00317034
cycle = 6  norm(lambda1,lambda2) = 0.00102907
cycle = 7  norm(lambda1,lambda2) = 0.000378682
cycle = 8  norm(lambda1,lambda2) = 0.00013366
cycle = 9  norm(lambda1,lambda2) = 4.47453e-05
cycle = 10  norm(lambda1,lambda2) = 1.80125e-05
cycle = 11  norm(lambda1,lambda2) = 7.67309e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0193727064     0.0000001876    -0.0000000450
1 H    -0.0193727064    -0.0000001876     0.0000000450
----------------------------------------------
cycle 2: E = -25.2626264432  dE = -0.0266422  norm(grad) = 0.0273971

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.100699  -0.000006   0.000002   -0.012235 -0.000006  0.000002
   H   1.100699   0.000006  -0.000002    0.012235  0.000006 -0.000002
New geometry
   1 B     -0.100699285789  -0.000006262040   0.000001503253 AA   -0.190294071080  -0.000011833541   0.000002840736 Bohr

   2 H      1.100699286159   0.000006262040  -0.000001503253 AA    2.080020196345   0.000011833541  -0.000002840736 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 326 MB)
init E= -25.1248374537556
  HOMO = -0.349277337111724  LUMO = 0.037237799187992
cycle= 1 E= -25.1314664869709  delta_E= -0.00663  |g|= 0.00433  |ddm|= 0.0134
  HOMO = -0.34729547942758  LUMO = 0.0379408940191549
cycle= 2 E= -25.1314754372747  delta_E= -8.95e-06  |g|= 0.00107  |ddm|= 0.00421
  HOMO = -0.347317623660336  LUMO = 0.0378385295988056
cycle= 3 E= -25.1314764155497  delta_E= -9.78e-07  |g|= 0.000291  |ddm|= 0.00225
  HOMO = -0.347328685485953  LUMO = 0.0378378772883772
cycle= 4 E= -25.1314765195922  delta_E= -1.04e-07  |g|= 4.35e-05  |ddm|= 0.00112
  HOMO = -0.347325053769639  LUMO = 0.0378426247752786
cycle= 5 E= -25.1314765222425  delta_E= -2.65e-09  |g|= 3.83e-06  |ddm|= 0.000259
  HOMO = -0.347325724165847  LUMO = 0.0378426705221876
cycle= 6 E= -25.1314765222558  delta_E= -1.33e-11  |g|= 6.59e-07  |ddm|= 2.43e-05
  HOMO = -0.347325627321662  LUMO = 0.0378427731991712
Extra cycle  E= -25.1314765222562  delta_E= -3.48e-13  |g|= 2.55e-07  |ddm|= 2.89e-06
converged SCF energy = -25.1314765222562

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1701 MB)
Init E_corr(CCSD) = -0.0806078626748925
cycle = 1  E_corr(CCSD) = -0.123153025130023  dE = -0.0425451625  norm(t1,t2) = 0.151495
cycle = 2  E_corr(CCSD) = -0.127953060554737  dE = -0.00480003542  norm(t1,t2) = 0.0348794
cycle = 3  E_corr(CCSD) = -0.130634936894307  dE = -0.00268187634  norm(t1,t2) = 0.0169936
cycle = 4  E_corr(CCSD) = -0.131700949971242  dE = -0.00106601308  norm(t1,t2) = 0.00844109
cycle = 5  E_corr(CCSD) = -0.131789226315326  dE = -8.82763441e-05  norm(t1,t2) = 0.00336218
cycle = 6  E_corr(CCSD) = -0.131801021136459  dE = -1.17948211e-05  norm(t1,t2) = 0.00103521
cycle = 7  E_corr(CCSD) = -0.131789524491126  dE = 1.14966453e-05  norm(t1,t2) = 0.000398555
cycle = 8  E_corr(CCSD) = -0.131779305674576  dE = 1.02188165e-05  norm(t1,t2) = 0.000152599
cycle = 9  E_corr(CCSD) = -0.131778498774712  dE = 8.06899865e-07  norm(t1,t2) = 4.35383e-05
cycle = 10  E_corr(CCSD) = -0.131778055753758  dE = 4.43020954e-07  norm(t1,t2) = 1.6994e-05
cycle = 11  E_corr(CCSD) = -0.13177778941101  dE = 2.66342748e-07  norm(t1,t2) = 7.45007e-06
cycle = 12  E_corr(CCSD) = -0.131777752891652  dE = 3.65193579e-08  norm(t1,t2) = 2.41547e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.26325427514782  E_corr = -0.1317777528916516
cycle = 1  norm(lambda1,lambda2) = 0.145231
cycle = 2  norm(lambda1,lambda2) = 0.0331958
cycle = 3  norm(lambda1,lambda2) = 0.0154629
cycle = 4  norm(lambda1,lambda2) = 0.00809213
cycle = 5  norm(lambda1,lambda2) = 0.00308621
cycle = 6  norm(lambda1,lambda2) = 0.00092387
cycle = 7  norm(lambda1,lambda2) = 0.000379413
cycle = 8  norm(lambda1,lambda2) = 0.000137601
cycle = 9  norm(lambda1,lambda2) = 4.13816e-05
cycle = 10  norm(lambda1,lambda2) = 1.65692e-05
cycle = 11  norm(lambda1,lambda2) = 7.03391e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0080288025     0.0000000617    -0.0000000082
1 H    -0.0080288025    -0.0000000617     0.0000000082
----------------------------------------------
cycle 3: E = -25.2632542751  dE = -0.000627832  norm(grad) = 0.0113544

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.109359  -0.000006   0.000001   -0.008660  0.000001 -0.000000
   H   1.109359   0.000006  -0.000001    0.008660 -0.000001  0.000000
New geometry
   1 B     -0.109358860841  -0.000005660002   0.000001016472 AA   -0.206658296284  -0.000010695854   0.000001920854 Bohr

   2 H      1.109358861030   0.000005660002  -0.000001016472 AA    2.096384421206   0.000010695854  -0.000001920854 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 328 MB)
init E= -25.1270568933632
  HOMO = -0.349231428274506  LUMO = 0.0371767685994499
cycle= 1 E= -25.1316089145391  delta_E= -0.00455  |g|= 0.00305  |ddm|= 0.00943
  HOMO = -0.347776430347442  LUMO = 0.0377317128829963
cycle= 2 E= -25.1316133708688  delta_E= -4.46e-06  |g|= 0.000751  |ddm|= 0.00295
  HOMO = -0.347796795873356  LUMO = 0.037656589143746
cycle= 3 E= -25.1316138549378  delta_E= -4.84e-07  |g|= 0.000206  |ddm|= 0.00158
  HOMO = -0.347805244734562  LUMO = 0.0376551167258619
cycle= 4 E= -25.1316139073002  delta_E= -5.24e-08  |g|= 3.09e-05  |ddm|= 0.000798
  HOMO = -0.347802439876176  LUMO = 0.0376585682894773
cycle= 5 E= -25.1316139086326  delta_E= -1.33e-09  |g|= 2.66e-06  |ddm|= 0.000183
  HOMO = -0.347802947922971  LUMO = 0.0376585702937719
cycle= 6 E= -25.131613908639  delta_E= -6.41e-12  |g|= 4.61e-07  |ddm|= 1.64e-05
  HOMO = -0.347802874140743  LUMO = 0.0376586478690331
Extra cycle  E= -25.131613908639  delta_E= -6.39e-14  |g|= 1.72e-07  |ddm|= 2.04e-06
converged SCF energy = -25.131613908639

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1702 MB)
Init E_corr(CCSD) = -0.0963617975713496
cycle = 1  E_corr(CCSD) = -0.124994424003126  dE = -0.0286326264  norm(t1,t2) = 0.139436
cycle = 2  E_corr(CCSD) = -0.128497836382523  dE = -0.00350341238  norm(t1,t2) = 0.0310055
cycle = 3  E_corr(CCSD) = -0.130883980274838  dE = -0.00238614389  norm(t1,t2) = 0.0151195
cycle = 4  E_corr(CCSD) = -0.131680000499901  dE = -0.000796020225  norm(t1,t2) = 0.00673547
cycle = 5  E_corr(CCSD) = -0.131782913215153  dE = -0.000102912715  norm(t1,t2) = 0.00269699
cycle = 6  E_corr(CCSD) = -0.131800329590878  dE = -1.74163757e-05  norm(t1,t2) = 0.00089617
cycle = 7  E_corr(CCSD) = -0.131792358235493  dE = 7.97135538e-06  norm(t1,t2) = 0.00031728
cycle = 8  E_corr(CCSD) = -0.13178615656649  dE = 6.201669e-06  norm(t1,t2) = 0.000125888
cycle = 9  E_corr(CCSD) = -0.131784832652904  dE = 1.32391359e-06  norm(t1,t2) = 3.65894e-05
cycle = 10  E_corr(CCSD) = -0.131784332658338  dE = 4.99994566e-07  norm(t1,t2) = 1.3851e-05
cycle = 11  E_corr(CCSD) = -0.131784161638186  dE = 1.71020152e-07  norm(t1,t2) = 6.08965e-06
cycle = 12  E_corr(CCSD) = -0.131784122120722  dE = 3.95174645e-08  norm(t1,t2) = 1.92631e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.26339803075976  E_corr = -0.1317841221207216
cycle = 1  norm(lambda1,lambda2) = 0.133034
cycle = 2  norm(lambda1,lambda2) = 0.0292068
cycle = 3  norm(lambda1,lambda2) = 0.0137921
cycle = 4  norm(lambda1,lambda2) = 0.00651199
cycle = 5  norm(lambda1,lambda2) = 0.00251755
cycle = 6  norm(lambda1,lambda2) = 0.000799924
cycle = 7  norm(lambda1,lambda2) = 0.000303383
cycle = 8  norm(lambda1,lambda2) = 0.000115096
cycle = 9  norm(lambda1,lambda2) = 3.39774e-05
cycle = 10  norm(lambda1,lambda2) = 1.34633e-05
cycle = 11  norm(lambda1,lambda2) = 5.80001e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0008707474     0.0000000104    -0.0000000038
1 H    -0.0008707474    -0.0000000104     0.0000000038
----------------------------------------------
cycle 4: E = -25.2633980308  dE = -0.000143756  norm(grad) = 0.00123142

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.110412  -0.000006   0.000001   -0.001053 -0.000000  0.000000
   H   1.110412   0.000006  -0.000001    0.001053  0.000000 -0.000000
New geometry
   1 B     -0.110412261862  -0.000005750249   0.000001083208 AA   -0.208648935714  -0.000010866395   0.000002046966 Bohr

   2 H      1.110412261997   0.000005750249  -0.000001083208 AA    2.098375060533   0.000010866395  -0.000002046966 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 333 MB)
init E= -25.1310681825497
  HOMO = -0.348035445974018  LUMO = 0.037575073994555
cycle= 1 E= -25.1316142239768  delta_E= -0.000546  |g|= 0.000369  |ddm|= 0.00114
  HOMO = -0.34785700950194  LUMO = 0.0376445904307038
cycle= 2 E= -25.1316142896628  delta_E= -6.57e-08  |g|= 9.08e-05  |ddm|= 0.000359
  HOMO = -0.347859670637433  LUMO = 0.0376353238329148
cycle= 3 E= -25.1316142967541  delta_E= -7.09e-09  |g|= 2.5e-05  |ddm|= 0.000192
  HOMO = -0.347860714929382  LUMO = 0.0376351323631168
cycle= 4 E= -25.1316142975282  delta_E= -7.74e-10  |g|= 3.77e-06  |ddm|= 9.72e-05
  HOMO = -0.347860370755804  LUMO = 0.0376355560182391
cycle= 5 E= -25.131614297548  delta_E= -1.98e-11  |g|= 3.17e-07  |ddm|= 2.23e-05
  HOMO = -0.347860422414141  LUMO = 0.0376355518867847
Extra cycle  E= -25.1316142975481  delta_E= -8.88e-14  |g|= 1.11e-07  |ddm|= 1.42e-06
converged SCF energy = -25.1316142975481

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1709 MB)
Init E_corr(CCSD) = -0.108131389698733
cycle = 1  E_corr(CCSD) = -0.128691935932105  dE = -0.0205605462  norm(t1,t2) = 0.0820498
cycle = 2  E_corr(CCSD) = -0.130504877445603  dE = -0.00181294151  norm(t1,t2) = 0.019105
cycle = 3  E_corr(CCSD) = -0.131536175775698  dE = -0.00103129833  norm(t1,t2) = 0.00685185
cycle = 4  E_corr(CCSD) = -0.131673292143468  dE = -0.000137116368  norm(t1,t2) = 0.0022407
cycle = 5  E_corr(CCSD) = -0.13174706148485  dE = -7.37693414e-05  norm(t1,t2) = 0.00111839
cycle = 6  E_corr(CCSD) = -0.131785052355178  dE = -3.79908703e-05  norm(t1,t2) = 0.000435294
cycle = 7  E_corr(CCSD) = -0.131788139050229  dE = -3.08669505e-06  norm(t1,t2) = 0.000138139
cycle = 8  E_corr(CCSD) = -0.131787330041317  dE = 8.09008912e-07  norm(t1,t2) = 5.6258e-05
cycle = 9  E_corr(CCSD) = -0.13178623922783  dE = 1.09081349e-06  norm(t1,t2) = 1.78665e-05
cycle = 10  E_corr(CCSD) = -0.131785693001186  dE = 5.46226644e-07  norm(t1,t2) = 6.24741e-06
cycle = 11  E_corr(CCSD) = -0.13178555378493  dE = 1.39216256e-07  norm(t1,t2) = 2.57122e-06
cycle = 12  E_corr(CCSD) = -0.131785529581248  dE = 2.4203682e-08  norm(t1,t2) = 9.36465e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -25.26339982712939  E_corr = -0.1317855295812481
cycle = 1  norm(lambda1,lambda2) = 0.0780745
cycle = 2  norm(lambda1,lambda2) = 0.0176532
cycle = 3  norm(lambda1,lambda2) = 0.00635929
cycle = 4  norm(lambda1,lambda2) = 0.00224448
cycle = 5  norm(lambda1,lambda2) = 0.00113459
cycle = 6  norm(lambda1,lambda2) = 0.000410696
cycle = 7  norm(lambda1,lambda2) = 0.000133558
cycle = 8  norm(lambda1,lambda2) = 5.45302e-05
cycle = 9  norm(lambda1,lambda2) = 1.72409e-05
cycle = 10  norm(lambda1,lambda2) = 6.16502e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0000460504    -0.0000000001     0.0000000003
1 H    -0.0000460504     0.0000000001    -0.0000000003
----------------------------------------------
cycle 5: E = -25.2633998271  dE = -1.79637e-06  norm(grad) = 6.51251e-05

Geometry optimization cycle 6
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.110471  -0.000006   0.000001   -0.000059  0.000000 -0.000000
   H   1.110471   0.000006  -0.000001    0.000059 -0.000000  0.000000
New geometry
   1 B     -0.110471082994  -0.000005732851   0.000001069316 AA   -0.208760091542  -0.000010833518   0.000002020715 Bohr

   2 H      1.110471083013   0.000005732851  -0.000001069316 AA    2.098486216143   0.000010833518  -0.000002020715 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 334 MB)
init E= -25.1315837745398
  HOMO = -0.347873411969833  LUMO = 0.0376308794554693
cycle= 1 E= -25.1316142180243  delta_E= -3.04e-05  |g|= 2.06e-05  |ddm|= 6.39e-05
  HOMO = -0.34786344148462  LUMO = 0.0376347756249125
cycle= 2 E= -25.1316142182293  delta_E= -2.05e-10  |g|= 5.08e-06  |ddm|= 2.01e-05
  HOMO = -0.347863591474022  LUMO = 0.0376342587330123
cycle= 3 E= -25.1316142182516  delta_E= -2.23e-11  |g|= 1.4e-06  |ddm|= 1.08e-05
  HOMO = -0.347863649999998  LUMO = 0.0376342485353584
cycle= 4 E= -25.1316142182539  delta_E= -2.34e-12  |g|= 2.11e-07  |ddm|= 5.46e-06
  HOMO = -0.347863633659458  LUMO = 0.0376342673384525
Extra cycle  E= -25.131614218254  delta_E= -4.97e-14  |g|= 9.15e-08  |ddm|= 7.78e-07
converged SCF energy = -25.131614218254

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1711 MB)
Init E_corr(CCSD) = -0.122357776873857
cycle = 1  E_corr(CCSD) = -0.13027577573748  dE = -0.00791799886  norm(t1,t2) = 0.056521
cycle = 2  E_corr(CCSD) = -0.131038725961602  dE = -0.000762950224  norm(t1,t2) = 0.0179192
cycle = 3  E_corr(CCSD) = -0.131632650417965  dE = -0.000593924456  norm(t1,t2) = 0.00768417
cycle = 4  E_corr(CCSD) = -0.13170823612319  dE = -7.55857052e-05  norm(t1,t2) = 0.00173953
cycle = 5  E_corr(CCSD) = -0.131755374318623  dE = -4.71381954e-05  norm(t1,t2) = 0.000638722
cycle = 6  E_corr(CCSD) = -0.131777545360286  dE = -2.21710417e-05  norm(t1,t2) = 0.000223633
cycle = 7  E_corr(CCSD) = -0.131783020323098  dE = -5.47496281e-06  norm(t1,t2) = 8.06373e-05
cycle = 8  E_corr(CCSD) = -0.131785416221979  dE = -2.39589888e-06  norm(t1,t2) = 3.42283e-05
cycle = 9  E_corr(CCSD) = -0.131785673442328  dE = -2.57220349e-07  norm(t1,t2) = 8.24464e-06
cycle = 10  E_corr(CCSD) = -0.131785638799197  dE = 3.46431315e-08  norm(t1,t2) = 2.00059e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.2633998570532  E_corr = -0.1317856387991969
cycle = 1  norm(lambda1,lambda2) = 0.0533188
cycle = 2  norm(lambda1,lambda2) = 0.0166089
cycle = 3  norm(lambda1,lambda2) = 0.00710004
cycle = 4  norm(lambda1,lambda2) = 0.00166246
cycle = 5  norm(lambda1,lambda2) = 0.000625967
cycle = 6  norm(lambda1,lambda2) = 0.00022142
cycle = 7  norm(lambda1,lambda2) = 7.98389e-05
cycle = 8  norm(lambda1,lambda2) = 3.30473e-05
cycle = 9  norm(lambda1,lambda2) = 7.83956e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0000004296     0.0000000002    -0.0000000002
1 H    -0.0000004296    -0.0000000002     0.0000000002
----------------------------------------------
cycle 6: E = -25.2633998571  dE = -2.99238e-08  norm(grad) = 6.07533e-07
