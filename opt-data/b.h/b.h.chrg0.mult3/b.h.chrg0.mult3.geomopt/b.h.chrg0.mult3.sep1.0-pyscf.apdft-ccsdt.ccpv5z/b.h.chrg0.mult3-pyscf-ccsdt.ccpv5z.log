#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/b.h/b.h.chrg0.mult3/b.h.chrg0.mult3.geomopt/b.h.chrg0.mult3.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['B', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 0
multiplicity = 3
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n74.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 6
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 B      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 2.6458860546
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         2.77
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 B      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 147 MB)
number electrons alpha = 4  beta = 2
init E= -25.01066233011

WARN: alpha nocc = 4  HOMO -0.00327050733411415 >= LUMO -0.00327050733411079

  beta  nocc = 2  HOMO = -0.760690679000594  LUMO = -0.165815601357329

WARN: system HOMO -0.00327050733411415 >= system LUMO -0.165815601357329

cycle= 1 E= -25.0262574084711  delta_E= -0.0156  |g|= 0.183  |ddm|= 0.81
  alpha nocc = 4  HOMO = -0.324160994152894  LUMO = -0.0301839303566939
  beta  nocc = 2  HOMO = -0.707037494105825  LUMO = -0.0338885368842817
cycle= 2 E= -25.0835426027366  delta_E= -0.0573  |g|= 0.0766  |ddm|= 0.439
  alpha nocc = 4  HOMO = -0.310367276036152  LUMO = 0.0222480863726945
  beta  nocc = 2  HOMO = -0.635983037460262  LUMO = 0.0338238052659315
cycle= 3 E= -25.0938350469481  delta_E= -0.0103  |g|= 0.0368  |ddm|= 0.124
  alpha nocc = 4  HOMO = -0.32055745345848  LUMO = 0.0293359586429115
  beta  nocc = 2  HOMO = -0.634983752273397  LUMO = 0.0472782151023932
cycle= 4 E= -25.0973077712665  delta_E= -0.00347  |g|= 0.0108  |ddm|= 0.0894
  alpha nocc = 4  HOMO = -0.320751666350664  LUMO = 0.0275455239529626
  beta  nocc = 2  HOMO = -0.636154647024219  LUMO = 0.0446334079431338
cycle= 5 E= -25.0975299005297  delta_E= -0.000222  |g|= 0.00264  |ddm|= 0.0186
  alpha nocc = 4  HOMO = -0.322150767827935  LUMO = 0.0280988114946563
  beta  nocc = 2  HOMO = -0.636503271793076  LUMO = 0.0459654717941651
cycle= 6 E= -25.0975383186647  delta_E= -8.42e-06  |g|= 0.000516  |ddm|= 0.00526
  alpha nocc = 4  HOMO = -0.321867228110553  LUMO = 0.0281344354292662
  beta  nocc = 2  HOMO = -0.636531833884172  LUMO = 0.0459348979877505
cycle= 7 E= -25.0975387132024  delta_E= -3.95e-07  |g|= 0.000175  |ddm|= 0.000946
  alpha nocc = 4  HOMO = -0.321822039441618  LUMO = 0.0281018721374299
  beta  nocc = 2  HOMO = -0.636594123333024  LUMO = 0.0458888079222896
cycle= 8 E= -25.0975387673021  delta_E= -5.41e-08  |g|= 2.57e-05  |ddm|= 0.000429
  alpha nocc = 4  HOMO = -0.321827977538679  LUMO = 0.0281011639177026
  beta  nocc = 2  HOMO = -0.636593625551572  LUMO = 0.0458908222398184
cycle= 9 E= -25.0975387685883  delta_E= -1.29e-09  |g|= 5.22e-06  |ddm|= 8.23e-05
  alpha nocc = 4  HOMO = -0.321824681432062  LUMO = 0.02809947488607
  beta  nocc = 2  HOMO = -0.636593775057856  LUMO = 0.0458882966617447
cycle= 10 E= -25.0975387686283  delta_E= -4e-11  |g|= 8.32e-07  |ddm|= 1.83e-05
  alpha nocc = 4  HOMO = -0.321824644354695  LUMO = 0.0280996657722689
  beta  nocc = 2  HOMO = -0.636593357693522  LUMO = 0.0458884717561245
Extra cycle  E= -25.0975387686291  delta_E= -8.6e-13  |g|= 3.65e-07  |ddm|= 1.85e-06
converged SCF energy = -25.0975387686291  <S^2> = 2.0024656  2S+1 = 3.0016433

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3343 MB)
Init t2, MP2 energy = -0.0843398797005735
Init E_corr(CCSD) = -0.084339879700683
cycle = 1  E_corr(CCSD) = -0.093878926725444  dE = -0.00953904702  norm(t1,t2) = 0.0348592
cycle = 2  E_corr(CCSD) = -0.0964123678935282  dE = -0.00253344117  norm(t1,t2) = 0.01518
cycle = 3  E_corr(CCSD) = -0.0979773979991811  dE = -0.00156503011  norm(t1,t2) = 0.00865849
cycle = 4  E_corr(CCSD) = -0.0979092360124928  dE = 6.81619867e-05  norm(t1,t2) = 0.00281392
cycle = 5  E_corr(CCSD) = -0.0979278075362475  dE = -1.85715238e-05  norm(t1,t2) = 0.000592311
cycle = 6  E_corr(CCSD) = -0.0979329790121005  dE = -5.17147585e-06  norm(t1,t2) = 0.000148193
cycle = 7  E_corr(CCSD) = -0.0979318386935343  dE = 1.14031857e-06  norm(t1,t2) = 5.12505e-05
cycle = 8  E_corr(CCSD) = -0.0979320419105075  dE = -2.03216973e-07  norm(t1,t2) = 1.19222e-05
cycle = 9  E_corr(CCSD) = -0.097932091692375  dE = -4.97818676e-08  norm(t1,t2) = 3.83621e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.19547086032152  E_corr = -0.09793209169237503
cycle = 1  norm(lambda1,lambda2) = 0.00516033
cycle = 2  norm(lambda1,lambda2) = 0.00125296
cycle = 3  norm(lambda1,lambda2) = 0.000531953
cycle = 4  norm(lambda1,lambda2) = 0.00017237
cycle = 5  norm(lambda1,lambda2) = 6.98307e-05
cycle = 6  norm(lambda1,lambda2) = 2.00361e-05
cycle = 7  norm(lambda1,lambda2) = 4.39787e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.1441145061     0.0000000000    -0.0000000000
1 H    -0.1441145061    -0.0000000000     0.0000000000
----------------------------------------------
cycle 1: E = -25.1954708603  dE = -25.1955  norm(grad) = 0.203809

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.079959  -0.000000   0.000000   -0.079959 -0.000000  0.000000
   H   1.079959   0.000000  -0.000000    0.079959  0.000000 -0.000000
New geometry
   1 B     -0.079958883064  -0.000000000000   0.000000000000 AA   -0.151100390217  -0.000000000000   0.000000000000 Bohr

   2 H      1.079958883416   0.000000000000  -0.000000000000 AA    2.040826515447   0.000000000000  -0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 400 MB)
number electrons alpha = 4  beta = 2
init E= -25.0913175514764
  alpha nocc = 4  HOMO = -0.336839969864129  LUMO = 0.0122951772155566
  beta  nocc = 2  HOMO = -0.597772650437004  LUMO = 0.0291629752251504
cycle= 1 E= -25.1177836286959  delta_E= -0.0265  |g|= 0.0198  |ddm|= 0.0456
  alpha nocc = 4  HOMO = -0.321412471917657  LUMO = 0.0282043967394075
  beta  nocc = 2  HOMO = -0.587158042749082  LUMO = 0.0409261238344211
cycle= 2 E= -25.1181760649269  delta_E= -0.000392  |g|= 0.00563  |ddm|= 0.0143
  alpha nocc = 4  HOMO = -0.323489279845171  LUMO = 0.026971076292232
  beta  nocc = 2  HOMO = -0.591573811395543  LUMO = 0.0400072266359896
cycle= 3 E= -25.1182275118178  delta_E= -5.14e-05  |g|= 0.00244  |ddm|= 0.00595
  alpha nocc = 4  HOMO = -0.323596089107315  LUMO = 0.0271929966640772
  beta  nocc = 2  HOMO = -0.590604277027649  LUMO = 0.0398175084857741
cycle= 4 E= -25.1182432484305  delta_E= -1.57e-05  |g|= 0.000865  |ddm|= 0.00483
  alpha nocc = 4  HOMO = -0.323548666569071  LUMO = 0.0272921317624571
  beta  nocc = 2  HOMO = -0.590209016883899  LUMO = 0.0398068462730138
cycle= 5 E= -25.1182450304128  delta_E= -1.78e-06  |g|= 0.000232  |ddm|= 0.00236
  alpha nocc = 4  HOMO = -0.323488908765978  LUMO = 0.0272945501231391
  beta  nocc = 2  HOMO = -0.590250751341746  LUMO = 0.0398289955843048
cycle= 6 E= -25.1182451265634  delta_E= -9.62e-08  |g|= 4.52e-05  |ddm|= 0.000483
  alpha nocc = 4  HOMO = -0.323485103417787  LUMO = 0.0272786826021152
  beta  nocc = 2  HOMO = -0.590292292140092  LUMO = 0.0398203366296713
cycle= 7 E= -25.1182451310163  delta_E= -4.45e-09  |g|= 1.13e-05  |ddm|= 0.000128
  alpha nocc = 4  HOMO = -0.323478953837863  LUMO = 0.0272783712047572
  beta  nocc = 2  HOMO = -0.590298987835069  LUMO = 0.0398200562129927
cycle= 8 E= -25.1182451313166  delta_E= -3e-10  |g|= 1.99e-06  |ddm|= 3.49e-05
  alpha nocc = 4  HOMO = -0.323478904429117  LUMO = 0.0272781066635604
  beta  nocc = 2  HOMO = -0.590299913692652  LUMO = 0.0398196209835862
cycle= 9 E= -25.1182451313231  delta_E= -6.54e-12  |g|= 4.95e-07  |ddm|= 6.41e-06
  alpha nocc = 4  HOMO = -0.323478926873595  LUMO = 0.0272781777963401
  beta  nocc = 2  HOMO = -0.590299832184227  LUMO = 0.0398196842479013
Extra cycle  E= -25.1182451313235  delta_E= -3.73e-13  |g|= 2.31e-07  |ddm|= 1.1e-06
converged SCF energy = -25.1182451313235  <S^2> = 2.0026509  2S+1 = 3.0017667

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3533 MB)
Init E_corr(CCSD) = -0.0349260236842097
cycle = 1  E_corr(CCSD) = -0.0902513492455638  dE = -0.0553253256  norm(t1,t2) = 0.154604
cycle = 2  E_corr(CCSD) = -0.0959942996837594  dE = -0.00574295044  norm(t1,t2) = 0.0330385
cycle = 3  E_corr(CCSD) = -0.0979993421542037  dE = -0.00200504247  norm(t1,t2) = 0.0106294
cycle = 4  E_corr(CCSD) = -0.0980504515018513  dE = -5.11093476e-05  norm(t1,t2) = 0.00287351
cycle = 5  E_corr(CCSD) = -0.098094230423279  dE = -4.37789214e-05  norm(t1,t2) = 0.00132189
cycle = 6  E_corr(CCSD) = -0.0981283784548312  dE = -3.41480316e-05  norm(t1,t2) = 0.000565048
cycle = 7  E_corr(CCSD) = -0.098132875530424  dE = -4.49707559e-06  norm(t1,t2) = 0.000141215
cycle = 8  E_corr(CCSD) = -0.0981345237561107  dE = -1.64822569e-06  norm(t1,t2) = 4.5132e-05
cycle = 9  E_corr(CCSD) = -0.0981349797672612  dE = -4.5601115e-07  norm(t1,t2) = 1.73513e-05
cycle = 10  E_corr(CCSD) = -0.098134957120093  dE = 2.26471682e-08  norm(t1,t2) = 8.11773e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.21638008844361  E_corr = -0.09813495712009299
cycle = 1  norm(lambda1,lambda2) = 0.152567
cycle = 2  norm(lambda1,lambda2) = 0.0305893
cycle = 3  norm(lambda1,lambda2) = 0.00985475
cycle = 4  norm(lambda1,lambda2) = 0.00289498
cycle = 5  norm(lambda1,lambda2) = 0.00139292
cycle = 6  norm(lambda1,lambda2) = 0.000551634
cycle = 7  norm(lambda1,lambda2) = 0.000128202
cycle = 8  norm(lambda1,lambda2) = 4.16471e-05
cycle = 9  norm(lambda1,lambda2) = 1.49639e-05
cycle = 10  norm(lambda1,lambda2) = 5.10442e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0110604777     0.0000001016     0.0000001109
1 H    -0.0110604777    -0.0000001016    -0.0000001109
----------------------------------------------
cycle 2: E = -25.2163800884  dE = -0.0209092  norm(grad) = 0.0156419

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.086606  -0.000003  -0.000003   -0.006647 -0.000003 -0.000003
   H   1.086606   0.000003   0.000003    0.006647  0.000003  0.000003
New geometry
   1 B     -0.086605682508  -0.000003135378  -0.000003421653 AA   -0.163661020771  -0.000005925006  -0.000006465988 Bohr

   2 H      1.086605682964   0.000003135378   0.000003421653 AA    2.053387146198   0.000005925006   0.000006465988 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 359 MB)
number electrons alpha = 4  beta = 2
init E= -25.1150616245767
  alpha nocc = 4  HOMO = -0.325115005379153  LUMO = 0.0257345162084844
  beta  nocc = 2  HOMO = -0.587591777912569  LUMO = 0.0381351693488152
cycle= 1 E= -25.1183914237917  delta_E= -0.00333  |g|= 0.00164  |ddm|= 0.00398
  alpha nocc = 4  HOMO = -0.323467499038148  LUMO = 0.0273178033257305
  beta  nocc = 2  HOMO = -0.586338936809679  LUMO = 0.0393607899783532
cycle= 2 E= -25.1183943492952  delta_E= -2.93e-06  |g|= 0.000486  |ddm|= 0.00125
  alpha nocc = 4  HOMO = -0.323684326399997  LUMO = 0.0271792043402358
  beta  nocc = 2  HOMO = -0.586730699544062  LUMO = 0.0392426359115739
cycle= 3 E= -25.1183947435241  delta_E= -3.94e-07  |g|= 0.000222  |ddm|= 0.000552
  alpha nocc = 4  HOMO = -0.323693390682791  LUMO = 0.0271983920703123
  beta  nocc = 2  HOMO = -0.586646572131726  LUMO = 0.0392244959019388
cycle= 4 E= -25.1183948771099  delta_E= -1.34e-07  |g|= 8.03e-05  |ddm|= 0.000465
  alpha nocc = 4  HOMO = -0.323688278230787  LUMO = 0.027207926277032
  beta  nocc = 2  HOMO = -0.586610076103147  LUMO = 0.039224554177951
cycle= 5 E= -25.1183948927372  delta_E= -1.56e-08  |g|= 2.14e-05  |ddm|= 0.000221
  alpha nocc = 4  HOMO = -0.323681941158607  LUMO = 0.0272085492711742
  beta  nocc = 2  HOMO = -0.586614873873881  LUMO = 0.0392272438641024
cycle= 6 E= -25.1183948935596  delta_E= -8.22e-10  |g|= 4.18e-06  |ddm|= 4.39e-05
  alpha nocc = 4  HOMO = -0.323681775109067  LUMO = 0.0272068682657631
  beta  nocc = 2  HOMO = -0.586618810958209  LUMO = 0.0392262037642406
cycle= 7 E= -25.1183948935979  delta_E= -3.83e-11  |g|= 1.1e-06  |ddm|= 1.1e-05
  alpha nocc = 4  HOMO = -0.323681173146965  LUMO = 0.0272068026478837
  beta  nocc = 2  HOMO = -0.586619493697789  LUMO = 0.0392261457509515
cycle= 8 E= -25.1183948936008  delta_E= -2.96e-12  |g|= 1.94e-07  |ddm|= 3.34e-06
  alpha nocc = 4  HOMO = -0.323681173377303  LUMO = 0.0272067928729218
  beta  nocc = 2  HOMO = -0.58661952805808  LUMO = 0.0392261229171229
Extra cycle  E= -25.1183948936009  delta_E= -1.03e-13  |g|= 9.16e-08  |ddm|= 3.99e-07
converged SCF energy = -25.1183948936009  <S^2> = 2.0026749  2S+1 = 3.0017827

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3505 MB)
Init E_corr(CCSD) = -0.0832156692853032
cycle = 1  E_corr(CCSD) = -0.0972182804724101  dE = -0.0140026112  norm(t1,t2) = 0.0488116
cycle = 2  E_corr(CCSD) = -0.0980023329533474  dE = -0.000784052481  norm(t1,t2) = 0.00740049
cycle = 3  E_corr(CCSD) = -0.0981754770152371  dE = -0.000173144062  norm(t1,t2) = 0.00167101
cycle = 4  E_corr(CCSD) = -0.0981684025125546  dE = 7.07450268e-06  norm(t1,t2) = 0.000363399
cycle = 5  E_corr(CCSD) = -0.0981707979458054  dE = -2.39543325e-06  norm(t1,t2) = 0.00013182
cycle = 6  E_corr(CCSD) = -0.0981729966739443  dE = -2.19872814e-06  norm(t1,t2) = 5.8709e-05
cycle = 7  E_corr(CCSD) = -0.0981737015007212  dE = -7.04826777e-07  norm(t1,t2) = 2.12716e-05
cycle = 8  E_corr(CCSD) = -0.0981742182428999  dE = -5.16742179e-07  norm(t1,t2) = 9.82729e-06
cycle = 9  E_corr(CCSD) = -0.0981743237019207  dE = -1.05459021e-07  norm(t1,t2) = 6.48689e-06
cycle = 10  E_corr(CCSD) = -0.0981743267586852  dE = -3.05676451e-09  norm(t1,t2) = 6.1389e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.21656922035961  E_corr = -0.09817432675868518
cycle = 1  norm(lambda1,lambda2) = 0.0476571
cycle = 2  norm(lambda1,lambda2) = 0.00711058
cycle = 3  norm(lambda1,lambda2) = 0.001603
cycle = 4  norm(lambda1,lambda2) = 0.000365577
cycle = 5  norm(lambda1,lambda2) = 0.000145491
cycle = 6  norm(lambda1,lambda2) = 6.6692e-05
cycle = 7  norm(lambda1,lambda2) = 2.14292e-05
cycle = 8  norm(lambda1,lambda2) = 7.39715e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0040766625     0.0000000334     0.0000000412
1 H    -0.0040766625    -0.0000000334    -0.0000000412
----------------------------------------------
cycle 3: E = -25.2165692204  dE = -0.000189132  norm(grad) = 0.00576527

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.090486  -0.000004  -0.000004   -0.003880 -0.000001 -0.000001
   H   1.090486   0.000004   0.000004    0.003880  0.000001  0.000001
New geometry
   1 B     -0.090485618768  -0.000003812128  -0.000004379455 AA   -0.170993037683  -0.000007203877  -0.000008275971 Bohr

   2 H      1.090485619297   0.000003812128   0.000004379455 AA    2.060719163248   0.000007203877   0.000008275971 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 459 MB)
number electrons alpha = 4  beta = 2
init E= -25.1164038076147
  alpha nocc = 4  HOMO = -0.324661360174751  LUMO = 0.0262900032457042
  beta  nocc = 2  HOMO = -0.585077785106295  LUMO = 0.0382229420509759
cycle= 1 E= -25.1183998592893  delta_E= -0.002  |g|= 0.000958  |ddm|= 0.00231
  alpha nocc = 4  HOMO = -0.32367654935823  LUMO = 0.0272314549927433
  beta  nocc = 2  HOMO = -0.58432036374556  LUMO = 0.0389545799949751
cycle= 2 E= -25.1184008647107  delta_E= -1.01e-06  |g|= 0.000285  |ddm|= 0.000732
  alpha nocc = 4  HOMO = -0.323805190375954  LUMO = 0.0271487199919069
  beta  nocc = 2  HOMO = -0.584550205623138  LUMO = 0.0388831539311541
cycle= 3 E= -25.1184010017321  delta_E= -1.37e-07  |g|= 0.000132  |ddm|= 0.000327
  alpha nocc = 4  HOMO = -0.323810511387941  LUMO = 0.0271599485543964
  beta  nocc = 2  HOMO = -0.584501049845025  LUMO = 0.0388721881393169
cycle= 4 E= -25.1184010494881  delta_E= -4.78e-08  |g|= 4.82e-05  |ddm|= 0.00028
  alpha nocc = 4  HOMO = -0.323807290253195  LUMO = 0.027165669449729
  beta  nocc = 2  HOMO = -0.584479364528163  LUMO = 0.0388722727964206
cycle= 5 E= -25.118401055201  delta_E= -5.71e-09  |g|= 1.29e-05  |ddm|= 0.000134
  alpha nocc = 4  HOMO = -0.323803386891869  LUMO = 0.0271660660974576
  beta  nocc = 2  HOMO = -0.584482388046004  LUMO = 0.0388739439954566
cycle= 6 E= -25.1184010555025  delta_E= -3.01e-10  |g|= 2.53e-06  |ddm|= 2.65e-05
  alpha nocc = 4  HOMO = -0.323803292569874  LUMO = 0.0271650416953231
  beta  nocc = 2  HOMO = -0.584484777932695  LUMO = 0.0388733066902404
cycle= 7 E= -25.1184010555166  delta_E= -1.41e-11  |g|= 6.64e-07  |ddm|= 6.6e-06
  alpha nocc = 4  HOMO = -0.32380306627869  LUMO = 0.0271650562466574
  beta  nocc = 2  HOMO = -0.584484952497185  LUMO = 0.0388733114468142
Extra cycle  E= -25.1184010555173  delta_E= -7.6e-13  |g|= 3.44e-07  |ddm|= 1.09e-06
converged SCF energy = -25.1184010555173  <S^2> = 2.0026903  2S+1 = 3.001793

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3558 MB)
Init E_corr(CCSD) = -0.0823844252092634
cycle = 1  E_corr(CCSD) = -0.0966904065817625  dE = -0.0143059814  norm(t1,t2) = 0.0597731
cycle = 2  E_corr(CCSD) = -0.0978508514513805  dE = -0.00116044487  norm(t1,t2) = 0.0126215
cycle = 3  E_corr(CCSD) = -0.0981955905384876  dE = -0.000344739087  norm(t1,t2) = 0.00374648
cycle = 4  E_corr(CCSD) = -0.0981954560167137  dE = 1.34521774e-07  norm(t1,t2) = 0.000601792
cycle = 5  E_corr(CCSD) = -0.0982013971628645  dE = -5.94114615e-06  norm(t1,t2) = 0.000185217
cycle = 6  E_corr(CCSD) = -0.0982023024579198  dE = -9.05295055e-07  norm(t1,t2) = 7.4752e-05
cycle = 7  E_corr(CCSD) = -0.0982002750216313  dE = 2.02743629e-06  norm(t1,t2) = 3.14498e-05
cycle = 8  E_corr(CCSD) = -0.0981998002696811  dE = 4.7475195e-07  norm(t1,t2) = 1.26462e-05
cycle = 9  E_corr(CCSD) = -0.098199636549121  dE = 1.6372056e-07  norm(t1,t2) = 7.38917e-06
cycle = 10  E_corr(CCSD) = -0.0981995606236881  dE = 7.59254329e-08  norm(t1,t2) = 6.16565e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.21660061614101  E_corr = -0.09819956062368813
cycle = 1  norm(lambda1,lambda2) = 0.0581485
cycle = 2  norm(lambda1,lambda2) = 0.012078
cycle = 3  norm(lambda1,lambda2) = 0.00356709
cycle = 4  norm(lambda1,lambda2) = 0.000554577
cycle = 5  norm(lambda1,lambda2) = 0.000166784
cycle = 6  norm(lambda1,lambda2) = 6.04147e-05
cycle = 7  norm(lambda1,lambda2) = 2.40505e-05
cycle = 8  norm(lambda1,lambda2) = 8.78681e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0002299327     0.0000000012     0.0000000017
1 H    -0.0002299327    -0.0000000012    -0.0000000017
----------------------------------------------
cycle 4: E = -25.2166006161  dE = -3.13958e-05  norm(grad) = 0.000325174

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   B  -0.090718  -0.000004  -0.000004   -0.000232 -0.000000 -0.000000
   H   1.090718   0.000004   0.000004    0.000232  0.000000  0.000000
New geometry
   1 B     -0.090717536319  -0.000003822773  -0.000004405453 AA   -0.171431298338  -0.000007223994  -0.000008325100 Bohr

   2 H      1.090717536806   0.000003822773   0.000004405453 AA    2.061157423823   0.000007223994   0.000008325100 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 357 MB)
number electrons alpha = 4  beta = 2
init E= -25.1182784186597
  alpha nocc = 4  HOMO = -0.323862125462776  LUMO = 0.0271099178080377
  beta  nocc = 2  HOMO = -0.584393850903175  LUMO = 0.0388129096999558
cycle= 1 E= -25.1183995899211  delta_E= -0.000121  |g|= 5.73e-05  |ddm|= 0.000138
  alpha nocc = 4  HOMO = -0.323802704695842  LUMO = 0.0271665343835434
  beta  nocc = 2  HOMO = -0.584348031471136  LUMO = 0.0388569536838741
cycle= 2 E= -25.1183995935322  delta_E= -3.61e-09  |g|= 1.71e-05  |ddm|= 4.39e-05
  alpha nocc = 4  HOMO = -0.323810441663914  LUMO = 0.0271615247969192
  beta  nocc = 2  HOMO = -0.584361849157163  LUMO = 0.0388526123008145
cycle= 3 E= -25.1183995940269  delta_E= -4.95e-10  |g|= 7.96e-06  |ddm|= 1.97e-05
  alpha nocc = 4  HOMO = -0.323810741245201  LUMO = 0.0271621945325197
  beta  nocc = 2  HOMO = -0.58435892705205  LUMO = 0.0388519469561669
cycle= 4 E= -25.1183995942011  delta_E= -1.74e-10  |g|= 2.91e-06  |ddm|= 1.69e-05
  alpha nocc = 4  HOMO = -0.323810538124284  LUMO = 0.0271625385337809
  beta  nocc = 2  HOMO = -0.584357631954252  LUMO = 0.0388519549697624
cycle= 5 E= -25.1183995942218  delta_E= -2.07e-11  |g|= 7.73e-07  |ddm|= 8.07e-06
  alpha nocc = 4  HOMO = -0.323810413804944  LUMO = 0.0271625292774154
  beta  nocc = 2  HOMO = -0.584357830424298  LUMO = 0.0388520101980214
Extra cycle  E= -25.1183995942226  delta_E= -8.38e-13  |g|= 4.09e-07  |ddm|= 7.9e-07
converged SCF energy = -25.1183995942226  <S^2> = 2.0026913  2S+1 = 3.0017937

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3503 MB)
Init E_corr(CCSD) = -0.0981959733922397
cycle = 1  E_corr(CCSD) = -0.0981985242640518  dE = -2.55087181e-06  norm(t1,t2) = 0.000468096
cycle = 2  E_corr(CCSD) = -0.0981998557111252  dE = -1.33144707e-06  norm(t1,t2) = 9.82449e-05
cycle = 3  E_corr(CCSD) = -0.0982006508824156  dE = -7.9517129e-07  norm(t1,t2) = 2.81379e-05
cycle = 4  E_corr(CCSD) = -0.0982009200138669  dE = -2.69131451e-07  norm(t1,t2) = 8.40982e-06
cycle = 5  E_corr(CCSD) = -0.0982010349774011  dE = -1.14963534e-07  norm(t1,t2) = 6.49579e-06
cycle = 6  E_corr(CCSD) = -0.0982010860813582  dE = -5.11039571e-08  norm(t1,t2) = 6.09638e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -25.216600680304  E_corr = -0.09820108608135819
cycle = 1  norm(lambda1,lambda2) = 0.000452605
cycle = 2  norm(lambda1,lambda2) = 9.41995e-05
cycle = 3  norm(lambda1,lambda2) = 2.59734e-05
cycle = 4  norm(lambda1,lambda2) = 5.07745e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 B     0.0000049565     0.0000000003     0.0000000003
1 H    -0.0000049565    -0.0000000003    -0.0000000003
----------------------------------------------
cycle 5: E = -25.2166006803  dE = -6.4163e-08  norm(grad) = 7.00949e-06
