#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/c.h/c.h.chrg1.mult1/c.h.chrg1.mult1.geomopt/c.h.chrg1.mult1.sep1.0-pyscf.qa-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['C', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 1
multiplicity = 1
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n191.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 6
[INPUT] charge = 1
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 3.17506326552
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         1.80
Create scanner for <class 'pyscf.grad.ccsd.Gradients'>
Set <class 'pyscf.cc.ccsd.CCSD'> as a scanner
Create scanner for <class 'pyscf.scf.hf.RHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 149 MB)
init E= -38.0056281844509
  HOMO = -0.270229664905764  LUMO = -0.080128643508966
cycle= 1 E= -37.8112333316348  delta_E= 0.194  |g|= 0.474  |ddm|= 1.09
  HOMO = -0.966079604640208  LUMO = -0.449150961035521
cycle= 2 E= -37.8988253967094  delta_E= -0.0876  |g|= 0.0814  |ddm|= 0.937
  HOMO = -0.889692738357514  LUMO = -0.338592742069093
cycle= 3 E= -37.9006646681045  delta_E= -0.00184  |g|= 0.0164  |ddm|= 0.125
  HOMO = -0.890282922159488  LUMO = -0.336642152815082
cycle= 4 E= -37.9008111771079  delta_E= -0.000147  |g|= 0.00248  |ddm|= 0.0326
  HOMO = -0.890212431194766  LUMO = -0.336566437366392
cycle= 5 E= -37.9008149116319  delta_E= -3.73e-06  |g|= 0.000303  |ddm|= 0.00383
  HOMO = -0.890302736292061  LUMO = -0.336635966326962
cycle= 6 E= -37.9008149657129  delta_E= -5.41e-08  |g|= 3.46e-05  |ddm|= 0.000878
  HOMO = -0.890307903723722  LUMO = -0.336647439855526
cycle= 7 E= -37.900814966348  delta_E= -6.35e-10  |g|= 4.05e-06  |ddm|= 0.000104
  HOMO = -0.890308334925582  LUMO = -0.336648314079606
cycle= 8 E= -37.9008149663559  delta_E= -7.9e-12  |g|= 2.4e-07  |ddm|= 7.8e-06
  HOMO = -0.890308340544974  LUMO = -0.336648356735128
Extra cycle  E= -37.900814966356  delta_E= -1.14e-13  |g|= 4.96e-08  |ddm|= 8.93e-07
converged SCF energy = -37.900814966356

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1539 MB)
Init t2, MP2 energy = -38.0231022439456  E_corr(MP2) -0.122287277589574
Init E_corr(CCSD) = -0.122287277589575
cycle = 1  E_corr(CCSD) = -0.137665947562538  dE = -0.01537867  norm(t1,t2) = 0.0463737
cycle = 2  E_corr(CCSD) = -0.143332551954972  dE = -0.00566660439  norm(t1,t2) = 0.0268596
cycle = 3  E_corr(CCSD) = -0.14933551677881  dE = -0.00600296482  norm(t1,t2) = 0.0168496
cycle = 4  E_corr(CCSD) = -0.149038137466147  dE = 0.000297379313  norm(t1,t2) = 0.00409046
cycle = 5  E_corr(CCSD) = -0.149028142196874  dE = 9.99526927e-06  norm(t1,t2) = 0.00121769
cycle = 6  E_corr(CCSD) = -0.149070949322385  dE = -4.28071255e-05  norm(t1,t2) = 0.000437807
cycle = 7  E_corr(CCSD) = -0.149058398919631  dE = 1.25504028e-05  norm(t1,t2) = 9.34808e-05
cycle = 8  E_corr(CCSD) = -0.149057996891654  dE = 4.02027976e-07  norm(t1,t2) = 1.83295e-05
cycle = 9  E_corr(CCSD) = -0.149058475964661  dE = -4.79073007e-07  norm(t1,t2) = 3.84968e-06
cycle = 10  E_corr(CCSD) = -0.149058183077627  dE = 2.92887034e-07  norm(t1,t2) = 1.13701e-06
cycle = 11  E_corr(CCSD) = -0.149058174121373  dE = 8.95625415e-09  norm(t1,t2) = 1.42282e-07
CCSD_Scanner converged
E(CCSD_Scanner) = -38.04987314047737  E_corr = -0.1490581741213728
cycle = 1  norm(lambda1,lambda2) = 0.00805318
cycle = 2  norm(lambda1,lambda2) = 0.00275471
cycle = 3  norm(lambda1,lambda2) = 0.00159726
cycle = 4  norm(lambda1,lambda2) = 0.00051775
cycle = 5  norm(lambda1,lambda2) = 0.000184563
cycle = 6  norm(lambda1,lambda2) = 6.8346e-05
cycle = 7  norm(lambda1,lambda2) = 1.94182e-05
cycle = 8  norm(lambda1,lambda2) = 4.36057e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0997620553     0.0000000000     0.0000000000
1 H    -0.0997620553    -0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -38.0498731405  dE = -38.0499  norm(grad) = 0.141085

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C  -0.055351  -0.000000  -0.000000   -0.055351 -0.000000 -0.000000
   H   1.055351   0.000000   0.000000    0.055351  0.000000  0.000000
New geometry
   1 C     -0.055350864705  -0.000000000000  -0.000000000000 AA   -0.104597975051  -0.000000000000  -0.000000000000 Bohr

   2 H      1.055350864753   0.000000000000   0.000000000000 AA    1.994324099706   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 296 MB)
init E= -37.8268094147015
  HOMO = -0.90449295313392  LUMO = -0.355121978982268
cycle= 1 E= -37.9097394018559  delta_E= -0.0829  |g|= 0.0296  |ddm|= 0.0643
  HOMO = -0.876151725390494  LUMO = -0.329603014980973
cycle= 2 E= -37.9100093494305  delta_E= -0.00027  |g|= 0.00558  |ddm|= 0.016
  HOMO = -0.877889970975547  LUMO = -0.332524009823144
cycle= 3 E= -37.9100241364773  delta_E= -1.48e-05  |g|= 0.0011  |ddm|= 0.00591
  HOMO = -0.877657093151422  LUMO = -0.332378539639655
cycle= 4 E= -37.9100249147888  delta_E= -7.78e-07  |g|= 0.000196  |ddm|= 0.00155
  HOMO = -0.877679082310082  LUMO = -0.332423351474705
cycle= 5 E= -37.9100249387185  delta_E= -2.39e-08  |g|= 1.85e-05  |ddm|= 0.000364
  HOMO = -0.877671620844315  LUMO = -0.332415288867085
cycle= 6 E= -37.9100249389245  delta_E= -2.06e-10  |g|= 2.75e-06  |ddm|= 3.92e-05
  HOMO = -0.877672159245785  LUMO = -0.332415504033267
cycle= 7 E= -37.9100249389283  delta_E= -3.77e-12  |g|= 3.64e-07  |ddm|= 4.7e-06
  HOMO = -0.877672112036207  LUMO = -0.33241542913787
Extra cycle  E= -37.9100249389283  delta_E= -7.11e-14  |g|= 1.18e-07  |ddm|= 5.74e-07
converged SCF energy = -37.9100249389283

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1682 MB)
Init E_corr(CCSD) = -0.0772065290015483
cycle = 1  E_corr(CCSD) = -0.141170479575541  dE = -0.0639639506  norm(t1,t2) = 0.113096
cycle = 2  E_corr(CCSD) = -0.147182539416655  dE = -0.00601205984  norm(t1,t2) = 0.0252368
cycle = 3  E_corr(CCSD) = -0.149608700635916  dE = -0.00242616122  norm(t1,t2) = 0.00891446
cycle = 4  E_corr(CCSD) = -0.1499105846541  dE = -0.000301884018  norm(t1,t2) = 0.00309615
cycle = 5  E_corr(CCSD) = -0.150023370964115  dE = -0.00011278631  norm(t1,t2) = 0.0017102
cycle = 6  E_corr(CCSD) = -0.15007894219572  dE = -5.55712316e-05  norm(t1,t2) = 0.0007466
cycle = 7  E_corr(CCSD) = -0.150072900149105  dE = 6.04204661e-06  norm(t1,t2) = 0.00024686
cycle = 8  E_corr(CCSD) = -0.150064709197217  dE = 8.19095189e-06  norm(t1,t2) = 0.000100628
cycle = 9  E_corr(CCSD) = -0.150062262032412  dE = 2.4471648e-06  norm(t1,t2) = 3.66083e-05
cycle = 10  E_corr(CCSD) = -0.150061138207959  dE = 1.12382445e-06  norm(t1,t2) = 1.73277e-05
cycle = 11  E_corr(CCSD) = -0.150060989355177  dE = 1.48852782e-07  norm(t1,t2) = 1.03993e-05
cycle = 12  E_corr(CCSD) = -0.15006111342709  dE = -1.24071913e-07  norm(t1,t2) = 5.22835e-06
cycle = 13  E_corr(CCSD) = -0.150061067226315  dE = 4.62007749e-08  norm(t1,t2) = 1.98791e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.06008600615466  E_corr = -0.1500610672263154
cycle = 1  norm(lambda1,lambda2) = 0.109342
cycle = 2  norm(lambda1,lambda2) = 0.0230124
cycle = 3  norm(lambda1,lambda2) = 0.00831375
cycle = 4  norm(lambda1,lambda2) = 0.00321432
cycle = 5  norm(lambda1,lambda2) = 0.00176984
cycle = 6  norm(lambda1,lambda2) = 0.0006964
cycle = 7  norm(lambda1,lambda2) = 0.000248712
cycle = 8  norm(lambda1,lambda2) = 0.000103174
cycle = 9  norm(lambda1,lambda2) = 3.67676e-05
cycle = 10  norm(lambda1,lambda2) = 1.84005e-05
cycle = 11  norm(lambda1,lambda2) = 1.05927e-05
cycle = 12  norm(lambda1,lambda2) = 4.79148e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0074146890    -0.0000000564    -0.0000001422
1 H    -0.0074146890     0.0000000564     0.0000001422
----------------------------------------------
cycle 2: E = -38.0600860062  dE = -0.0102129  norm(grad) = 0.010486

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C  -0.059795   0.000002   0.000004   -0.004444  0.000002  0.000004
   H   1.059795  -0.000002  -0.000004    0.004444 -0.000002 -0.000004
New geometry
   1 C     -0.059795056931   0.000001591474   0.000004010894 AA   -0.112996281203   0.000003007450   0.000007579490 Bohr

   2 H      1.059795056950  -0.000001591474  -0.000004010894 AA    2.002722405803  -0.000003007450  -0.000007579490 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 326 MB)
init E= -37.9045300465643
  HOMO = -0.878571852873286  LUMO = -0.33376146318
cycle= 1 E= -37.9099946822927  delta_E= -0.00546  |g|= 0.0023  |ddm|= 0.00556
  HOMO = -0.876450087478372  LUMO = -0.331878747683968
cycle= 2 E= -37.90999630661  delta_E= -1.62e-06  |g|= 0.000424  |ddm|= 0.00123
  HOMO = -0.876564916848529  LUMO = -0.332087089384766
cycle= 3 E= -37.9099963931426  delta_E= -8.65e-08  |g|= 8.32e-05  |ddm|= 0.00044
  HOMO = -0.876550368162656  LUMO = -0.332079446628594
cycle= 4 E= -37.9099963976248  delta_E= -4.48e-09  |g|= 1.46e-05  |ddm|= 0.000118
  HOMO = -0.876551691761641  LUMO = -0.332082615432292
cycle= 5 E= -37.9099963977578  delta_E= -1.33e-10  |g|= 1.44e-06  |ddm|= 2.73e-05
  HOMO = -0.876551123798053  LUMO = -0.332081998021158
cycle= 6 E= -37.9099963977594  delta_E= -1.53e-12  |g|= 3.12e-07  |ddm|= 2.82e-06
  HOMO = -0.876551173201796  LUMO = -0.332082031140065
Extra cycle  E= -37.9099963977594  delta_E= -7.11e-14  |g|= 1.89e-07  |ddm|= 3.66e-07
converged SCF energy = -37.9099963977594

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1702 MB)
Init E_corr(CCSD) = -0.115672745629695
cycle = 1  E_corr(CCSD) = -0.146016173562728  dE = -0.0303434279  norm(t1,t2) = 0.0841785
cycle = 2  E_corr(CCSD) = -0.148766275073959  dE = -0.00275010151  norm(t1,t2) = 0.0202019
cycle = 3  E_corr(CCSD) = -0.149977299357284  dE = -0.00121102428  norm(t1,t2) = 0.00755644
cycle = 4  E_corr(CCSD) = -0.150062135928439  dE = -8.48365712e-05  norm(t1,t2) = 0.0023948
cycle = 5  E_corr(CCSD) = -0.150115873719922  dE = -5.37377915e-05  norm(t1,t2) = 0.00140636
cycle = 6  E_corr(CCSD) = -0.150170171559636  dE = -5.42978397e-05  norm(t1,t2) = 0.000598731
cycle = 7  E_corr(CCSD) = -0.150173286169128  dE = -3.11460949e-06  norm(t1,t2) = 0.000146441
cycle = 8  E_corr(CCSD) = -0.150172374986816  dE = 9.11182311e-07  norm(t1,t2) = 5.44205e-05
cycle = 9  E_corr(CCSD) = -0.15017155026031  dE = 8.24726506e-07  norm(t1,t2) = 2.67575e-05
cycle = 10  E_corr(CCSD) = -0.15017062255353  dE = 9.2770678e-07  norm(t1,t2) = 1.12814e-05
cycle = 11  E_corr(CCSD) = -0.150170380394184  dE = 2.42159346e-07  norm(t1,t2) = 3.86619e-06
cycle = 12  E_corr(CCSD) = -0.150170340923261  dE = 3.94709232e-08  norm(t1,t2) = 1.20915e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.06016673868267  E_corr = -0.1501703409232611
cycle = 1  norm(lambda1,lambda2) = 0.0804595
cycle = 2  norm(lambda1,lambda2) = 0.0186997
cycle = 3  norm(lambda1,lambda2) = 0.00708423
cycle = 4  norm(lambda1,lambda2) = 0.00243792
cycle = 5  norm(lambda1,lambda2) = 0.0014401
cycle = 6  norm(lambda1,lambda2) = 0.00055666
cycle = 7  norm(lambda1,lambda2) = 0.000143474
cycle = 8  norm(lambda1,lambda2) = 5.56554e-05
cycle = 9  norm(lambda1,lambda2) = 2.69873e-05
cycle = 10  norm(lambda1,lambda2) = 1.11164e-05
cycle = 11  norm(lambda1,lambda2) = 3.97943e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0022354623     0.0000000265     0.0000000764
1 H    -0.0022354623    -0.0000000265    -0.0000000764
----------------------------------------------
cycle 3: E = -38.0601667387  dE = -8.07325e-05  norm(grad) = 0.00316142

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C  -0.061713   0.000000   0.000001   -0.001918 -0.000001 -0.000003
   H   1.061713  -0.000000  -0.000001    0.001918  0.000001  0.000003
New geometry
   1 C     -0.061713263133   0.000000395430   0.000000631168 AA   -0.116621165575   0.000000747254   0.000001192735 Bohr

   2 H      1.061713263164  -0.000000395430  -0.000000631168 AA    2.006347290198  -0.000000747254  -0.000001192735 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 333 MB)
init E= -37.9076263211863
  HOMO = -0.876930843275804  LUMO = -0.332661011125873
cycle= 1 E= -37.9099558575522  delta_E= -0.00233  |g|= 0.000988  |ddm|= 0.00242
  HOMO = -0.876019099977363  LUMO = -0.331851156249632
cycle= 2 E= -37.9099561581202  delta_E= -3.01e-07  |g|= 0.000182  |ddm|= 0.000527
  HOMO = -0.876068189966232  LUMO = -0.331940395164557
cycle= 3 E= -37.9099561740794  delta_E= -1.6e-08  |g|= 3.57e-05  |ddm|= 0.000188
  HOMO = -0.876062006279337  LUMO = -0.331937200692045
cycle= 4 E= -37.9099561749069  delta_E= -8.27e-10  |g|= 6.32e-06  |ddm|= 5.06e-05
  HOMO = -0.876062560099791  LUMO = -0.331938565751957
cycle= 5 E= -37.9099561749317  delta_E= -2.48e-11  |g|= 6.52e-07  |ddm|= 1.18e-05
  HOMO = -0.876062333651376  LUMO = -0.331938307312358
Extra cycle  E= -37.909956174932  delta_E= -2.7e-13  |g|= 2.68e-07  |ddm|= 9.01e-07
converged SCF energy = -37.909956174932

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1709 MB)
Init E_corr(CCSD) = -0.137624359689268
cycle = 1  E_corr(CCSD) = -0.149369942865739  dE = -0.0117455832  norm(t1,t2) = 0.0429813
cycle = 2  E_corr(CCSD) = -0.149952076799494  dE = -0.000582133934  norm(t1,t2) = 0.0087992
cycle = 3  E_corr(CCSD) = -0.150183569476293  dE = -0.000231492677  norm(t1,t2) = 0.00257652
cycle = 4  E_corr(CCSD) = -0.150196608267833  dE = -1.30387915e-05  norm(t1,t2) = 0.000635618
cycle = 5  E_corr(CCSD) = -0.150204778265435  dE = -8.1699976e-06  norm(t1,t2) = 0.000355772
cycle = 6  E_corr(CCSD) = -0.150216698139781  dE = -1.19198743e-05  norm(t1,t2) = 0.000186735
cycle = 7  E_corr(CCSD) = -0.15021846306526  dE = -1.76492548e-06  norm(t1,t2) = 5.71141e-05
cycle = 8  E_corr(CCSD) = -0.150218931130888  dE = -4.68065627e-07  norm(t1,t2) = 1.95266e-05
cycle = 9  E_corr(CCSD) = -0.150219162678526  dE = -2.31547638e-07  norm(t1,t2) = 7.69509e-06
cycle = 10  E_corr(CCSD) = -0.150219079945242  dE = 8.27332838e-08  norm(t1,t2) = 3.24332e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.06017525487724  E_corr = -0.1502190799452417
cycle = 1  norm(lambda1,lambda2) = 0.0406818
cycle = 2  norm(lambda1,lambda2) = 0.00818635
cycle = 3  norm(lambda1,lambda2) = 0.00239621
cycle = 4  norm(lambda1,lambda2) = 0.000656733
cycle = 5  norm(lambda1,lambda2) = 0.000382328
cycle = 6  norm(lambda1,lambda2) = 0.000186084
cycle = 7  norm(lambda1,lambda2) = 5.22986e-05
cycle = 8  norm(lambda1,lambda2) = 1.84786e-05
cycle = 9  norm(lambda1,lambda2) = 7.77553e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0000826240    -0.0000000359    -0.0000001034
1 H    -0.0000826240     0.0000000359     0.0000001034
----------------------------------------------
cycle 4: E = -38.0601752549  dE = -8.51619e-06  norm(grad) = 0.000116848

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C  -0.061787   0.000001   0.000003   -0.000074  0.000001  0.000003
   H   1.061787  -0.000001  -0.000003    0.000074 -0.000001 -0.000003
New geometry
   1 C     -0.061786882308   0.000001375955   0.000003461856 AA   -0.116760285652   0.000002600178   0.000006541960 Bohr

   2 H      1.061786882324  -0.000001375955  -0.000003461856 AA    2.006486410249  -0.000002600178  -0.000006541960 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 335 MB)
init E= -37.9098653739873
  HOMO = -0.876076762322041  LUMO = -0.33196044943278
cycle= 1 E= -37.9099543033143  delta_E= -8.89e-05  |g|= 3.79e-05  |ddm|= 9.31e-05
  HOMO = -0.876041866385945  LUMO = -0.331929465513308
cycle= 2 E= -37.9099543037572  delta_E= -4.43e-10  |g|= 7e-06  |ddm|= 2.02e-05
  HOMO = -0.876043738757072  LUMO = -0.331932877637896
cycle= 3 E= -37.9099543037811  delta_E= -2.39e-11  |g|= 1.43e-06  |ddm|= 7.25e-06
  HOMO = -0.876043502489659  LUMO = -0.331932756374934
cycle= 4 E= -37.9099543037827  delta_E= -1.58e-12  |g|= 3.71e-07  |ddm|= 2.01e-06
  HOMO = -0.876043522979875  LUMO = -0.331932797485997
Extra cycle  E= -37.9099543037828  delta_E= -6.39e-14  |g|= 2.32e-07  |ddm|= 3.97e-07
converged SCF energy = -37.9099543037828

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = 3, nmo = 146
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 1711 MB)
Init E_corr(CCSD) = -0.14228809081671
cycle = 1  E_corr(CCSD) = -0.150328279568067  dE = -0.00804018875  norm(t1,t2) = 0.0201168
cycle = 2  E_corr(CCSD) = -0.150303398139876  dE = 2.48814282e-05  norm(t1,t2) = 0.00354287
cycle = 3  E_corr(CCSD) = -0.15025991846874  dE = 4.34796711e-05  norm(t1,t2) = 0.00105653
cycle = 4  E_corr(CCSD) = -0.150228937599501  dE = 3.09808692e-05  norm(t1,t2) = 0.000233852
cycle = 5  E_corr(CCSD) = -0.150223631884726  dE = 5.30571478e-06  norm(t1,t2) = 6.14304e-05
cycle = 6  E_corr(CCSD) = -0.150222259158213  dE = 1.37272651e-06  norm(t1,t2) = 1.88944e-05
cycle = 7  E_corr(CCSD) = -0.150221262374705  dE = 9.96783508e-07  norm(t1,t2) = 6.76027e-06
cycle = 8  E_corr(CCSD) = -0.150220856316897  dE = 4.06057808e-07  norm(t1,t2) = 3.1587e-06
cycle = 9  E_corr(CCSD) = -0.150220780520682  dE = 7.57962149e-08  norm(t1,t2) = 1.43017e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.06017508430345  E_corr = -0.1502207805206823
cycle = 1  norm(lambda1,lambda2) = 0.0192214
cycle = 2  norm(lambda1,lambda2) = 0.00330682
cycle = 3  norm(lambda1,lambda2) = 0.000974094
cycle = 4  norm(lambda1,lambda2) = 0.000214372
cycle = 5  norm(lambda1,lambda2) = 5.49618e-05
cycle = 6  norm(lambda1,lambda2) = 1.63581e-05
cycle = 7  norm(lambda1,lambda2) = 6.32911e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0000010589     0.0000000429     0.0000001240
1 H    -0.0000010589    -0.0000000429    -0.0000001240
----------------------------------------------
cycle 5: E = -38.0601750843  dE = 1.70574e-07  norm(grad) = 1.50898e-06
