#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/c.h/c.h.chrg0.mult4/c.h.chrg0.mult4.geomopt/c.h.chrg0.mult4.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['C', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 0
multiplicity = 4
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n179.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 7
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 3
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 3.17506326552
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         1.93
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 145 MB)
number electrons alpha = 5  beta = 2
init E= -38.0056281844509
  alpha nocc = 5  HOMO = -0.0801286435089695  LUMO = 0.110702517156012
  beta  nocc = 2  HOMO = -0.929731041296898  LUMO = -0.270229664905759

WARN: system HOMO -0.0801286435089695 >= system LUMO -0.270229664905759

cycle= 1 E= -38.2068287676438  delta_E= -0.201  |g|= 0.234  |ddm|= 0.795
  alpha nocc = 5  HOMO = -0.485368321731159  LUMO = 0.0810642028339006
  beta  nocc = 2  HOMO = -0.825352485785705  LUMO = -0.060592868819861
cycle= 2 E= -38.2719804670746  delta_E= -0.0652  |g|= 0.098  |ddm|= 0.348
  alpha nocc = 5  HOMO = -0.431899171332846  LUMO = 0.0992573053476407
  beta  nocc = 2  HOMO = -0.730739003983357  LUMO = 0.0225179576439466
cycle= 3 E= -38.2816520857027  delta_E= -0.00967  |g|= 0.0504  |ddm|= 0.101
  alpha nocc = 5  HOMO = -0.43449100869689  LUMO = 0.109320432837544
  beta  nocc = 2  HOMO = -0.717167599828066  LUMO = 0.0500625546982377
cycle= 4 E= -38.2875568709292  delta_E= -0.0059  |g|= 0.015  |ddm|= 0.125
  alpha nocc = 5  HOMO = -0.435977002376644  LUMO = 0.107623551932099
  beta  nocc = 2  HOMO = -0.721783954031618  LUMO = 0.0469031191171288
cycle= 5 E= -38.287967614766  delta_E= -0.000411  |g|= 0.005  |ddm|= 0.0228
  alpha nocc = 5  HOMO = -0.437844275633339  LUMO = 0.107569215905616
  beta  nocc = 2  HOMO = -0.723458642104391  LUMO = 0.0453850663511964
cycle= 6 E= -38.2880019780687  delta_E= -3.44e-05  |g|= 0.00122  |ddm|= 0.00862
  alpha nocc = 5  HOMO = -0.437587740160638  LUMO = 0.107609662402069
  beta  nocc = 2  HOMO = -0.723738918621488  LUMO = 0.0459541561925539
cycle= 7 E= -38.2880039839808  delta_E= -2.01e-06  |g|= 0.000336  |ddm|= 0.00221
  alpha nocc = 5  HOMO = -0.437515214307646  LUMO = 0.107604244547272
  beta  nocc = 2  HOMO = -0.723564642772804  LUMO = 0.0458920484815811
cycle= 8 E= -38.288004139332  delta_E= -1.55e-07  |g|= 6.4e-05  |ddm|= 0.000861
  alpha nocc = 5  HOMO = -0.437527981272576  LUMO = 0.107609197815762
  beta  nocc = 2  HOMO = -0.723569830405379  LUMO = 0.0459075173831993
cycle= 9 E= -38.2880041448288  delta_E= -5.5e-09  |g|= 1.91e-05  |ddm|= 0.000144
  alpha nocc = 5  HOMO = -0.437526572774372  LUMO = 0.107606800856281
  beta  nocc = 2  HOMO = -0.723553052026391  LUMO = 0.0458988667952948
cycle= 10 E= -38.2880041451405  delta_E= -3.12e-10  |g|= 3.11e-06  |ddm|= 3.48e-05
  alpha nocc = 5  HOMO = -0.437526507659472  LUMO = 0.107606840054435
  beta  nocc = 2  HOMO = -0.723553507316998  LUMO = 0.045900100705337
cycle= 11 E= -38.2880041451537  delta_E= -1.32e-11  |g|= 6.43e-07  |ddm|= 8.06e-06
  alpha nocc = 5  HOMO = -0.437526497928854  LUMO = 0.107606882988625
  beta  nocc = 2  HOMO = -0.723553051234561  LUMO = 0.0459000525604914
Extra cycle  E= -38.2880041451541  delta_E= -4.12e-13  |g|= 2.4e-07  |ddm|= 1.59e-06
converged SCF energy = -38.2880041451541  <S^2> = 3.7543865  2S+1 = 4.0021926

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3327 MB)
Init t2, MP2 energy = -0.116412713443112
Init E_corr(CCSD) = -0.116412713443165
cycle = 1  E_corr(CCSD) = -0.127025432227116  dE = -0.0106127188  norm(t1,t2) = 0.0352769
cycle = 2  E_corr(CCSD) = -0.129689272455815  dE = -0.00266384023  norm(t1,t2) = 0.0162716
cycle = 3  E_corr(CCSD) = -0.131501713430705  dE = -0.00181244097  norm(t1,t2) = 0.0100647
cycle = 4  E_corr(CCSD) = -0.131390726421603  dE = 0.000110987009  norm(t1,t2) = 0.00259414
cycle = 5  E_corr(CCSD) = -0.131393995159748  dE = -3.26873814e-06  norm(t1,t2) = 0.000643641
cycle = 6  E_corr(CCSD) = -0.131404854274983  dE = -1.08591152e-05  norm(t1,t2) = 0.000201581
cycle = 7  E_corr(CCSD) = -0.131404329147656  dE = 5.25127327e-07  norm(t1,t2) = 6.77079e-05
cycle = 8  E_corr(CCSD) = -0.13140394790642  dE = 3.81241236e-07  norm(t1,t2) = 1.78772e-05
cycle = 9  E_corr(CCSD) = -0.131404054018587  dE = -1.06112167e-07  norm(t1,t2) = 6.12733e-06
cycle = 10  E_corr(CCSD) = -0.131403991351297  dE = 6.26672896e-08  norm(t1,t2) = 1.67649e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.41940813650541  E_corr = -0.1314039913512969
cycle = 1  norm(lambda1,lambda2) = 0.00639516
cycle = 2  norm(lambda1,lambda2) = 0.00123813
cycle = 3  norm(lambda1,lambda2) = 0.000568987
cycle = 4  norm(lambda1,lambda2) = 0.000204027
cycle = 5  norm(lambda1,lambda2) = 9.3266e-05
cycle = 6  norm(lambda1,lambda2) = 2.32078e-05
cycle = 7  norm(lambda1,lambda2) = 5.91428e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0708739815    -0.0000000000    -0.0000000000
1 H    -0.0708739815     0.0000000000     0.0000000000
----------------------------------------------
cycle 1: E = -38.4194081365  dE = -38.4194  norm(grad) = 0.100231

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C  -0.039323   0.000000   0.000000   -0.039323  0.000000  0.000000
   H   1.039323  -0.000000  -0.000000    0.039323 -0.000000 -0.000000
New geometry
   1 C     -0.039322928413   0.000000000000   0.000000000000 AA   -0.074309565116   0.000000000000   0.000000000000 Bohr

   2 H      1.039322928455  -0.000000000000  -0.000000000000 AA    1.964035689761  -0.000000000000  -0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 359 MB)
number electrons alpha = 5  beta = 2
init E= -38.2609938809932
  alpha nocc = 5  HOMO = -0.449566819540331  LUMO = 0.0973960171991169
  beta  nocc = 2  HOMO = -0.700106041555545  LUMO = 0.032618217425443
cycle= 1 E= -38.2917382796543  delta_E= -0.0307  |g|= 0.0135  |ddm|= 0.0312
  alpha nocc = 5  HOMO = -0.434112704462284  LUMO = 0.106849907421123
  beta  nocc = 2  HOMO = -0.690355669272657  LUMO = 0.0436701960585852
cycle= 2 E= -38.2919010128364  delta_E= -0.000163  |g|= 0.0042  |ddm|= 0.00914
  alpha nocc = 5  HOMO = -0.436712464596091  LUMO = 0.106213121009414
  beta  nocc = 2  HOMO = -0.694159972802088  LUMO = 0.0419243289390974
cycle= 3 E= -38.2919229947787  delta_E= -2.2e-05  |g|= 0.00198  |ddm|= 0.00384
  alpha nocc = 5  HOMO = -0.436391750676921  LUMO = 0.106131873229994
  beta  nocc = 2  HOMO = -0.69355621321091  LUMO = 0.0418084660520897
cycle= 4 E= -38.2919320857027  delta_E= -9.09e-06  |g|= 0.000793  |ddm|= 0.00328
  alpha nocc = 5  HOMO = -0.436452555827457  LUMO = 0.106141542030331
  beta  nocc = 2  HOMO = -0.693361787391047  LUMO = 0.0416071171743971
cycle= 5 E= -38.2919336184718  delta_E= -1.53e-06  |g|= 0.000254  |ddm|= 0.00178
  alpha nocc = 5  HOMO = -0.436333333450282  LUMO = 0.106140370667403
  beta  nocc = 2  HOMO = -0.69336383094267  LUMO = 0.0416824688495379
cycle= 6 E= -38.2919337228691  delta_E= -1.04e-07  |g|= 5.9e-05  |ddm|= 0.00052
  alpha nocc = 5  HOMO = -0.43635513079671  LUMO = 0.106136866139381
  beta  nocc = 2  HOMO = -0.693417796752773  LUMO = 0.041664239986194
cycle= 7 E= -38.2919337276896  delta_E= -4.82e-09  |g|= 1.45e-05  |ddm|= 8.13e-05
  alpha nocc = 5  HOMO = -0.436355050280231  LUMO = 0.106135730632372
  beta  nocc = 2  HOMO = -0.69342810363561  LUMO = 0.0416633348883556
cycle= 8 E= -38.291933728046  delta_E= -3.56e-10  |g|= 3.2e-06  |ddm|= 2.74e-05
  alpha nocc = 5  HOMO = -0.43635496209852  LUMO = 0.106135981729552
  beta  nocc = 2  HOMO = -0.693428366474317  LUMO = 0.0416635640589339
cycle= 9 E= -38.2919337280598  delta_E= -1.38e-11  |g|= 5.09e-07  |ddm|= 5.3e-06
  alpha nocc = 5  HOMO = -0.436354947634212  LUMO = 0.106136033011957
  beta  nocc = 2  HOMO = -0.693428162406793  LUMO = 0.0416636805169305
Extra cycle  E= -38.2919337280602  delta_E= -4.41e-13  |g|= 2.13e-07  |ddm|= 1.14e-06
converged SCF energy = -38.2919337280602  <S^2> = 3.7543683  2S+1 = 4.0021835

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3492 MB)
Init E_corr(CCSD) = -0.0055066846003758
cycle = 1  E_corr(CCSD) = -0.118205648363735  dE = -0.112698964  norm(t1,t2) = 0.232016
cycle = 2  E_corr(CCSD) = -0.128352181715236  dE = -0.0101465334  norm(t1,t2) = 0.0528866
cycle = 3  E_corr(CCSD) = -0.132167683136935  dE = -0.00381550142  norm(t1,t2) = 0.0190203
cycle = 4  E_corr(CCSD) = -0.132279004966027  dE = -0.000111321829  norm(t1,t2) = 0.00678335
cycle = 5  E_corr(CCSD) = -0.132435665347062  dE = -0.000156660381  norm(t1,t2) = 0.00325832
cycle = 6  E_corr(CCSD) = -0.132530264346905  dE = -9.45989998e-05  norm(t1,t2) = 0.00118891
cycle = 7  E_corr(CCSD) = -0.132530637464082  dE = -3.73117177e-07  norm(t1,t2) = 0.000247569
cycle = 8  E_corr(CCSD) = -0.132534518454777  dE = -3.8809907e-06  norm(t1,t2) = 8.73249e-05
cycle = 9  E_corr(CCSD) = -0.132534631498853  dE = -1.13044075e-07  norm(t1,t2) = 2.74492e-05
cycle = 10  E_corr(CCSD) = -0.132534537210085  dE = 9.42887678e-08  norm(t1,t2) = 8.10725e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.42446826527028  E_corr = -0.1325345372100849
cycle = 1  norm(lambda1,lambda2) = 0.233314
cycle = 2  norm(lambda1,lambda2) = 0.0473281
cycle = 3  norm(lambda1,lambda2) = 0.0171974
cycle = 4  norm(lambda1,lambda2) = 0.00652851
cycle = 5  norm(lambda1,lambda2) = 0.00322402
cycle = 6  norm(lambda1,lambda2) = 0.0010599
cycle = 7  norm(lambda1,lambda2) = 0.000224158
cycle = 8  norm(lambda1,lambda2) = 8.3756e-05
cycle = 9  norm(lambda1,lambda2) = 2.63862e-05
cycle = 10  norm(lambda1,lambda2) = 7.86305e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0024652001     0.0000000027     0.0000000062
1 H    -0.0024652001    -0.0000000027    -0.0000000062
----------------------------------------------
cycle 2: E = -38.4244682653  dE = -0.00506013  norm(grad) = 0.00348632

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C  -0.040740  -0.000000  -0.000000   -0.001417 -0.000000 -0.000000
   H   1.040740   0.000000   0.000000    0.001417  0.000000  0.000000
New geometry
   1 C     -0.040739981689  -0.000000070009  -0.000000158135 AA   -0.076987407712  -0.000000132298  -0.000000298832 Bohr

   2 H      1.040739981730   0.000000070009   0.000000158135 AA    1.966713532354   0.000000132298   0.000000298832 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 434 MB)
number electrons alpha = 5  beta = 2
init E= -38.290657390553
  alpha nocc = 5  HOMO = -0.436827406622133  LUMO = 0.105737696550316
  beta  nocc = 2  HOMO = -0.69267253811527  LUMO = 0.0411392647463096
cycle= 1 E= -38.2918949331576  delta_E= -0.00124  |g|= 0.000491  |ddm|= 0.00112
  alpha nocc = 5  HOMO = -0.436229207879582  LUMO = 0.106095770547938
  beta  nocc = 2  HOMO = -0.692273191585003  LUMO = 0.0415681356692667
cycle= 2 E= -38.2918951549777  delta_E= -2.22e-07  |g|= 0.000157  |ddm|= 0.000348
  alpha nocc = 5  HOMO = -0.436330522639238  LUMO = 0.106072198204752
  beta  nocc = 2  HOMO = -0.692413626468476  LUMO = 0.0414977821776478
cycle= 3 E= -38.2918951859947  delta_E= -3.1e-08  |g|= 7.6e-05  |ddm|= 0.000148
  alpha nocc = 5  HOMO = -0.436318911446683  LUMO = 0.106068999961212
  beta  nocc = 2  HOMO = -0.692391614603636  LUMO = 0.0414929884627313
cycle= 4 E= -38.2918951995636  delta_E= -1.36e-08  |g|= 3.03e-05  |ddm|= 0.000132
  alpha nocc = 5  HOMO = -0.436320831932798  LUMO = 0.106069567491162
  beta  nocc = 2  HOMO = -0.692383976099168  LUMO = 0.0414858074312323
cycle= 5 E= -38.2918952018121  delta_E= -2.25e-09  |g|= 9.52e-06  |ddm|= 7.01e-05
  alpha nocc = 5  HOMO = -0.436316319229168  LUMO = 0.106069514366374
  beta  nocc = 2  HOMO = -0.692384409195124  LUMO = 0.0414887978440154
cycle= 6 E= -38.2918952019553  delta_E= -1.43e-10  |g|= 2.2e-06  |ddm|= 1.88e-05
  alpha nocc = 5  HOMO = -0.436317119907104  LUMO = 0.106069369169275
  beta  nocc = 2  HOMO = -0.692386440404875  LUMO = 0.0414880784394919
cycle= 7 E= -38.291895201962  delta_E= -6.69e-12  |g|= 5.33e-07  |ddm|= 2.98e-06
  alpha nocc = 5  HOMO = -0.436317108454194  LUMO = 0.106069348301208
  beta  nocc = 2  HOMO = -0.692386616697054  LUMO = 0.0414880620014446
Extra cycle  E= -38.2918952019624  delta_E= -3.77e-13  |g|= 2.7e-07  |ddm|= 6.15e-07
converged SCF energy = -38.2918952019624  <S^2> = 3.7543631  2S+1 = 4.002181

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3567 MB)
Init E_corr(CCSD) = -0.0645604885210871
cycle = 1  E_corr(CCSD) = -0.125523382581786  dE = -0.0609628941  norm(t1,t2) = 0.175162
cycle = 2  E_corr(CCSD) = -0.130581200142777  dE = -0.00505781756  norm(t1,t2) = 0.0394849
cycle = 3  E_corr(CCSD) = -0.132421646853569  dE = -0.00184044671  norm(t1,t2) = 0.0133834
cycle = 4  E_corr(CCSD) = -0.132445803929703  dE = -2.41570761e-05  norm(t1,t2) = 0.00387511
cycle = 5  E_corr(CCSD) = -0.132525238668049  dE = -7.94347383e-05  norm(t1,t2) = 0.00145963
cycle = 6  E_corr(CCSD) = -0.132569954640028  dE = -4.4715972e-05  norm(t1,t2) = 0.000524528
cycle = 7  E_corr(CCSD) = -0.132577367647778  dE = -7.41300775e-06  norm(t1,t2) = 0.000166996
cycle = 8  E_corr(CCSD) = -0.132580640801921  dE = -3.27315414e-06  norm(t1,t2) = 5.24381e-05
cycle = 9  E_corr(CCSD) = -0.132580894013089  dE = -2.53211167e-07  norm(t1,t2) = 1.46367e-05
cycle = 10  E_corr(CCSD) = -0.132581039544709  dE = -1.4553162e-07  norm(t1,t2) = 5.34821e-06
cycle = 11  E_corr(CCSD) = -0.132581068803251  dE = -2.92585428e-08  norm(t1,t2) = 1.81473e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.42447627076563  E_corr = -0.1325810688032513
cycle = 1  norm(lambda1,lambda2) = 0.174073
cycle = 2  norm(lambda1,lambda2) = 0.0357959
cycle = 3  norm(lambda1,lambda2) = 0.0121083
cycle = 4  norm(lambda1,lambda2) = 0.00370874
cycle = 5  norm(lambda1,lambda2) = 0.00151977
cycle = 6  norm(lambda1,lambda2) = 0.000520628
cycle = 7  norm(lambda1,lambda2) = 0.000160515
cycle = 8  norm(lambda1,lambda2) = 5.16252e-05
cycle = 9  norm(lambda1,lambda2) = 1.52846e-05
cycle = 10  norm(lambda1,lambda2) = 5.55609e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0005494443     0.0000000004     0.0000000013
1 H    -0.0005494443    -0.0000000004    -0.0000000013
----------------------------------------------
cycle 3: E = -38.4244762708  dE = -8.0055e-06  norm(grad) = 0.000777032

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   C  -0.041146  -0.000000  -0.000000   -0.000406 -0.000000 -0.000000
   H   1.041146   0.000000   0.000000    0.000406  0.000000  0.000000
New geometry
   1 C     -0.041146396662  -0.000000080736  -0.000000195962 AA   -0.077755420704  -0.000000152568  -0.000000370314 Bohr

   2 H      1.041146396688   0.000000080736   0.000000195962 AA    1.967481545319   0.000000152568   0.000000370314 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 383 MB)
number electrons alpha = 5  beta = 2
init E= -38.2915262670488
  alpha nocc = 5  HOMO = -0.436453061629896  LUMO = 0.105954689880152
  beta  nocc = 2  HOMO = -0.692171136272338  LUMO = 0.0413370816455061
cycle= 1 E= -38.2918821653115  delta_E= -0.000356  |g|= 0.000141  |ddm|= 0.000322
  alpha nocc = 5  HOMO = -0.436281024363431  LUMO = 0.106057609217249
  beta  nocc = 2  HOMO = -0.692056098243296  LUMO = 0.0414604369648424
cycle= 2 E= -38.2918821835946  delta_E= -1.83e-08  |g|= 4.52e-05  |ddm|= 0.0001
  alpha nocc = 5  HOMO = -0.436310154638914  LUMO = 0.106050834131581
  beta  nocc = 2  HOMO = -0.692096438359275  LUMO = 0.0414401743612674
cycle= 3 E= -38.2918821861584  delta_E= -2.56e-09  |g|= 2.19e-05  |ddm|= 4.25e-05
  alpha nocc = 5  HOMO = -0.436306816991956  LUMO = 0.106049910270111
  beta  nocc = 2  HOMO = -0.692090157201327  LUMO = 0.041438787927724
cycle= 4 E= -38.2918821872855  delta_E= -1.13e-09  |g|= 8.75e-06  |ddm|= 3.8e-05
  alpha nocc = 5  HOMO = -0.436307365826229  LUMO = 0.106050075735084
  beta  nocc = 2  HOMO = -0.692087969406208  LUMO = 0.0414367228843225
cycle= 5 E= -38.2918821874725  delta_E= -1.87e-10  |g|= 2.74e-06  |ddm|= 2.03e-05
  alpha nocc = 5  HOMO = -0.436306064742812  LUMO = 0.106050060833291
  beta  nocc = 2  HOMO = -0.692088098501685  LUMO = 0.0414375876182928
cycle= 6 E= -38.2918821874844  delta_E= -1.18e-11  |g|= 6.34e-07  |ddm|= 5.42e-06
  alpha nocc = 5  HOMO = -0.436306353367738  LUMO = 0.106050025214345
  beta  nocc = 2  HOMO = -0.692088564057178  LUMO = 0.041437343674243
Extra cycle  E= -38.2918821874849  delta_E= -5.26e-13  |g|= 3.06e-07  |ddm|= 5.58e-07
converged SCF energy = -38.2918821874849  <S^2> = 3.7543616  2S+1 = 4.0021802

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (5, 2), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3515 MB)
Init E_corr(CCSD) = -0.09709839382911
cycle = 1  E_corr(CCSD) = -0.128748555007977  dE = -0.0316501612  norm(t1,t2) = 0.13262
cycle = 2  E_corr(CCSD) = -0.131310064395365  dE = -0.00256150939  norm(t1,t2) = 0.0293492
cycle = 3  E_corr(CCSD) = -0.132400382131265  dE = -0.00109031774  norm(t1,t2) = 0.0104682
cycle = 4  E_corr(CCSD) = -0.132473697536493  dE = -7.33154052e-05  norm(t1,t2) = 0.00331138
cycle = 5  E_corr(CCSD) = -0.132549803193233  dE = -7.61056567e-05  norm(t1,t2) = 0.00121576
cycle = 6  E_corr(CCSD) = -0.132584289118747  dE = -3.44859255e-05  norm(t1,t2) = 0.000474896
cycle = 7  E_corr(CCSD) = -0.132591891328861  dE = -7.60221011e-06  norm(t1,t2) = 0.000136627
cycle = 8  E_corr(CCSD) = -0.132594171715693  dE = -2.28038683e-06  norm(t1,t2) = 3.94863e-05
cycle = 9  E_corr(CCSD) = -0.132594443705539  dE = -2.71989846e-07  norm(t1,t2) = 1.25666e-05
cycle = 10  E_corr(CCSD) = -0.132594482983798  dE = -3.92782587e-08  norm(t1,t2) = 4.70117e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -38.42447667046869  E_corr = -0.1325944829837978
cycle = 1  norm(lambda1,lambda2) = 0.129933
cycle = 2  norm(lambda1,lambda2) = 0.0275441
cycle = 3  norm(lambda1,lambda2) = 0.00989513
cycle = 4  norm(lambda1,lambda2) = 0.00322074
cycle = 5  norm(lambda1,lambda2) = 0.00122629
cycle = 6  norm(lambda1,lambda2) = 0.000453844
cycle = 7  norm(lambda1,lambda2) = 0.00013007
cycle = 8  norm(lambda1,lambda2) = 3.94907e-05
cycle = 9  norm(lambda1,lambda2) = 1.30398e-05
cycle = 10  norm(lambda1,lambda2) = 4.77884e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 C     0.0000062489     0.0000000000     0.0000000000
1 H    -0.0000062489    -0.0000000000    -0.0000000000
----------------------------------------------
cycle 4: E = -38.4244766705  dE = -3.99703e-07  norm(grad) = 8.83725e-06
