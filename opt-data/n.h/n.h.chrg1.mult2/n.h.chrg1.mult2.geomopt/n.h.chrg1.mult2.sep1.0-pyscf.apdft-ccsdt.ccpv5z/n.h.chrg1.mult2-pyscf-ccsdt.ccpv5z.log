#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/n.h/n.h.chrg1.mult2/n.h.chrg1.mult2.geomopt/n.h.chrg1.mult2.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['N', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = 1
multiplicity = 2
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n186.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 7
[INPUT] charge = 1
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 3.70424047644
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         1.81
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 145 MB)
number electrons alpha = 4  beta = 3
init E= -54.533597722234

WARN: alpha nocc = 4  HOMO -0.20522685508158 >= LUMO -0.205226855081569

  beta  nocc = 3  HOMO = -0.399769386774604  LUMO = -0.20522685508158

WARN: system HOMO -0.20522685508158 >= system LUMO -0.20522685508158

cycle= 1 E= -54.3668372820351  delta_E= 0.167  |g|= 0.485  |ddm|= 0.552
  alpha nocc = 4  HOMO = -1.14943168874588  LUMO = -0.594920583119063
  beta  nocc = 3  HOMO = -1.15675955765646  LUMO = -0.563375939717069
cycle= 2 E= -54.505804883338  delta_E= -0.139  |g|= 0.136  |ddm|= 0.37
  alpha nocc = 4  HOMO = -1.02953065282598  LUMO = -0.419871334044895
  beta  nocc = 3  HOMO = -1.02209922872741  LUMO = -0.390844380771973
cycle= 3 E= -54.5116489404192  delta_E= -0.00584  |g|= 0.0258  |ddm|= 0.0755
  alpha nocc = 4  HOMO = -1.04052512955115  LUMO = -0.413525043283653
  beta  nocc = 3  HOMO = -1.01930566122783  LUMO = -0.385182785073121
cycle= 4 E= -54.5122243625638  delta_E= -0.000575  |g|= 0.00687  |ddm|= 0.0251
  alpha nocc = 4  HOMO = -1.04278149768524  LUMO = -0.413161641137099
  beta  nocc = 3  HOMO = -1.01766698914117  LUMO = -0.384648556941427
cycle= 5 E= -54.5122725085911  delta_E= -4.81e-05  |g|= 0.00205  |ddm|= 0.00701
  alpha nocc = 4  HOMO = -1.04377429029573  LUMO = -0.413523082520509
  beta  nocc = 3  HOMO = -1.01729506571266  LUMO = -0.384722138144989
cycle= 6 E= -54.5122780617894  delta_E= -5.55e-06  |g|= 0.000637  |ddm|= 0.00256
  alpha nocc = 4  HOMO = -1.04362635448612  LUMO = -0.413464245061154
  beta  nocc = 3  HOMO = -1.01696689547565  LUMO = -0.384633043631739
cycle= 7 E= -54.512278739335  delta_E= -6.78e-07  |g|= 0.000162  |ddm|= 0.000894
  alpha nocc = 4  HOMO = -1.04359156535115  LUMO = -0.413466594801738
  beta  nocc = 3  HOMO = -1.01695207359104  LUMO = -0.384653841908586
cycle= 8 E= -54.5122787758577  delta_E= -3.65e-08  |g|= 2.23e-05  |ddm|= 0.000296
  alpha nocc = 4  HOMO = -1.04359274445567  LUMO = -0.413466858720817
  beta  nocc = 3  HOMO = -1.01696046933249  LUMO = -0.384655273918836
cycle= 9 E= -54.5122787763224  delta_E= -4.65e-10  |g|= 3.9e-06  |ddm|= 3.34e-05
  alpha nocc = 4  HOMO = -1.04359151330388  LUMO = -0.413467897537289
  beta  nocc = 3  HOMO = -1.01696321727221  LUMO = -0.384655925901091
cycle= 10 E= -54.5122787763374  delta_E= -1.5e-11  |g|= 7.83e-07  |ddm|= 5.81e-06
  alpha nocc = 4  HOMO = -1.04359142352447  LUMO = -0.413467757184126
  beta  nocc = 3  HOMO = -1.01696333661005  LUMO = -0.384655726760185
Extra cycle  E= -54.5122787763378  delta_E= -4.05e-13  |g|= 3.49e-07  |ddm|= 7.21e-07
converged SCF energy = -54.5122787763378  <S^2> = 0.75645394  2S+1 = 2.0064436

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3330 MB)
Init t2, MP2 energy = -0.156182675892708
Init E_corr(CCSD) = -0.156182675892778
cycle = 1  E_corr(CCSD) = -0.171428614865699  dE = -0.015245939  norm(t1,t2) = 0.0426799
cycle = 2  E_corr(CCSD) = -0.17610383614883  dE = -0.00467522128  norm(t1,t2) = 0.0210818
cycle = 3  E_corr(CCSD) = -0.179838427552731  dE = -0.0037345914  norm(t1,t2) = 0.0124201
cycle = 4  E_corr(CCSD) = -0.179807796652075  dE = 3.06309007e-05  norm(t1,t2) = 0.00391876
cycle = 5  E_corr(CCSD) = -0.179813442128072  dE = -5.645476e-06  norm(t1,t2) = 0.00158743
cycle = 6  E_corr(CCSD) = -0.179863536745702  dE = -5.00946176e-05  norm(t1,t2) = 0.000661854
cycle = 7  E_corr(CCSD) = -0.179857976808276  dE = 5.55993743e-06  norm(t1,t2) = 0.000177839
cycle = 8  E_corr(CCSD) = -0.179855235757125  dE = 2.74105115e-06  norm(t1,t2) = 4.45982e-05
cycle = 9  E_corr(CCSD) = -0.179855834358006  dE = -5.98600881e-07  norm(t1,t2) = 1.62495e-05
cycle = 10  E_corr(CCSD) = -0.179855626171917  dE = 2.08186089e-07  norm(t1,t2) = 5.90039e-06
cycle = 11  E_corr(CCSD) = -0.179855625792174  dE = 3.79742848e-10  norm(t1,t2) = 2.11515e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -54.69213440212997  E_corr = -0.1798556257921741
cycle = 1  norm(lambda1,lambda2) = 0.00691997
cycle = 2  norm(lambda1,lambda2) = 0.00178053
cycle = 3  norm(lambda1,lambda2) = 0.000883287
cycle = 4  norm(lambda1,lambda2) = 0.000336189
cycle = 5  norm(lambda1,lambda2) = 0.000148271
cycle = 6  norm(lambda1,lambda2) = 6.63574e-05
cycle = 7  norm(lambda1,lambda2) = 2.11668e-05
cycle = 8  norm(lambda1,lambda2) = 5.79126e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0513021246     0.0000000000     0.0000000000
1 H    -0.0513021246    -0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -54.6921344021  dE = -54.6921  norm(grad) = 0.0725522

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.028464  -0.000000  -0.000000   -0.028464 -0.000000 -0.000000
   H   1.028464   0.000000   0.000000    0.028464  0.000000  0.000000
New geometry
   1 N     -0.028463897971  -0.000000000000  -0.000000000000 AA   -0.053788971602  -0.000000000000  -0.000000000000 Bohr

   2 H      1.028463897927   0.000000000000   0.000000000000 AA    1.943515096085   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 365 MB)
number electrons alpha = 4  beta = 3
init E= -54.4732992109148
  alpha nocc = 4  HOMO = -1.05017752391205  LUMO = -0.421282458229975
  beta  nocc = 3  HOMO = -1.01847632700017  LUMO = -0.392101140858002
cycle= 1 E= -54.514015706269  delta_E= -0.0407  |g|= 0.0129  |ddm|= 0.0201
  alpha nocc = 4  HOMO = -1.03613568750913  LUMO = -0.40674090810738
  beta  nocc = 3  HOMO = -1.00270873950772  LUMO = -0.378007916941159
cycle= 2 E= -54.5140959204658  delta_E= -8.02e-05  |g|= 0.0023  |ddm|= 0.00557
  alpha nocc = 4  HOMO = -1.03828763340612  LUMO = -0.408857697641677
  beta  nocc = 3  HOMO = -1.00391215173009  LUMO = -0.380062342630088
cycle= 3 E= -54.5140993401614  delta_E= -3.42e-06  |g|= 0.000595  |ddm|= 0.00167
  alpha nocc = 4  HOMO = -1.0381281518341  LUMO = -0.408654783741626
  beta  nocc = 3  HOMO = -1.00358185456349  LUMO = -0.379874957520257
cycle= 4 E= -54.5140997447803  delta_E= -4.05e-07  |g|= 0.000254  |ddm|= 0.000496
  alpha nocc = 4  HOMO = -1.03824719343758  LUMO = -0.408735626432925
  beta  nocc = 3  HOMO = -1.00356255292754  LUMO = -0.379951239022764
cycle= 5 E= -54.5140998441087  delta_E= -9.93e-08  |g|= 0.000118  |ddm|= 0.000276
  alpha nocc = 4  HOMO = -1.03823505045015  LUMO = -0.408705461697288
  beta  nocc = 3  HOMO = -1.00348276408667  LUMO = -0.379916380973769
cycle= 6 E= -54.5140998724831  delta_E= -2.84e-08  |g|= 2.9e-05  |ddm|= 0.000198
  alpha nocc = 4  HOMO = -1.03824075386303  LUMO = -0.408713881136203
  beta  nocc = 3  HOMO = -1.00348793388963  LUMO = -0.37992197612876
cycle= 7 E= -54.5140998737091  delta_E= -1.23e-09  |g|= 5.14e-06  |ddm|= 4.7e-05
  alpha nocc = 4  HOMO = -1.03823892709437  LUMO = -0.40871431546813
  beta  nocc = 3  HOMO = -1.00348943794467  LUMO = -0.379921983612559
cycle= 8 E= -54.5140998737358  delta_E= -2.67e-11  |g|= 8.06e-07  |ddm|= 5.42e-06
  alpha nocc = 4  HOMO = -1.03823867442318  LUMO = -0.408714286538732
  beta  nocc = 3  HOMO = -1.00348954964555  LUMO = -0.379921941146602
Extra cycle  E= -54.5140998737361  delta_E= -3.27e-13  |g|= 3.28e-07  |ddm|= 1.08e-06
converged SCF energy = -54.5140998737361  <S^2> = 0.75689674  2S+1 = 2.0068849

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3497 MB)
Init E_corr(CCSD) = -0.0777760514886381
cycle = 1  E_corr(CCSD) = -0.170977762150821  dE = -0.0932017107  norm(t1,t2) = 0.187265
cycle = 2  E_corr(CCSD) = -0.178112145412235  dE = -0.00713438326  norm(t1,t2) = 0.0354998
cycle = 3  E_corr(CCSD) = -0.180722280287938  dE = -0.00261013488  norm(t1,t2) = 0.0112051
cycle = 4  E_corr(CCSD) = -0.18087009159212  dE = -0.000147811304  norm(t1,t2) = 0.00260993
cycle = 5  E_corr(CCSD) = -0.18092274656335  dE = -5.26549712e-05  norm(t1,t2) = 0.000980837
cycle = 6  E_corr(CCSD) = -0.18094253129677  dE = -1.97847334e-05  norm(t1,t2) = 0.000494755
cycle = 7  E_corr(CCSD) = -0.180943793780543  dE = -1.26248377e-06  norm(t1,t2) = 0.000311125
cycle = 8  E_corr(CCSD) = -0.180939093448151  dE = 4.70033239e-06  norm(t1,t2) = 0.000212653
cycle = 9  E_corr(CCSD) = -0.180937291748194  dE = 1.80169996e-06  norm(t1,t2) = 0.000113832
cycle = 10  E_corr(CCSD) = -0.180936922175993  dE = 3.69572201e-07  norm(t1,t2) = 6.32924e-05
cycle = 11  E_corr(CCSD) = -0.18093752672618  dE = -6.04550187e-07  norm(t1,t2) = 4.77921e-05
cycle = 12  E_corr(CCSD) = -0.180938006895831  dE = -4.80169651e-07  norm(t1,t2) = 4.34719e-05
cycle = 13  E_corr(CCSD) = -0.180938463615713  dE = -4.56719882e-07  norm(t1,t2) = 4.06895e-05
cycle = 14  E_corr(CCSD) = -0.180938949792517  dE = -4.86176804e-07  norm(t1,t2) = 3.45007e-05
cycle = 15  E_corr(CCSD) = -0.180938427290634  dE = 5.22501883e-07  norm(t1,t2) = 2.10666e-05
cycle = 16  E_corr(CCSD) = -0.180938186852844  dE = 2.4043779e-07  norm(t1,t2) = 1.00314e-05
cycle = 17  E_corr(CCSD) = -0.180938016414614  dE = 1.70438231e-07  norm(t1,t2) = 4.52093e-06
cycle = 18  E_corr(CCSD) = -0.180938012286837  dE = 4.1277767e-09  norm(t1,t2) = 1.98968e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -54.69503788602294  E_corr = -0.1809380122868371
cycle = 1  norm(lambda1,lambda2) = 0.183918
cycle = 2  norm(lambda1,lambda2) = 0.0323529
cycle = 3  norm(lambda1,lambda2) = 0.0102983
cycle = 4  norm(lambda1,lambda2) = 0.00260354
cycle = 5  norm(lambda1,lambda2) = 0.000994482
cycle = 6  norm(lambda1,lambda2) = 0.00045969
cycle = 7  norm(lambda1,lambda2) = 0.000281355
cycle = 8  norm(lambda1,lambda2) = 0.000194739
cycle = 9  norm(lambda1,lambda2) = 0.000105446
cycle = 10  norm(lambda1,lambda2) = 5.91158e-05
cycle = 11  norm(lambda1,lambda2) = 4.3157e-05
cycle = 12  norm(lambda1,lambda2) = 3.81164e-05
cycle = 13  norm(lambda1,lambda2) = 3.54419e-05
cycle = 14  norm(lambda1,lambda2) = 3.06842e-05
cycle = 15  norm(lambda1,lambda2) = 2.01912e-05
cycle = 16  norm(lambda1,lambda2) = 1.08869e-05
cycle = 17  norm(lambda1,lambda2) = 5.53463e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0054227709     0.0000000648    -0.0000000593
1 H    -0.0054227709    -0.0000000648     0.0000000593
----------------------------------------------
cycle 2: E = -54.695037886  dE = -0.00290348  norm(grad) = 0.00766896

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.031828  -0.000002   0.000002   -0.003364 -0.000002  0.000002
   H   1.031828   0.000002  -0.000002    0.003364  0.000002 -0.000002
New geometry
   1 N     -0.031828225996  -0.000001712418   0.000001568655 AA   -0.060146630162  -0.000003236000   0.000002964328 Bohr

   2 H      1.031828226007   0.000001712418  -0.000001568655 AA    1.949872754748   0.000003236000  -0.000002964328 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 446 MB)
number electrons alpha = 4  beta = 3
init E= -54.5094981755363
  alpha nocc = 4  HOMO = -1.03899070046746  LUMO = -0.409588867352154
  beta  nocc = 3  HOMO = -1.00358602520411  LUMO = -0.380754890929717
cycle= 1 E= -54.5140020802364  delta_E= -0.0045  |g|= 0.0015  |ddm|= 0.00236
  alpha nocc = 4  HOMO = -1.03737913083391  LUMO = -0.407929106889531
  beta  nocc = 3  HOMO = -1.00176910178404  LUMO = -0.379144871419822
cycle= 2 E= -54.5140031638469  delta_E= -1.08e-06  |g|= 0.000264  |ddm|= 0.000645
  alpha nocc = 4  HOMO = -1.03761905702827  LUMO = -0.408166671473108
  beta  nocc = 3  HOMO = -1.00189866172056  LUMO = -0.379375161948839
cycle= 3 E= -54.5140032105947  delta_E= -4.67e-08  |g|= 7.29e-05  |ddm|= 0.00019
  alpha nocc = 4  HOMO = -1.03760123920298  LUMO = -0.408144223757516
  beta  nocc = 3  HOMO = -1.00185990061289  LUMO = -0.379354308423643
cycle= 4 E= -54.5140032169464  delta_E= -6.35e-09  |g|= 3.38e-05  |ddm|= 6.08e-05
  alpha nocc = 4  HOMO = -1.03761622856437  LUMO = -0.408154630540874
  beta  nocc = 3  HOMO = -1.00185641150361  LUMO = -0.379363944141002
cycle= 5 E= -54.5140032188466  delta_E= -1.9e-09  |g|= 1.54e-05  |ddm|= 3.87e-05
  alpha nocc = 4  HOMO = -1.0376139900521  LUMO = -0.408150430276202
  beta  nocc = 3  HOMO = -1.00184592408478  LUMO = -0.379359042245282
cycle= 6 E= -54.5140032193318  delta_E= -4.85e-10  |g|= 3.36e-06  |ddm|= 2.68e-05
  alpha nocc = 4  HOMO = -1.03761468205857  LUMO = -0.408151493697496
  beta  nocc = 3  HOMO = -1.0018468291136  LUMO = -0.379359761415141
cycle= 7 E= -54.514003219347  delta_E= -1.52e-11  |g|= 6.05e-07  |ddm|= 5.23e-06
  alpha nocc = 4  HOMO = -1.03761454300565  LUMO = -0.40815152564321
  beta  nocc = 3  HOMO = -1.00184696696518  LUMO = -0.379359760388167
Extra cycle  E= -54.5140032193474  delta_E= -3.55e-13  |g|= 2.51e-07  |ddm|= 4.44e-07
converged SCF energy = -54.5140032193474  <S^2> = 0.7569596  2S+1 = 2.0069475

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3532 MB)
Init E_corr(CCSD) = -0.167662798084318
cycle = 1  E_corr(CCSD) = -0.180345957494467  dE = -0.0126831594  norm(t1,t2) = 0.0551586
cycle = 2  E_corr(CCSD) = -0.180836853462324  dE = -0.000490895968  norm(t1,t2) = 0.0123297
cycle = 3  E_corr(CCSD) = -0.181080031220267  dE = -0.000243177758  norm(t1,t2) = 0.00381764
cycle = 4  E_corr(CCSD) = -0.181078609933814  dE = 1.42128645e-06  norm(t1,t2) = 0.000862877
cycle = 5  E_corr(CCSD) = -0.181079687655829  dE = -1.07772201e-06  norm(t1,t2) = 0.000265226
cycle = 6  E_corr(CCSD) = -0.181079742632319  dE = -5.49764903e-08  norm(t1,t2) = 0.000105269
cycle = 7  E_corr(CCSD) = -0.181078188601037  dE = 1.55403128e-06  norm(t1,t2) = 5.16249e-05
cycle = 8  E_corr(CCSD) = -0.181076122069361  dE = 2.06653168e-06  norm(t1,t2) = 2.34515e-05
cycle = 9  E_corr(CCSD) = -0.181075542150972  dE = 5.79918389e-07  norm(t1,t2) = 8.42133e-06
cycle = 10  E_corr(CCSD) = -0.181075448398835  dE = 9.37521367e-08  norm(t1,t2) = 2.31604e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -54.69507866774619  E_corr = -0.1810754483988352
cycle = 1  norm(lambda1,lambda2) = 0.0532325
cycle = 2  norm(lambda1,lambda2) = 0.0116164
cycle = 3  norm(lambda1,lambda2) = 0.00357829
cycle = 4  norm(lambda1,lambda2) = 0.000807358
cycle = 5  norm(lambda1,lambda2) = 0.000241963
cycle = 6  norm(lambda1,lambda2) = 8.74642e-05
cycle = 7  norm(lambda1,lambda2) = 3.96905e-05
cycle = 8  norm(lambda1,lambda2) = 1.8296e-05
cycle = 9  norm(lambda1,lambda2) = 7.66886e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0010177297    -0.0000000145     0.0000000113
1 H    -0.0010177297     0.0000000145    -0.0000000113
----------------------------------------------
cycle 3: E = -54.6950786677  dE = -4.07817e-05  norm(grad) = 0.00143929

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.032606  -0.000001   0.000001   -0.000777  0.000000 -0.000000
   H   1.032606   0.000001  -0.000001    0.000777 -0.000000  0.000000
New geometry
   1 N     -0.032605511969  -0.000001231210   0.000001185323 AA   -0.061615487773  -0.000002326650   0.000002239936 Bohr

   2 H      1.032605511972   0.000001231210  -0.000001185323 AA    1.951341612343   0.000002326650  -0.000002239936 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 398 MB)
number electrons alpha = 4  beta = 3
init E= -54.5129386862696
  alpha nocc = 4  HOMO = -1.03778786098509  LUMO = -0.408352563815696
  beta  nocc = 3  HOMO = -1.00186705090391  LUMO = -0.37955122348794
cycle= 1 E= -54.5139726650789  delta_E= -0.00103  |g|= 0.000346  |ddm|= 0.000545
  alpha nocc = 4  HOMO = -1.03741641715406  LUMO = -0.407970337617259
  beta  nocc = 3  HOMO = -1.00144846448447  LUMO = -0.379180397462482
cycle= 2 E= -54.5139727226923  delta_E= -5.76e-08  |g|= 6.08e-05  |ddm|= 0.000149
  alpha nocc = 4  HOMO = -1.03747150664238  LUMO = -0.408024940560167
  beta  nocc = 3  HOMO = -1.00147812906245  LUMO = -0.379233312542949
cycle= 3 E= -54.5139727251853  delta_E= -2.49e-09  |g|= 1.7e-05  |ddm|= 4.38e-05
  alpha nocc = 4  HOMO = -1.03746739736458  LUMO = -0.408019783559228
  beta  nocc = 3  HOMO = -1.00146916417271  LUMO = -0.379228514618833
cycle= 4 E= -54.5139727255318  delta_E= -3.47e-10  |g|= 7.95e-06  |ddm|= 1.42e-05
  alpha nocc = 4  HOMO = -1.03747089840947  LUMO = -0.408022223515569
  beta  nocc = 3  HOMO = -1.00146831294731  LUMO = -0.379230766526175
cycle= 5 E= -54.5139727256382  delta_E= -1.06e-10  |g|= 3.61e-06  |ddm|= 9.19e-06
  alpha nocc = 4  HOMO = -1.03747035312443  LUMO = -0.408021230263981
  beta  nocc = 3  HOMO = -1.00146585231577  LUMO = -0.379229605483085
cycle= 6 E= -54.5139727256649  delta_E= -2.67e-11  |g|= 7.77e-07  |ddm|= 6.32e-06
  alpha nocc = 4  HOMO = -1.03747054504202  LUMO = -0.408021510939396
  beta  nocc = 3  HOMO = -1.0014661841577  LUMO = -0.379229835588848
Extra cycle  E= -54.5139727256656  delta_E= -6.47e-13  |g|= 3.83e-07  |ddm|= 6.49e-07
converged SCF energy = -54.5139727256656  <S^2> = 0.75697445  2S+1 = 2.0069623

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3531 MB)
Init E_corr(CCSD) = -0.16897728680946
cycle = 1  E_corr(CCSD) = -0.18029576808883  dE = -0.0113184813  norm(t1,t2) = 0.0756216
cycle = 2  E_corr(CCSD) = -0.181029668873282  dE = -0.000733900784  norm(t1,t2) = 0.0149434
cycle = 3  E_corr(CCSD) = -0.181171996243059  dE = -0.00014232737  norm(t1,t2) = 0.00457907
cycle = 4  E_corr(CCSD) = -0.18114197971306  dE = 3.001653e-05  norm(t1,t2) = 0.000817949
cycle = 5  E_corr(CCSD) = -0.181120785167659  dE = 2.11945454e-05  norm(t1,t2) = 0.000208535
cycle = 6  E_corr(CCSD) = -0.181112957074151  dE = 7.82809351e-06  norm(t1,t2) = 9.21205e-05
cycle = 7  E_corr(CCSD) = -0.181108382830039  dE = 4.57424411e-06  norm(t1,t2) = 4.90935e-05
cycle = 8  E_corr(CCSD) = -0.181107337350223  dE = 1.04547982e-06  norm(t1,t2) = 1.94926e-05
cycle = 9  E_corr(CCSD) = -0.18110744144462  dE = -1.04094396e-07  norm(t1,t2) = 6.99762e-06
cycle = 10  E_corr(CCSD) = -0.181107492962556  dE = -5.15179368e-08  norm(t1,t2) = 2.58044e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -54.69508021862813  E_corr = -0.1811074929625565
cycle = 1  norm(lambda1,lambda2) = 0.0723247
cycle = 2  norm(lambda1,lambda2) = 0.0137041
cycle = 3  norm(lambda1,lambda2) = 0.00414673
cycle = 4  norm(lambda1,lambda2) = 0.000743786
cycle = 5  norm(lambda1,lambda2) = 0.000165234
cycle = 6  norm(lambda1,lambda2) = 6.07319e-05
cycle = 7  norm(lambda1,lambda2) = 3.18391e-05
cycle = 8  norm(lambda1,lambda2) = 1.25815e-05
cycle = 9  norm(lambda1,lambda2) = 4.96215e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0000267499     0.0000000174    -0.0000000090
1 H    -0.0000267499    -0.0000000174     0.0000000090
----------------------------------------------
cycle 4: E = -54.6950802186  dE = -1.55088e-06  norm(grad) = 3.78301e-05

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.032626  -0.000002   0.000001   -0.000021 -0.000000  0.000000
   H   1.032626   0.000002  -0.000001    0.000021  0.000000 -0.000000
New geometry
   1 N     -0.032626493588  -0.000001657796   0.000001405878 AA   -0.061655137287  -0.000003132780   0.000002656725 Bohr

   2 H      1.032626493569   0.000001657796  -0.000001405878 AA    1.951381261814   0.000003132780  -0.000002656725 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 435 MB)
number electrons alpha = 4  beta = 3
init E= -54.5139439897943
  alpha nocc = 4  HOMO = -1.03747514145323  LUMO = -0.40802689280353
  beta  nocc = 3  HOMO = -1.00146669570681  LUMO = -0.379234941526529
cycle= 1 E= -54.513971860757  delta_E= -2.79e-05  |g|= 9.34e-06  |ddm|= 1.47e-05
  alpha nocc = 4  HOMO = -1.0374651160334  LUMO = -0.40801659421168
  beta  nocc = 3  HOMO = -1.0014554058704  LUMO = -0.379224939952636
cycle= 2 E= -54.513971860799  delta_E= -4.2e-11  |g|= 1.67e-06  |ddm|= 4.03e-06
  alpha nocc = 4  HOMO = -1.03746659413416  LUMO = -0.408018066329892
  beta  nocc = 3  HOMO = -1.00145619402554  LUMO = -0.379226360793033
cycle= 3 E= -54.513971860801  delta_E= -1.98e-12  |g|= 5.24e-07  |ddm|= 1.2e-06
  alpha nocc = 4  HOMO = -1.03746647373927  LUMO = -0.40801792381687
  beta  nocc = 3  HOMO = -1.00145596522833  LUMO = -0.379226224333115
Extra cycle  E= -54.5139718608013  delta_E= -2.77e-13  |g|= 3.07e-07  |ddm|= 3.48e-07
converged SCF energy = -54.5139718608013  <S^2> = 0.75697486  2S+1 = 2.0069627

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (4, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3521 MB)
Init E_corr(CCSD) = -0.181107178718957
cycle = 1  E_corr(CCSD) = -0.181108074255099  dE = -8.95536142e-07  norm(t1,t2) = 5.81187e-05
cycle = 2  E_corr(CCSD) = -0.181108241315402  dE = -1.67060303e-07  norm(t1,t2) = 1.20049e-05
cycle = 3  E_corr(CCSD) = -0.181108328572953  dE = -8.72575513e-08  norm(t1,t2) = 3.69537e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -54.6950801893742  E_corr = -0.1811083285729532
cycle = 1  norm(lambda1,lambda2) = 5.60775e-05
cycle = 2  norm(lambda1,lambda2) = 1.15803e-05
cycle = 3  norm(lambda1,lambda2) = 3.82394e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N    -0.0000000523    -0.0000000402     0.0000000182
1 H     0.0000000523     0.0000000402    -0.0000000182
----------------------------------------------
cycle 5: E = -54.6950801894  dE = 2.92539e-08  norm(grad) = 9.67359e-08
