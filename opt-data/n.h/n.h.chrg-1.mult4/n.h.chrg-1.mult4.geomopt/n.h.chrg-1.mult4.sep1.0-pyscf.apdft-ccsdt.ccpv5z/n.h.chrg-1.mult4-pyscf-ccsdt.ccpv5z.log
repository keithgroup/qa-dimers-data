#INFO: **** input file is /ihome/jkeith/amm503/projects/apdft/dimer-geo-opt/n.h/n.h.chrg-1.mult4/n.h.chrg-1.mult4.geomopt/n.h.chrg-1.mult4.sep1.0-pyscf.apdft-ccsdt.ccpv5z/apdft-pyscf-calc.py ****

import os
import pathlib
import re
import numpy as np
import json
import pyscf
import pyscf.gto
import pyscf.qmmm
from pyscf import scf
import pyscf.dft
import pyscf.lib
import pyscf.mp
from pyscf.geomopt.geometric_solver import optimize
from pyscf import __version__ as pyscf_version
import findiff
import matplotlib.pyplot as plt

try:
    import cclib
    has_cclib = True
except:
    has_cclib = False

try:
    from mpi4pyscf import scf
except:
    pass

# Specifying system.
atoms = ['N', 'H']
dimer_sep = 1.0  # `None` if a single atom, float if dimer (in Angstroms).
charge = -1
multiplicity = 4
scf_conv_tol = 1e-09  # Default: 1e-9
scf_conv_tol_grad = 1e-06  # Default: 3.162e-6
cc_conv_tol = 1e-07  # Default: 1e-7
cc_conv_tol_normt = 1e-05  # Default: 1e-5

scf_diis_space = 16  # Default: 8
cc_diis_space = 12  # Default: 6

# Specifying calculation.
qc_method = 'CCSD(T)'
basis_set = 'cc-pV5Z'  # cc-pV5Z
n_cores = 6  # Number of cores used on SMP (used for max memory).





#####     NO CHANGES NEEDED BELOW     #####


# Setting up paths.
work_dir = str(pathlib.Path(__file__).parent.resolve())
if work_dir[-1] == '/': work_dir = work_dir[:-1]  # Ensures path does NOT end in '/'

_element_to_z = {
    'H': 1, 'He': 2, 'Li': 3, 'Be': 4, 'B': 5, 'C': 6, 'N': 7, 'O': 8, 'F': 9,
    'Ne': 10, 'Na': 11, 'Mg': 12, 'Al': 13, 'Si': 14, 'P': 15, 'S': 16,
    'Cl': 17, 'Ar': 18
}

def atoms_by_number(atom_list):
    return [_element_to_z[i] for i in atom_list]

qc_method_lower = qc_method.lower()
atomic_numbers = atoms_by_number(atoms)
qc_method_label = qc_method

# Plot colors
ref_color = 'dimgrey'

def get_sys_label(atoms, charge, multiplicity, dimer_sep=None):
    atoms_label = '.'.join([i.lower() for i in atoms])
    return f'{atoms_label}.chrg{charge}.mult{multiplicity}'

def get_calc_label(sys_label, qc_method, basis_set):
    pattern = re.compile('[\W_]+')
    qc_method_label = pattern.sub('', qc_method.lower())
    basis_set_label = pattern.sub('', basis_set.lower())
    return f'{sys_label}-pyscf-{qc_method_label}.{basis_set_label}'

# Prepares molecular structures.
mol = pyscf.gto.Mole()

## Atomic coordinates in units of Angstrom.
mol.unit = 'angstrom'  # Insures Angstroms are enforced.
coords = np.array([np.zeros(3)])
mol.atom = [[atoms[0], coords[0]]]
if len(atoms) == 2:
    assert dimer_sep is not None
    coords = np.vstack((coords, np.array([dimer_sep, 0, 0])))
    mol.atom.extend([[atoms[1], coords[1]]])
elif len(atoms) == 1:
    assert dimer_sep is None

mol.charge = charge
mol.multiplicity = multiplicity
mol.basis = basis_set

# Handles cores and memory.
os.environ['OMP_NUM_THREADS'] = f'{n_cores}'  # For CRC jobs only.
mol.max_memory = 8000 * n_cores

# Handles calculation logging.
mol.verbose = 4  # Controls print level; 4 is recommended.
system_label = get_sys_label(atoms, charge, multiplicity, dimer_sep=dimer_sep)
calc_label = get_calc_label(system_label, qc_method_label, basis_set)
mol.output = f'{work_dir}/{calc_label}.log'  # Sets the output file.

# Builds the molecular structure. (Must go after everything else).
mol.build()



def _calc_distance(r1, r2):
    """Calculates the Euclidean distance between two points.

    Parameters
    ----------
    r1 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    r2 : :obj:`numpy.ndarray`
        Cartesian coordinates of a point with shape ``(3,)``.
    """
    return np.linalg.norm(r1 - r2)



calc = scf.HF(mol)

calc.chkfile = None

calc.max_cycle = 200  # Default: 50
calc.conv_tol = scf_conv_tol
calc.conv_tol_grad = scf_conv_tol_grad
calc.diis_space = scf_diis_space

cc_calc = pyscf.cc.CCSD(calc)
cc_calc.max_cycle = 200
cc_calc.conv_tol = cc_conv_tol
cc_calc.conv_tol_normt = cc_conv_tol_normt
cc_calc.diis_space = cc_diis_space

mol_eq = optimize(cc_calc, maxsteps=100)

coords = mol_eq.atom_coords(unit='Angstrom')
distance = _calc_distance(coords[0], coords[1])
print(f'Optimized bond length = {distance} A')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='smp-n188.crc.pitt.edu', release='3.10.0-1160.15.2.el7.x86_64', version='#1 SMP Thu Jan 21 16:15:07 EST 2021', machine='x86_64', processor='x86_64')  Threads 6
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.21.2  scipy 1.7.1
Date: Mon Nov 15 13:36:42 2021
PySCF version 1.7.6
PySCF path  /ihome/jkeith/amm503/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 9
[INPUT] charge = -1
[INPUT] spin (= nelec alpha-beta = 2S) = 3
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 3.70424047644
number of shells = 35
number of NR pGTOs = 166
number of NR cGTOs = 146
basis = cc-pV5Z
ecp = {}
CPU time:         1.83
Create scanner for <class 'pyscf.grad.uccsd.Gradients'>
Set <class 'pyscf.cc.uccsd.UCCSD'> as a scanner
Create scanner for <class 'pyscf.scf.uhf.UHF'>

Geometry optimization cycle 1
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N   0.000000   0.000000   0.000000    0.000000  0.000000  0.000000
   H   1.000000   0.000000   0.000000    0.000000  0.000000  0.000000
New geometry
   1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr

   2 H      1.000000000000   0.000000000000   0.000000000000 AA    1.889726124565   0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 149 MB)
number electrons alpha = 6  beta = 3
init E= -54.533597722234
  alpha nocc = 6  HOMO = 0.100981328402515  LUMO = 0.275584375016248
  beta  nocc = 3  HOMO = -0.399769386774609  LUMO = -0.205226855081576

WARN: system HOMO 0.100981328402515 >= system LUMO -0.205226855081576

cycle= 1 E= -54.8630643992712  delta_E= -0.329  |g|= 0.211  |ddm|= 10.1
  alpha nocc = 6  HOMO = 0.0846282846295486  LUMO = 0.43352570851558
  beta  nocc = 3  HOMO = -0.335906539832631  LUMO = 0.275978365429101
cycle= 2 E= -54.8887716004313  delta_E= -0.0257  |g|= 0.0851  |ddm|= 0.925
  alpha nocc = 6  HOMO = 0.088916194280871  LUMO = 0.443976182826294
  beta  nocc = 3  HOMO = -0.282047426073488  LUMO = 0.321585929639877
cycle= 3 E= -54.8926173046835  delta_E= -0.00385  |g|= 0.0283  |ddm|= 0.373
  alpha nocc = 6  HOMO = 0.087884788347842  LUMO = 0.444164550126923
  beta  nocc = 3  HOMO = -0.29201099173624  LUMO = 0.317797435447822
cycle= 4 E= -54.8936264990826  delta_E= -0.00101  |g|= 0.00829  |ddm|= 0.219
  alpha nocc = 6  HOMO = 0.0876323928854157  LUMO = 0.444970933078102
  beta  nocc = 3  HOMO = -0.289187094135851  LUMO = 0.318049757149711
cycle= 5 E= -54.8937345376556  delta_E= -0.000108  |g|= 0.00303  |ddm|= 0.0813
  alpha nocc = 6  HOMO = 0.0878367908868938  LUMO = 0.445019829832041
  beta  nocc = 3  HOMO = -0.287288641178666  LUMO = 0.318082626576512
cycle= 6 E= -54.8937514063378  delta_E= -1.69e-05  |g|= 0.000913  |ddm|= 0.0364
  alpha nocc = 6  HOMO = 0.0878539786283959  LUMO = 0.445053925223658
  beta  nocc = 3  HOMO = -0.286428345316287  LUMO = 0.318142957311795
cycle= 7 E= -54.8937530169814  delta_E= -1.61e-06  |g|= 0.000202  |ddm|= 0.0138
  alpha nocc = 6  HOMO = 0.0878494622973367  LUMO = 0.44502777603444
  beta  nocc = 3  HOMO = -0.286471719242539  LUMO = 0.318102898139253
cycle= 8 E= -54.8937530732237  delta_E= -5.62e-08  |g|= 6.21e-05  |ddm|= 0.00137
  alpha nocc = 6  HOMO = 0.0878479587521466  LUMO = 0.445025935181057
  beta  nocc = 3  HOMO = -0.286504853253325  LUMO = 0.318108476553651
cycle= 9 E= -54.8937530792163  delta_E= -5.99e-09  |g|= 1.39e-05  |ddm|= 0.000555
  alpha nocc = 6  HOMO = 0.0878481158835045  LUMO = 0.445025071831303
  beta  nocc = 3  HOMO = -0.286510001460235  LUMO = 0.318108747787959
cycle= 10 E= -54.8937530795017  delta_E= -2.85e-10  |g|= 3e-06  |ddm|= 0.000202
  alpha nocc = 6  HOMO = 0.0878479203549836  LUMO = 0.44502529285578
  beta  nocc = 3  HOMO = -0.286510864872406  LUMO = 0.318109228895622
cycle= 11 E= -54.893753079517  delta_E= -1.53e-11  |g|= 5.6e-07  |ddm|= 7.35e-05
  alpha nocc = 6  HOMO = 0.0878479340180774  LUMO = 0.445025262120076
  beta  nocc = 3  HOMO = -0.286510922217295  LUMO = 0.318109218064283
Extra cycle  E= -54.8937530795175  delta_E= -4.83e-13  |g|= 2.91e-07  |ddm|= 1.05e-05
converged SCF energy = -54.8937530795175  <S^2> = 3.7643696  2S+1 = 4.0071784

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3335 MB)
Init t2, MP2 energy = -0.194090246025182
Init E_corr(CCSD) = -0.194090246025282
cycle = 1  E_corr(CCSD) = -0.205840895823729  dE = -0.0117506498  norm(t1,t2) = 0.0413304
cycle = 2  E_corr(CCSD) = -0.209500646639857  dE = -0.00365975082  norm(t1,t2) = 0.0168518
cycle = 3  E_corr(CCSD) = -0.211391300227805  dE = -0.00189065359  norm(t1,t2) = 0.00858795
cycle = 4  E_corr(CCSD) = -0.211378046595572  dE = 1.32536322e-05  norm(t1,t2) = 0.00162997
cycle = 5  E_corr(CCSD) = -0.21131683765229  dE = 6.12089433e-05  norm(t1,t2) = 0.000699859
cycle = 6  E_corr(CCSD) = -0.211335602849087  dE = -1.87651968e-05  norm(t1,t2) = 0.000235018
cycle = 7  E_corr(CCSD) = -0.211338536638016  dE = -2.93378893e-06  norm(t1,t2) = 6.97332e-05
cycle = 8  E_corr(CCSD) = -0.211337521543413  dE = 1.0150946e-06  norm(t1,t2) = 2.54907e-05
cycle = 9  E_corr(CCSD) = -0.211337767415127  dE = -2.45871714e-07  norm(t1,t2) = 6.79467e-06
cycle = 10  E_corr(CCSD) = -0.211337860081803  dE = -9.26666765e-08  norm(t1,t2) = 1.98118e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -55.10509093959931  E_corr = -0.2113378600818034
cycle = 1  norm(lambda1,lambda2) = 0.00702365
cycle = 2  norm(lambda1,lambda2) = 0.00149152
cycle = 3  norm(lambda1,lambda2) = 0.000654804
cycle = 4  norm(lambda1,lambda2) = 0.00017251
cycle = 5  norm(lambda1,lambda2) = 6.52952e-05
cycle = 6  norm(lambda1,lambda2) = 2.01933e-05
cycle = 7  norm(lambda1,lambda2) = 6.51663e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0480668308    -0.0000000000     0.0000000000
1 H    -0.0480668308     0.0000000000    -0.0000000000
----------------------------------------------
cycle 1: E = -55.1050909396  dE = -55.1051  norm(grad) = 0.0679768

Geometry optimization cycle 2
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.026669   0.000000  -0.000000   -0.026669  0.000000 -0.000000
   H   1.026669  -0.000000   0.000000    0.026669 -0.000000  0.000000
New geometry
   1 N     -0.026668863621   0.000000000000  -0.000000000000 AA   -0.050396848298   0.000000000000  -0.000000000000 Bohr

   2 H      1.026668863669  -0.000000000000   0.000000000000 AA    1.940122972953  -0.000000000000   0.000000000000 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 485 MB)
number electrons alpha = 6  beta = 3
init E= -54.8811211101642
  alpha nocc = 6  HOMO = 0.0842209333782278  LUMO = 0.459824440381351
  beta  nocc = 3  HOMO = -0.259103832495599  LUMO = 0.336797703609356
cycle= 1 E= -54.8952824023699  delta_E= -0.0142  |g|= 0.0102  |ddm|= 1.48
  alpha nocc = 6  HOMO = 0.0846219485304235  LUMO = 0.449561161407456
  beta  nocc = 3  HOMO = -0.275574447772594  LUMO = 0.320410796818408
cycle= 2 E= -54.8953976836495  delta_E= -0.000115  |g|= 0.00404  |ddm|= 0.238
  alpha nocc = 6  HOMO = 0.0847081055393444  LUMO = 0.449150924720611
  beta  nocc = 3  HOMO = -0.276567157568899  LUMO = 0.319610434013445
cycle= 3 E= -54.8954293703104  delta_E= -3.17e-05  |g|= 0.00196  |ddm|= 0.137
  alpha nocc = 6  HOMO = 0.0850583807126011  LUMO = 0.448784697189868
  beta  nocc = 3  HOMO = -0.276507183963088  LUMO = 0.319614044858683
cycle= 4 E= -54.8954390482857  delta_E= -9.68e-06  |g|= 0.000561  |ddm|= 0.0981
  alpha nocc = 6  HOMO = 0.0850754470561589  LUMO = 0.448725384087051
  beta  nocc = 3  HOMO = -0.27665799554928  LUMO = 0.319481530210276
cycle= 5 E= -54.8954394613283  delta_E= -4.13e-07  |g|= 0.000249  |ddm|= 0.0032
  alpha nocc = 6  HOMO = 0.0850659010324545  LUMO = 0.448757120302697
  beta  nocc = 3  HOMO = -0.276512892857297  LUMO = 0.319549312887576
cycle= 6 E= -54.8954395515866  delta_E= -9.03e-08  |g|= 0.000105  |ddm|= 0.00519
  alpha nocc = 6  HOMO = 0.0850503416898383  LUMO = 0.448770476586328
  beta  nocc = 3  HOMO = -0.276491083235709  LUMO = 0.319545057864222
cycle= 7 E= -54.8954395762341  delta_E= -2.46e-08  |g|= 3.01e-05  |ddm|= 0.00378
  alpha nocc = 6  HOMO = 0.0850470351465646  LUMO = 0.448776330915929
  beta  nocc = 3  HOMO = -0.276469016439573  LUMO = 0.319547863463239
cycle= 8 E= -54.8954395780315  delta_E= -1.8e-09  |g|= 6.46e-06  |ddm|= 0.000436
  alpha nocc = 6  HOMO = 0.0850465267543668  LUMO = 0.448776976110054
  beta  nocc = 3  HOMO = -0.276464888460139  LUMO = 0.319547801367494
cycle= 9 E= -54.8954395781014  delta_E= -6.99e-11  |g|= 1.42e-06  |ddm|= 0.00015
  alpha nocc = 6  HOMO = 0.0850466439383043  LUMO = 0.448776922255614
  beta  nocc = 3  HOMO = -0.276463990504764  LUMO = 0.319547749516631
cycle= 10 E= -54.8954395781046  delta_E= -3.23e-12  |g|= 2.98e-07  |ddm|= 3.2e-05
  alpha nocc = 6  HOMO = 0.0850466517903377  LUMO = 0.448776907471322
  beta  nocc = 3  HOMO = -0.276463983136807  LUMO = 0.319547714527216
Extra cycle  E= -54.8954395781046  delta_E= 4.26e-14  |g|= 1.61e-07  |ddm|= 8.87e-06
converged SCF energy = -54.8954395781046  <S^2> = 3.7658388  2S+1 = 4.0079116

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3555 MB)
Init E_corr(CCSD) = -0.0251050937000911
cycle = 1  E_corr(CCSD) = -0.197554068890924  dE = -0.172448975  norm(t1,t2) = 0.278386
cycle = 2  E_corr(CCSD) = -0.207338923038081  dE = -0.00978485415  norm(t1,t2) = 0.0571223
cycle = 3  E_corr(CCSD) = -0.212076261105239  dE = -0.00473733807  norm(t1,t2) = 0.0200206
cycle = 4  E_corr(CCSD) = -0.212405628352532  dE = -0.000329367247  norm(t1,t2) = 0.00655806
cycle = 5  E_corr(CCSD) = -0.212508408097585  dE = -0.000102779745  norm(t1,t2) = 0.0024309
cycle = 6  E_corr(CCSD) = -0.212542866269078  dE = -3.44581715e-05  norm(t1,t2) = 0.00086553
cycle = 7  E_corr(CCSD) = -0.212537317155833  dE = 5.54911325e-06  norm(t1,t2) = 0.000281682
cycle = 8  E_corr(CCSD) = -0.212538364660271  dE = -1.04750444e-06  norm(t1,t2) = 0.000106974
cycle = 9  E_corr(CCSD) = -0.212539258689097  dE = -8.94028826e-07  norm(t1,t2) = 4.7936e-05
cycle = 10  E_corr(CCSD) = -0.212539337966832  dE = -7.92777357e-08  norm(t1,t2) = 2.6973e-05
cycle = 11  E_corr(CCSD) = -0.212539528103215  dE = -1.90136383e-07  norm(t1,t2) = 1.61367e-05
cycle = 12  E_corr(CCSD) = -0.212539428156276  dE = 9.99469397e-08  norm(t1,t2) = 7.42508e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -55.10797900626082  E_corr = -0.2125394281562756
cycle = 1  norm(lambda1,lambda2) = 0.280531
cycle = 2  norm(lambda1,lambda2) = 0.0501297
cycle = 3  norm(lambda1,lambda2) = 0.0174534
cycle = 4  norm(lambda1,lambda2) = 0.00638523
cycle = 5  norm(lambda1,lambda2) = 0.00231355
cycle = 6  norm(lambda1,lambda2) = 0.000774879
cycle = 7  norm(lambda1,lambda2) = 0.000273371
cycle = 8  norm(lambda1,lambda2) = 9.52114e-05
cycle = 9  norm(lambda1,lambda2) = 4.2675e-05
cycle = 10  norm(lambda1,lambda2) = 2.46793e-05
cycle = 11  norm(lambda1,lambda2) = 1.43158e-05
cycle = 12  norm(lambda1,lambda2) = 6.56948e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0118045722     0.0000001014    -0.0000000628
1 H    -0.0118045722    -0.0000001014     0.0000000628
----------------------------------------------
cycle 2: E = -55.1079790063  dE = -0.00288807  norm(grad) = 0.0166942

Geometry optimization cycle 3
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.035350  -0.000003   0.000002   -0.008682 -0.000003  0.000002
   H   1.035350   0.000003  -0.000002    0.008682  0.000003 -0.000002
New geometry
   1 N     -0.035350466500  -0.000003157204   0.000001954863 AA   -0.066802700060  -0.000005966252   0.000003694156 Bohr

   2 H      1.035350466474   0.000003157204  -0.000001954863 AA    1.956528824576   0.000005966252  -0.000003694156 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 565 MB)
number electrons alpha = 6  beta = 3
init E= -54.8894497679008
  alpha nocc = 6  HOMO = 0.0831135713121794  LUMO = 0.452321764584969
  beta  nocc = 3  HOMO = -0.269988876488562  LUMO = 0.323661650676358
cycle= 1 E= -54.8952506864414  delta_E= -0.0058  |g|= 0.0033  |ddm|= 0.407
  alpha nocc = 6  HOMO = 0.0839417432836864  LUMO = 0.45019100927102
  beta  nocc = 3  HOMO = -0.272564614785789  LUMO = 0.320468486010924
cycle= 2 E= -54.8952614075303  delta_E= -1.07e-05  |g|= 0.00132  |ddm|= 0.0633
  alpha nocc = 6  HOMO = 0.0838971305006147  LUMO = 0.450080153452836
  beta  nocc = 3  HOMO = -0.273066982471414  LUMO = 0.320047000131626
cycle= 3 E= -54.8952639811174  delta_E= -2.57e-06  |g|= 0.000688  |ddm|= 0.0307
  alpha nocc = 6  HOMO = 0.0839687925003121  LUMO = 0.450042769944868
  beta  nocc = 3  HOMO = -0.272834449264049  LUMO = 0.320146011032481
cycle= 4 E= -54.895264999202  delta_E= -1.02e-06  |g|= 0.000275  |ddm|= 0.0202
  alpha nocc = 6  HOMO = 0.0839976855810245  LUMO = 0.449994869580209
  beta  nocc = 3  HOMO = -0.272876621019341  LUMO = 0.320099388377783
cycle= 5 E= -54.8952651310032  delta_E= -1.32e-07  |g|= 9.54e-05  |ddm|= 0.00454
  alpha nocc = 6  HOMO = 0.0839924967012827  LUMO = 0.450004243360775
  beta  nocc = 3  HOMO = -0.272844051413878  LUMO = 0.320114282560467
cycle= 6 E= -54.8952651464609  delta_E= -1.55e-08  |g|= 3.4e-05  |ddm|= 0.00242
  alpha nocc = 6  HOMO = 0.0839882222520717  LUMO = 0.450007371044898
  beta  nocc = 3  HOMO = -0.272841593935143  LUMO = 0.320111548834748
cycle= 7 E= -54.89526514911  delta_E= -2.65e-09  |g|= 1.1e-05  |ddm|= 0.000863
  alpha nocc = 6  HOMO = 0.0839871499805025  LUMO = 0.450009103877253
  beta  nocc = 3  HOMO = -0.272834691235425  LUMO = 0.320111935385031
cycle= 8 E= -54.8952651493635  delta_E= -2.54e-10  |g|= 2.54e-06  |ddm|= 0.000163
  alpha nocc = 6  HOMO = 0.0839870085617812  LUMO = 0.450009367377934
  beta  nocc = 3  HOMO = -0.272832848446945  LUMO = 0.320111947361312
cycle= 9 E= -54.8952651493746  delta_E= -1.11e-11  |g|= 4.55e-07  |ddm|= 3.48e-05
  alpha nocc = 6  HOMO = 0.0839870410274181  LUMO = 0.450009340853758
  beta  nocc = 3  HOMO = -0.272832708486547  LUMO = 0.320111936034852
Extra cycle  E= -54.8952651493747  delta_E= -1.42e-13  |g|= 2.43e-07  |ddm|= 9.71e-06
converged SCF energy = -54.8952651493747  <S^2> = 3.7664439  2S+1 = 4.0082135

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3602 MB)
Init E_corr(CCSD) = -0.128155941836106
cycle = 1  E_corr(CCSD) = -0.208612740681463  dE = -0.0804567988  norm(t1,t2) = 0.168376
cycle = 2  E_corr(CCSD) = -0.211263207598592  dE = -0.00265046692  norm(t1,t2) = 0.0355469
cycle = 3  E_corr(CCSD) = -0.212837607778958  dE = -0.00157440018  norm(t1,t2) = 0.0110115
cycle = 4  E_corr(CCSD) = -0.212883993620239  dE = -4.63858413e-05  norm(t1,t2) = 0.0033976
cycle = 5  E_corr(CCSD) = -0.212933834248374  dE = -4.98406281e-05  norm(t1,t2) = 0.00120524
cycle = 6  E_corr(CCSD) = -0.212952420577274  dE = -1.85863289e-05  norm(t1,t2) = 0.00038554
cycle = 7  E_corr(CCSD) = -0.212953033407634  dE = -6.1283036e-07  norm(t1,t2) = 0.000123259
cycle = 8  E_corr(CCSD) = -0.212953758146859  dE = -7.24739225e-07  norm(t1,t2) = 4.33215e-05
cycle = 9  E_corr(CCSD) = -0.212954002356301  dE = -2.44209442e-07  norm(t1,t2) = 1.36134e-05
cycle = 10  E_corr(CCSD) = -0.212954101181845  dE = -9.88255446e-08  norm(t1,t2) = 4.20776e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -55.10821925055658  E_corr = -0.2129541011818453
cycle = 1  norm(lambda1,lambda2) = 0.165248
cycle = 2  norm(lambda1,lambda2) = 0.0325921
cycle = 3  norm(lambda1,lambda2) = 0.0100032
cycle = 4  norm(lambda1,lambda2) = 0.00329587
cycle = 5  norm(lambda1,lambda2) = 0.00119229
cycle = 6  norm(lambda1,lambda2) = 0.000365144
cycle = 7  norm(lambda1,lambda2) = 0.000122365
cycle = 8  norm(lambda1,lambda2) = 4.2466e-05
cycle = 9  norm(lambda1,lambda2) = 1.27798e-05
cycle = 10  norm(lambda1,lambda2) = 4.13638e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0030684456     0.0000001350    -0.0000000376
1 H    -0.0030684456    -0.0000001350     0.0000000376
----------------------------------------------
cycle 3: E = -55.1082192506  dE = -0.000240244  norm(grad) = 0.00433944

Geometry optimization cycle 4
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.038400  -0.000007   0.000003   -0.003049 -0.000004  0.000001
   H   1.038400   0.000007  -0.000003    0.003049  0.000004 -0.000001
New geometry
   1 N     -0.038399761502  -0.000007267972   0.000002991029 AA   -0.072565032488  -0.000013734477   0.000005652225 Bohr

   2 H      1.038399761384   0.000007267972  -0.000002991029 AA    1.962291156829   0.000013734477  -0.000005652225 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 589 MB)
number electrons alpha = 6  beta = 3
init E= -54.8930442240033
  alpha nocc = 6  HOMO = 0.0832441113809555  LUMO = 0.451140076953358
  beta  nocc = 3  HOMO = -0.270771195716756  LUMO = 0.321380800629768
cycle= 1 E= -54.8951346624151  delta_E= -0.00209  |g|= 0.00118  |ddm|= 0.135
  alpha nocc = 6  HOMO = 0.083589445985162  LUMO = 0.450499938357641
  beta  nocc = 3  HOMO = -0.271429736151593  LUMO = 0.320450870652212
cycle= 2 E= -54.8951359987667  delta_E= -1.34e-06  |g|= 0.000476  |ddm|= 0.0207
  alpha nocc = 6  HOMO = 0.0835674546706097  LUMO = 0.450463485522015
  beta  nocc = 3  HOMO = -0.271615176168739  LUMO = 0.320292172793844
cycle= 3 E= -54.895136309069  delta_E= -3.1e-07  |g|= 0.000249  |ddm|= 0.00964
  alpha nocc = 6  HOMO = 0.0835887082964321  LUMO = 0.450456418885564
  beta  nocc = 3  HOMO = -0.271519581486703  LUMO = 0.320331775569594
cycle= 4 E= -54.8951364373508  delta_E= -1.28e-07  |g|= 0.000103  |ddm|= 0.00615
  alpha nocc = 6  HOMO = 0.0835994260393345  LUMO = 0.450439967589775
  beta  nocc = 3  HOMO = -0.271526092752301  LUMO = 0.320318538577961
cycle= 5 E= -54.8951364569078  delta_E= -1.96e-08  |g|= 3.47e-05  |ddm|= 0.00153
  alpha nocc = 6  HOMO = 0.0835975533508755  LUMO = 0.450442969468281
  beta  nocc = 3  HOMO = -0.271516378488805  LUMO = 0.320323152757432
cycle= 6 E= -54.8951364590052  delta_E= -2.1e-09  |g|= 1.18e-05  |ddm|= 0.000861
  alpha nocc = 6  HOMO = 0.083596211099328  LUMO = 0.450443784256825
  beta  nocc = 3  HOMO = -0.271516439855931  LUMO = 0.320321828254731
cycle= 7 E= -54.895136459326  delta_E= -3.21e-10  |g|= 3.94e-06  |ddm|= 0.000252
  alpha nocc = 6  HOMO = 0.0835958844709225  LUMO = 0.450444324956702
  beta  nocc = 3  HOMO = -0.271514148977449  LUMO = 0.320321878894177
cycle= 8 E= -54.8951364593588  delta_E= -3.28e-11  |g|= 9.55e-07  |ddm|= 7.07e-05
  alpha nocc = 6  HOMO = 0.0835958692103477  LUMO = 0.450444350336727
  beta  nocc = 3  HOMO = -0.271513859788165  LUMO = 0.320321848518316
Extra cycle  E= -54.8951364593599  delta_E= -1.03e-12  |g|= 5.34e-07  |ddm|= 7.86e-06
converged SCF energy = -54.8951364593599  <S^2> = 3.7666738  2S+1 = 4.0083282

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3626 MB)
Init E_corr(CCSD) = -0.134698712621586
cycle = 1  E_corr(CCSD) = -0.209632557957269  dE = -0.0749338453  norm(t1,t2) = 0.169256
cycle = 2  E_corr(CCSD) = -0.211559853839439  dE = -0.00192729588  norm(t1,t2) = 0.0429637
cycle = 3  E_corr(CCSD) = -0.213191877736151  dE = -0.0016320239  norm(t1,t2) = 0.017708
cycle = 4  E_corr(CCSD) = -0.213062990246091  dE = 0.00012888749  norm(t1,t2) = 0.00516284
cycle = 5  E_corr(CCSD) = -0.213098521414379  dE = -3.55311683e-05  norm(t1,t2) = 0.00134101
cycle = 6  E_corr(CCSD) = -0.213104185951131  dE = -5.66453675e-06  norm(t1,t2) = 0.000309642
cycle = 7  E_corr(CCSD) = -0.213103599045247  dE = 5.86905883e-07  norm(t1,t2) = 9.51576e-05
cycle = 8  E_corr(CCSD) = -0.213102615359484  dE = 9.83685763e-07  norm(t1,t2) = 3.54274e-05
cycle = 9  E_corr(CCSD) = -0.213102204901594  dE = 4.1045789e-07  norm(t1,t2) = 1.0688e-05
cycle = 10  E_corr(CCSD) = -0.213102195737014  dE = 9.16457996e-09  norm(t1,t2) = 3.64922e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -55.10823865509685  E_corr = -0.2131021957370142
cycle = 1  norm(lambda1,lambda2) = 0.167136
cycle = 2  norm(lambda1,lambda2) = 0.038151
cycle = 3  norm(lambda1,lambda2) = 0.015297
cycle = 4  norm(lambda1,lambda2) = 0.00471467
cycle = 5  norm(lambda1,lambda2) = 0.00133363
cycle = 6  norm(lambda1,lambda2) = 0.000286805
cycle = 7  norm(lambda1,lambda2) = 9.58952e-05
cycle = 8  norm(lambda1,lambda2) = 3.05038e-05
cycle = 9  norm(lambda1,lambda2) = 9.00908e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0003093076    -0.0000000087     0.0000000049
1 H    -0.0003093076     0.0000000087    -0.0000000049
----------------------------------------------
cycle 4: E = -55.1082386551  dE = -1.94045e-05  norm(grad) = 0.000437427

Geometry optimization cycle 5
Cartesian coordinates (Angstrom)
 Atom        New coordinates             dX        dY        dZ
   N  -0.038742  -0.000007   0.000003   -0.000342  0.000000 -0.000000
   H   1.038742   0.000007  -0.000003    0.000342 -0.000000  0.000000
New geometry
   1 N     -0.038741596585  -0.000007060130   0.000002854079 AA   -0.073211007174  -0.000013341711   0.000005393428 Bohr

   2 H      1.038741596371   0.000007060130  -0.000002854079 AA    1.962937131335   0.000013341711  -0.000005393428 Bohr



******** <class 'pyscf.scf.hf.as_scanner.<locals>.SCF_Scanner'> ********
method = SCF_Scanner-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 16
SCF conv_tol = 1e-09
SCF conv_tol_grad = 1e-06
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
max_memory 48000 MB (current use 578 MB)
number electrons alpha = 6  beta = 3
init E= -54.8948828204976
  alpha nocc = 6  HOMO = 0.0835101021476983  LUMO = 0.45056672515776
  beta  nocc = 3  HOMO = -0.271291135304809  LUMO = 0.320457389843771
cycle= 1 E= -54.8951199812194  delta_E= -0.000237  |g|= 0.000134  |ddm|= 0.0148
  alpha nocc = 6  HOMO = 0.0835510066575855  LUMO = 0.45049914500385
  beta  nocc = 3  HOMO = -0.271355181866929  LUMO = 0.320360390644455
cycle= 2 E= -54.8951199981472  delta_E= -1.69e-08  |g|= 5.38e-05  |ddm|= 0.00227
  alpha nocc = 6  HOMO = 0.083548311475718  LUMO = 0.45049516359583
  beta  nocc = 3  HOMO = -0.271376223474812  LUMO = 0.320342206428785
cycle= 3 E= -54.895120002034  delta_E= -3.89e-09  |g|= 2.82e-05  |ddm|= 0.00105
  alpha nocc = 6  HOMO = 0.0835505546844833  LUMO = 0.450494589096136
  beta  nocc = 3  HOMO = -0.271364955930574  LUMO = 0.320346810550472
cycle= 4 E= -54.8951200036573  delta_E= -1.62e-09  |g|= 1.17e-05  |ddm|= 0.000661
  alpha nocc = 6  HOMO = 0.083551759304996  LUMO = 0.450492783412352
  beta  nocc = 3  HOMO = -0.271365353542603  LUMO = 0.320345447510399
cycle= 5 E= -54.8951200039143  delta_E= -2.57e-10  |g|= 3.92e-06  |ddm|= 0.000167
  alpha nocc = 6  HOMO = 0.0835515504659597  LUMO = 0.450493107673679
  beta  nocc = 3  HOMO = -0.27136432569324  LUMO = 0.320345946349148
cycle= 6 E= -54.8951200039413  delta_E= -2.7e-11  |g|= 1.31e-06  |ddm|= 9.67e-05
  alpha nocc = 6  HOMO = 0.0835514071257262  LUMO = 0.450493186674873
  beta  nocc = 3  HOMO = -0.271364370126889  LUMO = 0.320345784216622
cycle= 7 E= -54.8951200039452  delta_E= -3.94e-12  |g|= 4.41e-07  |ddm|= 2.68e-05
  alpha nocc = 6  HOMO = 0.0835513913222838  LUMO = 0.450493213410971
  beta  nocc = 3  HOMO = -0.27136425126163  LUMO = 0.320345778172675
Extra cycle  E= -54.8951200039456  delta_E= -3.27e-13  |g|= 2.6e-07  |ddm|= 4.68e-06
converged SCF energy = -54.8951200039456  <S^2> = 3.7667002  2S+1 = 4.0083414

******** <class 'pyscf.cc.ccsd.as_scanner.<locals>.CCSD_Scanner'> ********
CC2 = 0
CCSD nocc = (6, 3), nmo = (146, 146)
max_cycle = 200
direct = 0
conv_tol = 1e-07
conv_tol_normt = 1e-05
diis_space = 12
diis_start_cycle = 0
diis_start_energy_diff = 1e+09
max_memory 48000 MB (current use 3615 MB)
Init E_corr(CCSD) = -0.107389141773402
cycle = 1  E_corr(CCSD) = -0.206302544436294  dE = -0.0989134027  norm(t1,t2) = 0.208692
cycle = 2  E_corr(CCSD) = -0.210687974686512  dE = -0.00438543025  norm(t1,t2) = 0.0457348
cycle = 3  E_corr(CCSD) = -0.213035394039596  dE = -0.00234741935  norm(t1,t2) = 0.0171256
cycle = 4  E_corr(CCSD) = -0.213002709289052  dE = 3.26847505e-05  norm(t1,t2) = 0.00511952
cycle = 5  E_corr(CCSD) = -0.213105370419677  dE = -0.000102661131  norm(t1,t2) = 0.00146466
cycle = 6  E_corr(CCSD) = -0.213117420064061  dE = -1.20496444e-05  norm(t1,t2) = 0.000379306
cycle = 7  E_corr(CCSD) = -0.213116791314875  dE = 6.28749186e-07  norm(t1,t2) = 0.00012375
cycle = 8  E_corr(CCSD) = -0.213118018770662  dE = -1.22745579e-06  norm(t1,t2) = 5.11186e-05
cycle = 9  E_corr(CCSD) = -0.213118595869968  dE = -5.77099306e-07  norm(t1,t2) = 1.64663e-05
cycle = 10  E_corr(CCSD) = -0.213118746998408  dE = -1.5112844e-07  norm(t1,t2) = 4.25957e-06
cycle = 11  E_corr(CCSD) = -0.213118789276349  dE = -4.2277941e-08  norm(t1,t2) = 1.45234e-06
CCSD_Scanner converged
E(CCSD_Scanner) = -55.10823879322192  E_corr = -0.2131187892763486
cycle = 1  norm(lambda1,lambda2) = 0.208303
cycle = 2  norm(lambda1,lambda2) = 0.040154
cycle = 3  norm(lambda1,lambda2) = 0.014739
cycle = 4  norm(lambda1,lambda2) = 0.0045416
cycle = 5  norm(lambda1,lambda2) = 0.00148116
cycle = 6  norm(lambda1,lambda2) = 0.000357835
cycle = 7  norm(lambda1,lambda2) = 0.000131588
cycle = 8  norm(lambda1,lambda2) = 5.20158e-05
cycle = 9  norm(lambda1,lambda2) = 1.54649e-05
cycle = 10  norm(lambda1,lambda2) = 4.55054e-06
--------------- CCSD_Scanner gradients ---------------
         x                y                z
0 N     0.0000094110     0.0000000005    -0.0000000003
1 H    -0.0000094110    -0.0000000005     0.0000000003
----------------------------------------------
cycle 5: E = -55.1082387932  dE = -1.38125e-07  norm(grad) = 1.33091e-05
